# JavaScript Note éº¥å¯ç­†è¨˜

> ä½¿ç”¨ AI æ•´ç†ä¸¦é‡æ–°ç†è§£ javascript é‹ä½œåŸç†

[ç­†è¨˜ä¹‹å¾Œæ”¹ä½¿ç”¨ isuue ä¾†è¨˜éŒ„](https://github.com/Mike-Zheng/javascript-note/issues)

## å‰è¨€

é  js åƒé£¯å¤šå¹´ï¼Œæ¯æ¬¡é–‹ç™¼éƒ½æœƒæœ‰ç™¼ç¾ä¸çŸ¥æˆ–ä¸è¶³çš„åœ°æ–¹ï¼Œæ–¼æ˜¯é–‹ä¸€å€‹ç­†è¨˜ç´€éŒ„æ¯æ¬¡çš„è³‡è¨Šã€‚

---

### Table of Contents

| No. | Content                                                                         |
| --- | ------------------------------------------------------------------------------- |
| 1   | [Execution Context åŸ·è¡Œç’°å¢ƒ](#1-execution-context-åŸ·è¡Œç’°å¢ƒ)                     |
| 2   | [Lexical Environment è©æ³•ç’°å¢ƒ](#2-lexical-environment-è©æ³•ç’°å¢ƒ)                 |
| 3   | [Hoisting æå‡](#3-hoisting-æå‡)                                               |
| 4   | [Scope ä½œç”¨åŸŸ](#4-scope-ä½œç”¨åŸŸ)                                                 |
| 5   | [Variable Declaration è®Šæ•¸å®£å‘Š](#5-variable-declaration-è®Šæ•¸å®£å‘Š)               |
| 6   | [Temporal Dead Zone æš«æ™‚æ€§æ­»å€](#6-temporal-dead-zone-æš«æ™‚æ€§æ­»å€)               |
| 7   | [Prototype and Inheritance åŸå‹èˆ‡ç¹¼æ‰¿](#7-prototype-and-inheritance-åŸå‹èˆ‡ç¹¼æ‰¿) |
| 8   | [Closure é–‰åŒ…](#8-closure-é–‰åŒ…)                                                 |
| 9   | [Error Handling éŒ¯èª¤è™•ç†](#9-error-handling-éŒ¯èª¤è™•ç†)                           |
| 10  | [Call Stack å‘¼å«å †ç–Š](#10-call-stack-å‘¼å«å †ç–Š)                                  |
| 11  | [Memory Management è¨˜æ†¶é«”ç®¡ç†](#11-memory-management-è¨˜æ†¶é«”ç®¡ç†)                |
| 12  | [Garbage Collection åƒåœ¾å›æ”¶æ©Ÿåˆ¶](#12-garbage-collection-åƒåœ¾å›æ”¶æ©Ÿåˆ¶)          |
| 13  | [Asynchronous Patterns éåŒæ­¥æ¨¡å¼](#13-asynchronous-patterns-éåŒæ­¥æ¨¡å¼)        |
| 14  | [Promises Promise æ©Ÿåˆ¶](#14-promises-promise-æ©Ÿåˆ¶)                              |
| 15  | [Async/Await](#15-asyncawait)                                                   |
| 16  | [Callback Queue å›èª¿éšŠåˆ—](#16-callback-queue-å›èª¿éšŠåˆ—)                          |
| 17  | [Microtask Queue å¾®ä»»å‹™éšŠåˆ—](#17-microtask-queue-å¾®ä»»å‹™éšŠåˆ—)                    |
| 18  | [Event Loop äº‹ä»¶è¿´åœˆ](#18-event-loop-äº‹ä»¶è¿´åœˆ)                                  |
| 19  | [Event Delegation äº‹ä»¶å§”æ´¾](#19-event-delegation-äº‹ä»¶å§”æ´¾)                      |
| 20  | [DOM Manipulation DOM æ“ä½œ](#20-dom-manipulation-dom-æ“ä½œ)                      |
| 21  | [Module System æ¨¡å¡Šç³»çµ±](#21-module-system-æ¨¡å¡Šç³»çµ±)                            |
| 22  | [Web APIs](#22-web-apis)                                                        |
| 23  | [JavaScript Security å®‰å…¨](#23-javascript-security-å®‰å…¨)                        |
| 24  | [JavaScript Performance æ€§èƒ½](#24-javascript-performance-æ€§èƒ½)                  |
| 25  | [Data Structures è³‡æ–™çµæ§‹](#25-data-structures-è³‡æ–™çµæ§‹)                        |
| 26  | [JavaScript å¼•æ“ å¦‚ V8 çš„æ¶æ§‹](#26-javascript-å¼•æ“-å¦‚-v8-çš„æ¶æ§‹)                |

---

### 1. Execution Context åŸ·è¡Œç’°å¢ƒ

#### **ä»€éº¼æ˜¯ Execution Contextï¼Ÿ**

Execution Contextï¼ˆåŸ·è¡Œç’°å¢ƒï¼‰æ˜¯ JavaScript ä¸­ç¨‹å¼ç¢¼åŸ·è¡Œçš„æœ€å°å–®ä½ã€‚æ¯ç•¶ JavaScript å¼•æ“åŸ·è¡Œç¨‹å¼ç¢¼æ™‚ï¼Œæœƒå‰µå»ºå°æ‡‰çš„åŸ·è¡Œç’°å¢ƒï¼Œç”¨ä¾†ç®¡ç†è®Šæ•¸ã€å‡½æ•¸ä»¥åŠä½œç”¨åŸŸã€‚

**åŠŸèƒ½ï¼š**

1. **å®šç¾©ç¨‹å¼ç¢¼çš„åŸ·è¡Œç¯„åœ**ï¼šåŸ·è¡Œç’°å¢ƒæ±ºå®šäº†å“ªäº›è®Šæ•¸å’Œå‡½æ•¸åœ¨ç•¶å‰ç¨‹å¼ç¢¼ä¸­æ˜¯å¯è¨ªå•çš„ã€‚
2. **ç›£æ§ç¨‹å¼åŸ·è¡Œç‹€æ…‹**ï¼šåŸ·è¡Œç’°å¢ƒåŒ…å«åŸ·è¡Œç¨‹å¼ç¢¼æ™‚çš„ç›¸é—œè³‡è¨Šï¼ˆä¾‹å¦‚è®Šæ•¸å€¼ã€å‡½æ•¸ç‹€æ…‹ç­‰ï¼‰ã€‚

---

#### **åŸ·è¡Œç’°å¢ƒçš„ç¨®é¡**

JavaScript ä¸­çš„åŸ·è¡Œç’°å¢ƒåˆ†ç‚ºä»¥ä¸‹ä¸‰ç¨®é¡å‹ï¼š

1. **å…¨åŸŸåŸ·è¡Œç’°å¢ƒ (Global Execution Context)**

   - é è¨­çš„åŸ·è¡Œç’°å¢ƒï¼Œç•¶ JavaScript ç¨‹å¼å•Ÿå‹•æ™‚è‡ªå‹•å‰µå»ºã€‚
   - å…¨åŸŸè®Šæ•¸å’Œå‡½æ•¸éƒ½å±¬æ–¼æ­¤ç’°å¢ƒã€‚
   - åœ¨ç€è¦½å™¨ä¸­ï¼Œ`this` æŒ‡å‘ `window`ï¼›åœ¨ Node.js ä¸­ï¼Œ`this` æŒ‡å‘ `global`ã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   var x = 10;
   console.log(x); // å…¨åŸŸåŸ·è¡Œç’°å¢ƒ
   ```

2. **å‡½æ•¸åŸ·è¡Œç’°å¢ƒ (Function Execution Context)**

   - æ¯ç•¶ä¸€å€‹å‡½æ•¸è¢«å‘¼å«æ™‚ï¼Œæœƒå‰µå»ºä¸€å€‹æ–°çš„å‡½æ•¸åŸ·è¡Œç’°å¢ƒã€‚
   - æ¯å€‹å‡½æ•¸åŸ·è¡Œç’°å¢ƒéƒ½æœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œå…§éƒ¨çš„è®Šæ•¸ç„¡æ³•å¾å¤–éƒ¨ç›´æ¥è¨ªå•ã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   function sum(a, b) {
     return a + b; // å‡½æ•¸åŸ·è¡Œç’°å¢ƒ
   }
   ```

3. **Eval åŸ·è¡Œç’°å¢ƒ (Eval Execution Context)**

   - ç•¶åŸ·è¡Œ `eval()` æ™‚ï¼Œæœƒå‰µå»ºä¸€å€‹ç‰¹æ®Šçš„åŸ·è¡Œç’°å¢ƒã€‚
   - ä½¿ç”¨ `eval()` å‰µå»ºçš„è®Šæ•¸æœƒå±¬æ–¼ç•¶å‰åŸ·è¡Œç’°å¢ƒã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   eval("var a = 10; console.log(a);"); // eval åŸ·è¡Œç’°å¢ƒ
   ```

---

#### **åŸ·è¡Œç’°å¢ƒçš„çµæ§‹**

åŸ·è¡Œç’°å¢ƒç”±ä»¥ä¸‹ä¸‰å€‹ä¸»è¦éƒ¨åˆ†çµ„æˆï¼š

1. **è®Šæ•¸ç’°å¢ƒ (Variable Environment)**

   - å„²å­˜è®Šæ•¸å’Œå‡½æ•¸çš„å®£å‘Šã€‚
   - åŒ…å«ï¼š
     - **è®Šæ•¸å®£å‘Šï¼ˆVariable Declarationsï¼‰**
     - **å‡½æ•¸å®£å‘Šï¼ˆFunction Declarationsï¼‰**
     - **å‡½æ•¸åƒæ•¸ï¼ˆFunction Parametersï¼‰**

2. **è©æ³•ç’°å¢ƒ (Lexical Environment)**

   - æè¿°ç•¶å‰ç¨‹å¼ç¢¼çš„ä½œç”¨åŸŸéˆï¼ˆScope Chainï¼‰ï¼Œç”¨æ–¼è§£æè®Šæ•¸å’Œå‡½æ•¸ã€‚
   - è©æ³•ç’°å¢ƒåŒ…æ‹¬ï¼š
     - **ç•¶å‰åŸ·è¡Œä»£ç¢¼å¡Šçš„è®Šæ•¸**
     - **çˆ¶åŸ·è¡Œç’°å¢ƒçš„å¼•ç”¨ï¼ˆOuter Environment Referenceï¼‰**

3. **`this` ç¶å®š (This Binding)**
   - `this` çš„å€¼å–æ±ºæ–¼åŸ·è¡Œç’°å¢ƒçš„ä¸Šä¸‹æ–‡ï¼š
     - åœ¨å…¨åŸŸç’°å¢ƒä¸­ï¼Œ`this` é€šå¸¸æŒ‡å‘ `window`ï¼ˆç€è¦½å™¨ï¼‰æˆ– `global`ï¼ˆNode.jsï¼‰ã€‚
     - åœ¨å‡½æ•¸åŸ·è¡Œç’°å¢ƒä¸­ï¼Œ`this` çš„å€¼æ ¹æ“šå‡½æ•¸çš„å‘¼å«æ–¹å¼å‹•æ…‹æ±ºå®šã€‚

---

#### **åŸ·è¡Œç’°å¢ƒçš„é‹ä½œæ©Ÿåˆ¶**

åŸ·è¡Œç’°å¢ƒåœ¨ JavaScript ç¨‹å¼åŸ·è¡Œéç¨‹ä¸­æœƒç¶“æ­·ä»¥ä¸‹éšæ®µï¼š

1. **å‰µå»ºéšæ®µ (Creation Phase)**

   - åŸ·è¡Œç¨‹å¼ç¢¼ä¹‹å‰ï¼ŒJavaScript å¼•æ“æœƒå‰µå»ºåŸ·è¡Œç’°å¢ƒã€‚
   - æ­¤éšæ®µæœƒå®Œæˆï¼š
     - **å»ºç«‹è©æ³•ç’°å¢ƒï¼ˆLexical Environmentï¼‰**
     - **å»ºç«‹è®Šæ•¸ç’°å¢ƒï¼ˆVariable Environmentï¼‰**
     - **ç¶å®š `this` å€¼**

2. **åŸ·è¡Œéšæ®µ (Execution Phase)**
   - JavaScript åŸ·è¡Œç¨‹å¼ç¢¼ï¼Œä¸¦åŸºæ–¼åŸ·è¡Œç’°å¢ƒä¸­çš„è³‡è¨Šè™•ç†è®Šæ•¸å’Œå‡½æ•¸ã€‚

---

#### **åŸ·è¡Œç’°å¢ƒèˆ‡ä½œç”¨åŸŸéˆ (Scope Chain) çš„é—œä¿‚**

åŸ·è¡Œç’°å¢ƒä¸­çš„ **è©æ³•ç’°å¢ƒ (Lexical Environment)** æ±ºå®šäº†ä½œç”¨åŸŸéˆã€‚ä½œç”¨åŸŸéˆçš„ä¸»è¦åŠŸèƒ½æ˜¯å¹«åŠ© JavaScript å¼•æ“è§£æè®Šæ•¸ã€‚

- **ä½œç”¨åŸŸéˆçš„æ§‹æˆï¼š**

  1. ç•¶å‰åŸ·è¡Œç’°å¢ƒçš„è®Šæ•¸
  2. çˆ¶åŸ·è¡Œç’°å¢ƒçš„è®Šæ•¸
  3. å…¨åŸŸåŸ·è¡Œç’°å¢ƒçš„è®Šæ•¸

- **ç¯„ä¾‹ï¼š**

  ```javascript
  function outer() {
    let a = 10;

    function inner() {
      console.log(a); // å¾çˆ¶ä½œç”¨åŸŸç²å– a
    }

    inner();
  }

  outer();
  ```

- ç•¶ JavaScript å¼•æ“æŸ¥æ‰¾è®Šæ•¸æ™‚ï¼Œæœƒæ²¿è‘—ä½œç”¨åŸŸéˆé€²è¡ŒæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å°æ‡‰çš„è®Šæ•¸æˆ–å ±éŒ¯ç‚ºæ­¢ã€‚

---

#### **åŸ·è¡Œç’°å¢ƒèˆ‡ Hoisting (æå‡)**

**Hoistingï¼ˆæå‡ï¼‰** æ˜¯ JavaScript çš„ä¸€å€‹é‡è¦ç‰¹æ€§ï¼ŒæŒ‡çš„æ˜¯è®Šæ•¸å’Œå‡½æ•¸çš„å®£å‘Šæœƒåœ¨åŸ·è¡Œç¨‹å¼ç¢¼ä¹‹å‰è¢«æå‡åˆ°åŸ·è¡Œç’°å¢ƒçš„é ‚éƒ¨ã€‚

- **è®Šæ•¸æå‡ï¼š**

  ```javascript
  console.log(a); // undefined
  var a = 10;
  ```

  ç­‰åƒ¹æ–¼ï¼š

  ```javascript
  var a;
  console.log(a); // undefined
  a = 10;
  ```

- **å‡½æ•¸æå‡ï¼š**

  ```javascript
  greet(); // "Hello"
  function greet() {
    console.log("Hello");
  }
  ```

---

#### **Call Stackï¼ˆå‘¼å«å †ç–Šï¼‰èˆ‡åŸ·è¡Œç’°å¢ƒ**

JavaScript ä½¿ç”¨ **Call Stackï¼ˆå‘¼å«å †ç–Šï¼‰** ç®¡ç†åŸ·è¡Œç’°å¢ƒã€‚æ¯å€‹åŸ·è¡Œç’°å¢ƒæœƒè¢«æ¨å…¥å †ç–Šï¼ˆPushï¼‰ï¼Œç•¶åŸ·è¡Œå®Œæˆå¾Œæœƒå¾å †ç–Šä¸­å½ˆå‡ºï¼ˆPopï¼‰ã€‚

- **ç¯„ä¾‹ï¼š**

  ```javascript
  function a() {
    b();
    console.log("In function a");
  }

  function b() {
    console.log("In function b");
  }

  a();
  ```

  **åŸ·è¡Œéç¨‹ï¼š**

  1. å…¨åŸŸåŸ·è¡Œç’°å¢ƒè¢«æ¨å…¥å †ç–Šã€‚
  2. å‘¼å« `a()` æ™‚ï¼Œå‰µå»º `a` çš„åŸ·è¡Œç’°å¢ƒï¼Œä¸¦æ¨å…¥å †ç–Šã€‚
  3. å‘¼å« `b()` æ™‚ï¼Œå‰µå»º `b` çš„åŸ·è¡Œç’°å¢ƒï¼Œä¸¦æ¨å…¥å †ç–Šã€‚
  4. åŸ·è¡Œå®Œæˆå¾Œï¼Œ`b` çš„åŸ·è¡Œç’°å¢ƒå¾å †ç–Šä¸­å½ˆå‡ºã€‚
  5. ç¹¼çºŒåŸ·è¡Œ `a`ï¼Œæœ€å¾Œå½ˆå‡º `a` çš„åŸ·è¡Œç’°å¢ƒã€‚
  6. æœ€å¾Œå…¨åŸŸåŸ·è¡Œç’°å¢ƒé€€å‡ºå †ç–Šã€‚

  **å †ç–Šç‹€æ…‹ï¼š**

  ```
  1. å…¨åŸŸåŸ·è¡Œç’°å¢ƒ
  2. a() åŸ·è¡Œç’°å¢ƒ
  3. b() åŸ·è¡Œç’°å¢ƒ
  ```

---

#### **å°çµ**

1. **Execution Contextï¼ˆåŸ·è¡Œç’°å¢ƒï¼‰** æ˜¯ JavaScript åŸ·è¡Œç¨‹å¼ç¢¼çš„åŸºç¤å–®ä½ã€‚
2. æ¯å€‹åŸ·è¡Œç’°å¢ƒåŒ…å«ï¼š
   - **è®Šæ•¸ç’°å¢ƒï¼ˆVariable Environmentï¼‰**
   - **è©æ³•ç’°å¢ƒï¼ˆLexical Environmentï¼‰**
   - **`this` ç¶å®š**
3. **å…¨åŸŸåŸ·è¡Œç’°å¢ƒ** åªæœ‰ä¸€å€‹ï¼Œè€Œ **å‡½æ•¸åŸ·è¡Œç’°å¢ƒ** å¯ä»¥æœ‰å¤šå€‹ã€‚
4. **ä½œç”¨åŸŸéˆï¼ˆScope Chainï¼‰** å’Œ **Hoistingï¼ˆæå‡ï¼‰** æ˜¯åŸ·è¡Œç’°å¢ƒçš„é‡è¦æ¦‚å¿µã€‚
5. JavaScript ä½¿ç”¨ **Call Stackï¼ˆå‘¼å«å †ç–Šï¼‰** ç®¡ç†åŸ·è¡Œç’°å¢ƒã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 2. Lexical Environment è©æ³•ç’°å¢ƒ

#### ä»€éº¼æ˜¯ Lexical Environmentï¼Ÿ

Lexical Environmentï¼ˆè©æ³•ç’°å¢ƒï¼‰æ˜¯ JavaScript ä¸­çš„ä¸€ç¨®çµæ§‹ï¼Œç”¨ä¾†ç®¡ç†è®Šæ•¸åŠå‡½å¼çš„ç¯„åœèˆ‡ä½œç”¨åŸŸã€‚å®ƒæ˜¯ JavaScript åŸ·è¡Œç¨‹å¼ç¢¼æ™‚çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ï¼Œè² è²¬è¿½è¹¤å“ªäº›è®Šæ•¸ã€å‡½å¼åœ¨ç•¶å‰çš„ä½œç”¨åŸŸä¸­å¯ä»¥è¢«å­˜å–ã€‚

#### çµ„æˆéƒ¨åˆ†

Lexical Environment åŒ…å«å…©å€‹ä¸»è¦éƒ¨åˆ†ï¼š

1. **Environment Recordï¼ˆç’°å¢ƒè¨˜éŒ„ï¼‰**  
   å„²å­˜ç•¶å‰ä½œç”¨åŸŸä¸­çš„æ‰€æœ‰è®Šæ•¸å’Œå‡½å¼çš„å¯¦éš›è¨˜éŒ„ã€‚
2. **Outer Lexical Environment Referenceï¼ˆå¤–éƒ¨è©æ³•ç’°å¢ƒåƒè€ƒï¼‰**  
   æŒ‡å‘å¤–å±¤çš„ Lexical Environmentï¼Œå½¢æˆä¸€å€‹ä½œç”¨åŸŸéˆï¼ˆScope Chainï¼‰ã€‚

#### é¡å‹

Lexical Environment å¯ä»¥åˆ†ç‚ºä»¥ä¸‹å¹¾ç¨®é¡å‹ï¼š

1. **Global Lexical Environmentï¼ˆå…¨åŸŸè©æ³•ç’°å¢ƒï¼‰**
   - é è¨­å­˜åœ¨æ–¼ç¨‹å¼çš„æœ€å¤–å±¤ï¼ŒåŒ…å«æ‰€æœ‰å…¨åŸŸè®Šæ•¸èˆ‡å…¨åŸŸå‡½å¼ã€‚
   - æ²’æœ‰å¤–éƒ¨è©æ³•ç’°å¢ƒåƒè€ƒï¼Œå› æ­¤å…¶ `Outer Lexical Environment Reference` ç‚º `null`ã€‚
2. **Function Lexical Environmentï¼ˆå‡½å¼è©æ³•ç’°å¢ƒï¼‰**
   - æ¯å€‹å‡½å¼åœ¨åŸ·è¡Œæ™‚éƒ½æœƒå‰µå»ºè‡ªå·±çš„è©æ³•ç’°å¢ƒã€‚
   - åŒ…å«å‡½å¼å…§éƒ¨å®šç¾©çš„è®Šæ•¸åŠåƒæ•¸ã€‚
3. **Block Lexical Environmentï¼ˆå€å¡Šè©æ³•ç’°å¢ƒï¼‰**
   - ES6 å¼•å…¥çš„ `let` å’Œ `const` å‰µé€ äº†å€å¡Šä½œç”¨åŸŸï¼ˆBlock Scopeï¼‰ã€‚
   - æ¯å€‹å€å¡Šï¼ˆå¦‚ `if`ã€`for` ç­‰ï¼‰éƒ½æœƒå‰µå»ºè‡ªå·±çš„è©æ³•ç’°å¢ƒã€‚

#### é‹ä½œæ©Ÿåˆ¶

1. **è®Šæ•¸èˆ‡å‡½å¼çš„å®£å‘Š**  
   ç•¶ JavaScript è§£è­¯å™¨åŸ·è¡Œç¨‹å¼ç¢¼æ™‚ï¼Œæœƒæ ¹æ“šç¨‹å¼ç¢¼çµæ§‹å»ºç«‹å°æ‡‰çš„ Lexical Environmentï¼Œä¸¦å°‡è®Šæ•¸ã€å‡½å¼çš„å®£å‘ŠåŠ å…¥åˆ° Environment Record ä¸­ã€‚
2. **ä½œç”¨åŸŸéˆï¼ˆScope Chainï¼‰**  
   ç•¶åŸ·è¡Œç¨‹å¼ç¢¼æ™‚ï¼ŒJavaScript æœƒåœ¨ç•¶å‰çš„ Lexical Environment ä¸­å°‹æ‰¾è®Šæ•¸æˆ–å‡½å¼ã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œæœƒæ²¿è‘— `Outer Lexical Environment Reference` ä¸€å±¤å±¤å‘å¤–å°‹æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ç‚ºæ­¢ã€‚å¦‚æœæœ€å¤–å±¤çš„ Global Lexical Environment ä¹Ÿæ‰¾ä¸åˆ°ï¼Œå‰‡æœƒæ‹‹å‡ºéŒ¯èª¤ã€‚

#### ç¤ºä¾‹

```javascript
let a = 10; // å…¨åŸŸè©æ³•ç’°å¢ƒ

function foo() {
  let b = 20; // å‡½å¼è©æ³•ç’°å¢ƒ
  console.log(a); // å¾å¤–éƒ¨è©æ³•ç’°å¢ƒå–å¾— 'a'

  if (true) {
    let c = 30; // å€å¡Šè©æ³•ç’°å¢ƒ
    console.log(b); // å¾å‡½å¼è©æ³•ç’°å¢ƒå–å¾— 'b'
    console.log(c); // å¾å€å¡Šè©æ³•ç’°å¢ƒå–å¾— 'c'
  }
}

foo();
```

#### é‹è¡Œéç¨‹

1. **å…¨åŸŸå±¤ç´š**
   - å»ºç«‹ Global Lexical Environmentï¼Œå°‡ `a` å®£å‘Šä¸¦å„²å­˜åˆ° Environment Recordã€‚
2. **å‡½å¼å‘¼å«æ™‚**
   - å‘¼å« `foo()` æ™‚ï¼Œå»ºç«‹ `foo` çš„ Function Lexical Environmentï¼Œå°‡ `b` å®£å‘Šä¸¦å„²å­˜åˆ° Environment Recordã€‚
   - `foo` çš„å¤–éƒ¨è©æ³•ç’°å¢ƒåƒè€ƒæŒ‡å‘ Global Lexical Environmentã€‚
3. **å€å¡Šå…§éƒ¨**
   - é€²å…¥ `if` å€å¡Šæ™‚ï¼Œå»ºç«‹ Block Lexical Environmentï¼Œå°‡ `c` å®£å‘Šä¸¦å„²å­˜åˆ° Environment Recordã€‚
   - è©²å€å¡Šçš„å¤–éƒ¨è©æ³•ç’°å¢ƒåƒè€ƒæŒ‡å‘ `foo` çš„ Function Lexical Environmentã€‚

#### Lexical Environment æ³¨æ„äº‹é …

1. **è®Šæ•¸æå‡ï¼ˆHoistingï¼‰**
   - è®Šæ•¸å®£å‘Šï¼ˆ`var`ï¼‰æœƒè¢«æå‡åˆ°ä½œç”¨åŸŸçš„é ‚éƒ¨ï¼Œä½†å€¼ä¸æœƒè¢«åˆå§‹åŒ–ã€‚
   - ä½¿ç”¨ `let` å’Œ `const` å‰‡ä¸æœƒè¢«æå‡åˆ°ç’°å¢ƒè¨˜éŒ„çš„é ‚éƒ¨ï¼Œæœƒé€²å…¥ã€Œæš«æ™‚æ€§æ­»å€ã€ï¼ˆTemporal Dead Zone, TDZï¼‰ã€‚
2. **é–‰åŒ…ï¼ˆClosureï¼‰**
   - é–‰åŒ…æ˜¯ä¸€ç¨®å‡½å¼ï¼Œèƒ½å¤ ã€Œè¨˜ä½ã€å¤–éƒ¨è©æ³•ç’°å¢ƒä¸­çš„è®Šæ•¸ï¼Œå³ä½¿è©²å¤–éƒ¨å‡½å¼å·²ç¶“åŸ·è¡Œå®Œç•¢ã€‚

#### Lexical Environment ç¸½çµ

- Lexical Environment æ˜¯ JavaScript ä¸­çš„æ ¸å¿ƒæ©Ÿåˆ¶ï¼Œç”¨ä¾†è™•ç†è®Šæ•¸èˆ‡å‡½å¼çš„ä½œç”¨åŸŸã€‚
- å®ƒåŒ…å« Environment Record å’Œ Outer Lexical Environment Referenceï¼Œä¸¦é€éä½œç”¨åŸŸéˆä¾†å°‹æ‰¾è®Šæ•¸ã€‚
- Lexical Environment çš„ç†è§£å°æ–¼æŒæ¡ JavaScript çš„ä½œç”¨åŸŸã€è®Šæ•¸æå‡èˆ‡é–‰åŒ…ç­‰æ¦‚å¿µè‡³é—œé‡è¦ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 3. Hoisting æå‡

#### ä»€éº¼æ˜¯ Hoistingï¼ˆæå‡ï¼‰ï¼Ÿ

Hoistingï¼ˆæå‡ï¼‰æ˜¯ JavaScript ä¸­çš„ä¸€ç¨®è¡Œç‚ºï¼ŒæŒ‡çš„æ˜¯è®Šæ•¸ï¼ˆVariablesï¼‰ã€å‡½å¼ï¼ˆFunctionsï¼‰æˆ–é¡åˆ¥ï¼ˆClassesï¼‰çš„å®£å‘Šï¼ˆDeclarationï¼‰æœƒåœ¨ç·¨è­¯éšæ®µè¢«ç§»å‹•åˆ°å…¶ä½œç”¨åŸŸï¼ˆScopeï¼‰çš„é ‚éƒ¨ï¼Œä½†åˆå§‹åŒ–ï¼ˆInitializationï¼‰ä¸æœƒä¸€èµ·æå‡ã€‚

---

#### Hoisting çš„ç¯„åœ

1. **å…¨åŸŸä½œç”¨åŸŸï¼ˆGlobal Scopeï¼‰**
2. **å‡½å¼ä½œç”¨åŸŸï¼ˆFunction Scopeï¼‰**
3. **å€å¡Šä½œç”¨åŸŸï¼ˆBlock Scopeï¼‰** - ES6 ä¹‹å¾Œæ–°å¢ï¼Œä½¿ç”¨ `let` å’Œ `const` å®£å‘Šã€‚

---

#### è®Šæ•¸ï¼ˆVariablesï¼‰çš„æå‡

1. **ä½¿ç”¨ `var` å®£å‘Š**

   - è®Šæ•¸å®£å‘Šæœƒè¢«æå‡ï¼Œä½†åˆå§‹åŒ–çš„éƒ¨åˆ†ä¸æœƒã€‚
   - åœ¨æå‡å¾Œï¼Œè®Šæ•¸çš„å€¼ç‚º `undefined`ã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   console.log(a); // undefined
   var a = 10;
   ```

   **æå‡å¾Œçš„è¡Œç‚ºï¼š**

   ```javascript
   var a;
   console.log(a); // undefined
   a = 10;
   ```

2. **ä½¿ç”¨ `let` å’Œ `const` å®£å‘Š**

   - `let` å’Œ `const` çš„å®£å‘Šä¹Ÿæœƒè¢«æå‡ï¼Œä½†å®ƒå€‘åœ¨ã€Œæš«æ™‚æ€§æ­»å€ã€ï¼ˆTemporal Dead Zone, TDZï¼‰ä¸­ï¼Œåªæœ‰åœ¨ç¨‹å¼ç¢¼åŸ·è¡Œåˆ°å®£å‘Šçš„é‚£ä¸€è¡Œæ™‚æ‰å¯è¢«å­˜å–ã€‚
   - å˜—è©¦åœ¨å®£å‘Šå‰å­˜å– `let` æˆ– `const` æœƒä¸Ÿå‡º `ReferenceError`ã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   console.log(b); // ReferenceError: Cannot access 'b' before initialization
   let b = 20;

   console.log(c); // ReferenceError: Cannot access 'c' before initialization
   const c = 30;
   ```

---

#### å‡½å¼ï¼ˆFunctionsï¼‰çš„æå‡

1. **å‡½å¼å®£å‘Šï¼ˆFunction Declarationï¼‰**

   - å‡½å¼å®£å‘Šæœƒè¢«å®Œå…¨æå‡ï¼ŒåŒ…æ‹¬å‡½å¼çš„åç¨±å’Œå…¶å…§éƒ¨å…§å®¹ã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   console.log(add(2, 3)); // 5
   function add(x, y) {
     return x + y;
   }
   ```

   **æå‡å¾Œçš„è¡Œç‚ºï¼š**

   ```javascript
   function add(x, y) {
     return x + y;
   }
   console.log(add(2, 3)); // 5
   ```

2. **å‡½å¼è¡¨é”å¼ï¼ˆFunction Expressionï¼‰**

   - ä½¿ç”¨ `var` çš„å‡½å¼è¡¨é”å¼æœƒéµå¾ªè®Šæ•¸æå‡çš„è¦å‰‡ï¼Œåƒ…æå‡è®Šæ•¸å®£å‘Šï¼Œä½†å‡½å¼æœ¬èº«ä¸æœƒè¢«æå‡ã€‚
   - ä½¿ç”¨ `let` æˆ– `const` å®£å‘Šçš„å‡½å¼è¡¨é”å¼å‰‡æœƒé€²å…¥æš«æ™‚æ€§æ­»å€ã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   console.log(add); // undefined
   var add = function (x, y) {
     return x + y;
   };
   ```

   **æå‡å¾Œçš„è¡Œç‚ºï¼š**

   ```javascript
   var add;
   console.log(add); // undefined
   add = function (x, y) {
     return x + y;
   };
   ```

3. **ç®­é ­å‡½å¼ï¼ˆArrow Functionï¼‰**

   - ç®­é ­å‡½å¼æ˜¯å‡½å¼è¡¨é”å¼çš„ä¸€ç¨®ï¼Œæå‡è¡Œç‚ºèˆ‡ `let` æˆ– `const` ä¸€è‡´ã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   console.log(add); // ReferenceError: Cannot access 'add' before initialization
   const add = (x, y) => x + y;
   ```

---

#### é¡åˆ¥ï¼ˆClassesï¼‰çš„æå‡

1. **é¡åˆ¥å®£å‘Šï¼ˆClass Declarationï¼‰**

   - é¡åˆ¥å®£å‘Šæœƒè¢«æå‡ï¼Œä½†èˆ‡ `let` å’Œ `const` ç›¸åŒï¼Œæœƒé€²å…¥æš«æ™‚æ€§æ­»å€ã€‚
   - å˜—è©¦åœ¨å®£å‘Šå‰ä½¿ç”¨é¡åˆ¥æœƒä¸Ÿå‡º `ReferenceError`ã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   const obj = new MyClass(); // ReferenceError: Cannot access 'MyClass' before initialization
   class MyClass {
     constructor() {
       this.name = "Hoisting Example";
     }
   }
   ```

2. **é¡åˆ¥è¡¨é”å¼ï¼ˆClass Expressionï¼‰**

   - é¡ä¼¼æ–¼å‡½å¼è¡¨é”å¼ï¼Œåƒ…è®Šæ•¸å®£å‘Šæœƒè¢«æå‡ï¼Œä½†é¡åˆ¥æœ¬èº«ä¸æœƒè¢«æå‡ã€‚

   **ç¯„ä¾‹ï¼š**

   ```javascript
   const obj = new MyClass(); // ReferenceError: Cannot access 'MyClass' before initialization
   const MyClass = class {
     constructor() {
       this.name = "Hoisting Example";
     }
   };
   ```

---

#### æš«æ™‚æ€§æ­»å€ï¼ˆTemporal Dead Zone, TDZï¼‰

æš«æ™‚æ€§æ­»å€æ˜¯æŒ‡å¾ä½œç”¨åŸŸé–‹å§‹åˆ°è®Šæ•¸è¢«å®£å‘Šçš„é€™æ®µæœŸé–“ï¼Œè®Šæ•¸ç„¡æ³•è¢«å­˜å–ã€‚é€™æ˜¯ `let`ã€`const` å’Œé¡åˆ¥çš„ç‰¹æ€§ï¼Œç”¨ä¾†é˜²æ­¢ä½¿ç”¨æœªåˆå§‹åŒ–çš„è®Šæ•¸ã€‚

**ç¯„ä¾‹ï¼š**

```javascript
console.log(x); // ReferenceError: Cannot access 'x' before initialization
let x = 10;
```

---

#### Hoisting æ³¨æ„äº‹é …

1. **åˆå§‹åŒ–èˆ‡è³¦å€¼çš„å€åˆ¥**
   - æå‡åªæœƒé‡å°ã€Œå®£å‘Šã€éƒ¨åˆ†é€²è¡Œï¼Œåˆå§‹åŒ–æˆ–è³¦å€¼çš„éƒ¨åˆ†ä¸æœƒè¢«æå‡ã€‚
2. **é¿å…ä½¿ç”¨ `var`**

   - `var` çš„æå‡è¡Œç‚ºå®¹æ˜“å°è‡´é æœŸå¤–çš„éŒ¯èª¤ï¼Œå»ºè­°ä½¿ç”¨ `let` æˆ– `const`ã€‚

3. **è®€æ‡‚éŒ¯èª¤è¨Šæ¯**
   - æå‡ç›¸é—œçš„éŒ¯èª¤é€šå¸¸æ˜¯ `ReferenceError` æˆ– `undefined`ï¼Œä»”ç´°æª¢æŸ¥è®Šæ•¸çš„å®£å‘Šé †åºã€‚

---

#### Hoisting ç¸½çµ

| å®£å‘Šæ–¹å¼   | æå‡è¡Œç‚º                                                            |
| ---------- | ------------------------------------------------------------------- |
| `var`      | å®£å‘Šæå‡ï¼Œåˆå§‹åŒ–ä¸æå‡ï¼Œæœªåˆå§‹åŒ–æ™‚ç‚º `undefined`ã€‚                  |
| `let`      | å®£å‘Šæå‡ï¼Œä½†é€²å…¥æš«æ™‚æ€§æ­»å€ï¼Œæœªåˆå§‹åŒ–å‰å­˜å–æœƒä¸Ÿå‡º `ReferenceError`ã€‚ |
| `const`    | è¡Œç‚ºèˆ‡ `let` ç›¸åŒï¼Œä½†å¿…é ˆåœ¨å®£å‘Šæ™‚åˆå§‹åŒ–ï¼Œå¦å‰‡æœƒä¸Ÿå‡º `SyntaxError`ã€‚ |
| å‡½å¼å®£å‘Š   | å®Œå…¨æå‡ï¼ŒåŒ…æ‹¬å‡½å¼åç¨±èˆ‡å…§å®¹ã€‚                                      |
| å‡½å¼è¡¨é”å¼ | åƒ…è®Šæ•¸å®£å‘Šæå‡ï¼Œå‡½å¼æœ¬èº«ä¸æœƒè¢«æå‡ï¼Œéµå¾ªè®Šæ•¸çš„æå‡è¡Œç‚ºã€‚            |
| ç®­é ­å‡½å¼   | è¡Œç‚ºèˆ‡å‡½å¼è¡¨é”å¼ä¸€è‡´ã€‚                                              |
| é¡åˆ¥å®£å‘Š   | å®£å‘Šæå‡ï¼Œä½†é€²å…¥æš«æ™‚æ€§æ­»å€ï¼Œæœªåˆå§‹åŒ–å‰å­˜å–æœƒä¸Ÿå‡º `ReferenceError`ã€‚ |
| é¡åˆ¥è¡¨é”å¼ | åƒ…è®Šæ•¸å®£å‘Šæå‡ï¼Œé¡åˆ¥æœ¬èº«ä¸æœƒè¢«æå‡ï¼Œéµå¾ªè®Šæ•¸çš„æå‡è¡Œç‚ºã€‚            |

**[ğŸ” Back to Top](#table-of-contents)**

---

#### **ä½œç”¨åŸŸåˆ†é¡**

1. **å…¨åŸŸä½œç”¨åŸŸ (Global Scope)**

   - åœ¨ç¨‹å¼æœ€å¤–å±¤å®£å‘Šçš„è®Šæ•¸ï¼Œå±¬æ–¼å…¨åŸŸä½œç”¨åŸŸï¼Œå¯ä»¥åœ¨ç¨‹å¼çš„ä»»ä½•éƒ¨åˆ†å­˜å–ã€‚
   - å…¨åŸŸè®Šæ•¸æœƒæ›è¼‰åˆ°å…¨åŸŸç‰©ä»¶ä¸Šï¼ˆå¦‚ `window` æˆ– `global`ï¼‰ã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     var globalVar = "I am global"; // å…¨åŸŸä½œç”¨åŸŸ
     console.log(globalVar); // å¯åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨
     ```

2. **å€åŸŸä½œç”¨åŸŸ (Local Scope)**

   - åœ¨å‡½å¼å…§éƒ¨æˆ–å€å¡Šå…§éƒ¨å®£å‘Šçš„è®Šæ•¸ï¼Œåƒ…èƒ½åœ¨è©²ç¯„åœå…§å­˜å–ã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     function testScope() {
       var localVar = "I am local"; // å€åŸŸä½œç”¨åŸŸ
       console.log(localVar); // å¯åœ¨å‡½å¼å…§å­˜å–
     }
     testScope();
     // console.log(localVar); // éŒ¯èª¤ï¼šç„¡æ³•åœ¨å‡½å¼å¤–éƒ¨å­˜å–
     ```

3. **å€å¡Šä½œç”¨åŸŸ (Block Scope)**

   - ä½¿ç”¨ `let` æˆ– `const` å®£å‘Šçš„è®Šæ•¸ï¼Œå…·å‚™å€å¡Šä½œç”¨åŸŸï¼Œåƒ…åœ¨è©²å€å¡Š `{}` ä¸­æœ‰æ•ˆã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     {
       let blockScopedVar = "I am block-scoped";
       console.log(blockScopedVar); // å¯åœ¨å€å¡Šå…§å­˜å–
     }
     // console.log(blockScopedVar); // éŒ¯èª¤ï¼šç„¡æ³•åœ¨å€å¡Šå¤–éƒ¨å­˜å–
     ```

---

#### **ä½œç”¨åŸŸç‰¹æ€§**

1. **è©æ³•ä½œç”¨åŸŸ (Lexical Scope)**

   - JavaScript ä½¿ç”¨è©æ³•ä½œç”¨åŸŸï¼Œä½œç”¨åŸŸç”±ç¨‹å¼ç¢¼çš„çµæ§‹åœ¨æ’°å¯«æ™‚æ±ºå®šï¼Œè€ŒéåŸ·è¡Œæ™‚ã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     function outerFunction() {
       var outerVar = "I am outer";
       function innerFunction() {
         console.log(outerVar); // å¯å­˜å–å¤–éƒ¨ä½œç”¨åŸŸçš„è®Šæ•¸
       }
       innerFunction();
     }
     outerFunction();
     ```

2. **ä½œç”¨åŸŸéˆ (Scope Chain)**

   - JavaScript æŸ¥æ‰¾è®Šæ•¸æ™‚ï¼Œæœƒå…ˆåœ¨ç•¶å‰ä½œç”¨åŸŸä¸­æ‰¾ï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡å‘å¤–å±¤ä½œç”¨åŸŸæŸ¥æ‰¾ï¼Œç›´åˆ°å…¨åŸŸä½œç”¨åŸŸã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     var globalVar = "global";

     function outerFunction() {
       var outerVar = "outer";
       function innerFunction() {
         var innerVar = "inner";
         console.log(globalVar); // å¾å…¨åŸŸä½œç”¨åŸŸå–å¾—
         console.log(outerVar); // å¾å¤–å±¤ä½œç”¨åŸŸå–å¾—
         console.log(innerVar); // å¾å…§å±¤ä½œç”¨åŸŸå–å¾—
       }
       innerFunction();
     }
     outerFunction();
     ```

---

#### **è®Šæ•¸æå‡ (Hoisting)**

- **`var` çš„æå‡ï¼š** è®Šæ•¸æå‡å¾Œåƒ…åˆå§‹åŒ–ç‚º `undefined`ï¼Œä¸åŒ…å«å…¶è³¦å€¼å…§å®¹ã€‚
- **`let` å’Œ `const` çš„æå‡ï¼š** æœƒå½¢æˆæš«æ™‚æ€§æ­»å€ï¼Œåœ¨å®£å‘Šå‰ç„¡æ³•å­˜å–ã€‚
- **ç¯„ä¾‹ï¼š**

  ```javascript
  console.log(hoistedVar); // undefined
  var hoistedVar = "I am hoisted";

  // console.log(notHoisted); // éŒ¯èª¤ï¼šæš«æ™‚æ€§æ­»å€
  let notHoisted = "I am not hoisted";
  ```

---

#### **å‡½å¼ä½œç”¨åŸŸ (Function Scope)**

- ä½¿ç”¨ `var` å®£å‘Šçš„è®Šæ•¸ï¼Œåƒ…åœ¨å‡½å¼å…§éƒ¨æœ‰æ•ˆã€‚
- **ç¯„ä¾‹ï¼š**

  ```javascript
  function funcScopeExample() {
    var funcScopedVar = "I am function-scoped";
    console.log(funcScopedVar); // åœ¨å‡½å¼å…§å­˜å–
  }
  funcScopeExample();
  // console.log(funcScopedVar); // éŒ¯èª¤ï¼šç„¡æ³•åœ¨å‡½å¼å¤–éƒ¨å­˜å–
  ```

---

#### **å…¨åŸŸä½œç”¨åŸŸèˆ‡æœ€ä½³å¯¦è¸**

1. **å…¨åŸŸè®Šæ•¸ï¼š**

   - å…¨åŸŸä½œç”¨åŸŸä¸­çš„è®Šæ•¸ç¨±ç‚ºå…¨åŸŸè®Šæ•¸ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹å­˜å–ï¼Œä½†å®¹æ˜“é€ æˆå‘½åè¡çªã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     var globalVar = "æˆ‘æ˜¯å…¨åŸŸè®Šæ•¸";

     function printGlobalVar() {
       console.log(globalVar); // å­˜å–å…¨åŸŸè®Šæ•¸
     }
     printGlobalVar(); // è¼¸å‡ºï¼šæˆ‘æ˜¯å…¨åŸŸè®Šæ•¸
     ```

2. **å…¨åŸŸç‰©ä»¶ï¼š**

   - å…¨åŸŸä½œç”¨åŸŸä¸­çš„è®Šæ•¸å’Œå‡½å¼æœƒæˆç‚ºå…¨åŸŸç‰©ä»¶çš„å±¬æ€§ã€‚
   - ç€è¦½å™¨ä¸­çš„å…¨åŸŸç‰©ä»¶æ˜¯ `window`ï¼ŒNode.js ä¸­æ˜¯ `global`ã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     var myVar = "Hello World"; // myVar æˆç‚º window çš„å±¬æ€§
     console.log(window.myVar); // è¼¸å‡ºï¼šHello World
     ```

3. **é¿å…å…¨åŸŸæ±¡æŸ“ï¼š**

   - æ¸›å°‘ä½¿ç”¨å…¨åŸŸè®Šæ•¸ï¼Œä½¿ç”¨æ¨¡çµ„åŒ–æˆ–å€å¡Šä½œç”¨åŸŸã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     (function () {
       var localVar = "æˆ‘æ˜¯å°è£åœ¨å‡½å¼å…§çš„è®Šæ•¸";
       console.log(localVar); // è¼¸å‡ºï¼šæˆ‘æ˜¯å°è£åœ¨å‡½å¼å…§çš„è®Šæ•¸
     })();
     console.log(typeof localVar); // è¼¸å‡ºï¼šundefined
     ```

4. **æœ€ä½³å¯¦è¸ï¼š**

   - ä½¿ç”¨ `let` å’Œ `const`ï¼Œé¿å…ä½¿ç”¨ `var`ã€‚
   - ä½¿ç”¨å‘½åç©ºé–“ï¼ˆNamespaceï¼‰å°è£ç¨‹å¼ç¢¼ã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     const MyApp = {
       config: {
         apiUrl: "https://api.example.com",
       },
       utils: {
         logMessage: function (message) {
           console.log(message);
         },
       },
     };
     MyApp.utils.logMessage("Hello Namespace!"); // è¼¸å‡ºï¼šHello Namespace!
     ```

---

#### **å€å¡Šä½œç”¨åŸŸèˆ‡ `let`ã€`const`**

1. **`let` å’Œ `const` çš„ç‰¹æ€§ï¼š**

   - å‰µé€ å€å¡Šä½œç”¨åŸŸï¼Œé¿å… `var` çš„ä½œç”¨åŸŸæ±¡æŸ“å•é¡Œã€‚
   - `const` ç”¨æ–¼å®£å‘Šå¸¸æ•¸ï¼Œéœ€åˆå§‹åŒ–ï¼Œä¸”ç„¡æ³•é‡æ–°è³¦å€¼ã€‚
   - **ç¯„ä¾‹ï¼š**

     ```javascript
     {
       let blockVar = "block scoped";
       const blockConst = "constant scoped";
       console.log(blockVar); // å¯å­˜å–
       console.log(blockConst); // å¯å­˜å–
     }
     // console.log(blockVar);  // éŒ¯èª¤ï¼šå€å¡Šå¤–éƒ¨ç„¡æ³•å­˜å–
     // console.log(blockConst); // éŒ¯èª¤ï¼šå€å¡Šå¤–éƒ¨ç„¡æ³•å­˜å–
     ```

---

#### **å‹•æ…‹ä½œç”¨åŸŸèˆ‡ `this`**

- **`this` çš„ç‰¹æ€§ï¼š** æŒ‡å‘åŸ·è¡Œæ™‚çš„ä¸Šä¸‹æ–‡ï¼Œè€Œéç”±è©æ³•ä½œç”¨åŸŸæ±ºå®šã€‚
- **ç¯„ä¾‹ï¼š**

  ```javascript
  function showThis() {
    console.log(this); // æ ¹æ“šåŸ·è¡Œæ–¹å¼æ±ºå®š `this` çš„æŒ‡å‘
  }
  showThis(); // åœ¨å…¨åŸŸä¸­åŸ·è¡Œï¼ŒæŒ‡å‘å…¨åŸŸç‰©ä»¶
  ```

---

#### **é–‰åŒ… (Closure)**

- é–‰åŒ…æŒ‡å‡½å¼å¯ä»¥è¨˜ä½ä¸¦å­˜å–å…¶å®šç¾©æ™‚çš„ä½œç”¨åŸŸï¼Œå³ä½¿å‡½å¼åœ¨å…¶ä»–åœ°æ–¹åŸ·è¡Œã€‚
- **ç¯„ä¾‹ï¼š**

  ```javascript
  function makeCounter() {
    let count = 0;
    return function () {
      count++;
      return count;
    };
  }
  const counter = makeCounter();
  console.log(counter()); // 1
  console.log(counter()); // 2
  ```

**[ğŸ” Back to Top](#table-of-contents)**

---

### 4. Scope ä½œç”¨åŸŸ

JavaScript çš„ä½œç”¨åŸŸï¼ˆScopeï¼‰æ˜¯æŒ‡ç¨‹å¼ä¸­è®Šæ•¸ã€å‡½å¼ç­‰æ¨™è­˜ç¬¦çš„å¯è¨ªå•ç¯„åœã€‚ä½œç”¨åŸŸç¢ºä¿ä»£ç¢¼çš„çµæ§‹æ¸…æ™°ï¼Œä¸¦é¿å…è®Šæ•¸å‘½åè¡çªã€‚ä»¥ä¸‹æ˜¯æœ‰é—œä½œç”¨åŸŸçš„å®Œæ•´ç­†è¨˜ï¼š

---

#### 4.1 ä½œç”¨åŸŸçš„ç¨®é¡

1. **å…¨åŸŸä½œç”¨åŸŸï¼ˆGlobal Scopeï¼‰**

   - å®šç¾©ï¼šåœ¨ä»»ä½•å‡½å¼æˆ–å€å¡Šä¹‹å¤–å®£å‘Šçš„è®Šæ•¸å±¬æ–¼å…¨åŸŸä½œç”¨åŸŸã€‚
   - ç‰¹æ€§ï¼šå…¨åŸŸä½œç”¨åŸŸçš„è®Šæ•¸å¯ä»¥åœ¨ç¨‹å¼çš„ä»»ä½•åœ°æ–¹è¢«å­˜å–ã€‚
   - ç¯„ä¾‹ï¼š

     ```javascript
     let globalVar = "æˆ‘æ˜¯å…¨åŸŸè®Šæ•¸";
     function showGlobalVar() {
       console.log(globalVar); // å¯ä»¥å­˜å–å…¨åŸŸè®Šæ•¸
     }
     showGlobalVar();
     ```

2. **å‡½å¼ä½œç”¨åŸŸï¼ˆFunction Scopeï¼‰**

   - å®šç¾©ï¼šåœ¨å‡½å¼å…§å®£å‘Šçš„è®Šæ•¸åªèƒ½åœ¨è©²å‡½å¼å…§å­˜å–ã€‚
   - ç‰¹æ€§ï¼šå‡½å¼ä½œç”¨åŸŸæ˜¯ JavaScript ä¸­æœ€æ—©çš„ä½œç”¨åŸŸé¡å‹ã€‚
   - ç¯„ä¾‹ï¼š

     ```javascript
     function myFunction() {
       let functionVar = "æˆ‘æ˜¯å‡½å¼ä½œç”¨åŸŸçš„è®Šæ•¸";
       console.log(functionVar); // å¯ä»¥å­˜å–
     }
     myFunction();
     // console.log(functionVar); // ç„¡æ³•å­˜å–ï¼Œæœƒå ±éŒ¯
     ```

3. **å€å¡Šä½œç”¨åŸŸï¼ˆBlock Scopeï¼‰**

   - å®šç¾©ï¼šç”¨ `{}` åŒ…è£¹çš„å€å¡Šå…§å®£å‘Šçš„è®Šæ•¸åªèƒ½åœ¨è©²å€å¡Šå…§å­˜å–ã€‚
   - é—œéµå­—ï¼š`let` å’Œ `const` æ”¯æ´å€å¡Šä½œç”¨åŸŸï¼›`var` ä¸æ”¯æ´ã€‚
   - ç¯„ä¾‹ï¼š

     ```javascript
     {
       let blockVar = "æˆ‘æ˜¯å€å¡Šä½œç”¨åŸŸçš„è®Šæ•¸";
       console.log(blockVar); // å¯ä»¥å­˜å–
     }
     // console.log(blockVar); // ç„¡æ³•å­˜å–ï¼Œæœƒå ±éŒ¯
     ```

---

#### 4.2 ä½œç”¨åŸŸéˆï¼ˆScope Chainï¼‰

- å®šç¾©ï¼šç•¶ä¸€å€‹è®Šæ•¸åœ¨ç•¶å‰ä½œç”¨åŸŸä¸­æ‰¾ä¸åˆ°æ™‚ï¼ŒJavaScript æœƒæ²¿è‘—ä½œç”¨åŸŸéˆå¾€ä¸Šä¸€å±¤å°‹æ‰¾ï¼Œç›´åˆ°å…¨åŸŸä½œç”¨åŸŸæˆ–é‡åˆ° `undefined`ã€‚
- ç‰¹æ€§ï¼šä½œç”¨åŸŸéˆç”±åµŒå¥—çš„å‡½å¼æˆ–å€å¡Šçµæ§‹å½¢æˆã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  let globalVar = "æˆ‘æ˜¯å…¨åŸŸè®Šæ•¸";

  function outerFunction() {
    let outerVar = "æˆ‘æ˜¯å¤–éƒ¨å‡½å¼çš„è®Šæ•¸";

    function innerFunction() {
      let innerVar = "æˆ‘æ˜¯å…§éƒ¨å‡½å¼çš„è®Šæ•¸";
      console.log(globalVar); // å¾€ä¸Šæ‰¾ï¼Œæ‰¾åˆ°å…¨åŸŸè®Šæ•¸
      console.log(outerVar); // å¾€ä¸Šæ‰¾ï¼Œæ‰¾åˆ°å¤–éƒ¨å‡½å¼è®Šæ•¸
      console.log(innerVar); // ç›´æ¥æ‰¾åˆ°å…§éƒ¨å‡½å¼è®Šæ•¸
    }

    innerFunction();
  }

  outerFunction();
  ```

---

#### 4.3 é—œéµå­—çš„ä½œç”¨åŸŸè¡Œç‚º

1. **`var` çš„ç‰¹æ€§**

   - åƒ…æ”¯æ´å‡½å¼ä½œç”¨åŸŸï¼Œä¸æ”¯æ´å€å¡Šä½œç”¨åŸŸã€‚
   - å¯èƒ½å°è‡´è®Šæ•¸æå‡ï¼ˆHoistingï¼‰ï¼Œä½¿ç¨‹å¼æ˜“å‡ºç¾æ„å¤–è¡Œç‚ºã€‚
   - ç¯„ä¾‹ï¼š

     ```javascript
     {
       var varVariable = "æˆ‘æ˜¯ var å®£å‘Šçš„è®Šæ•¸";
     }
     console.log(varVariable); // å¯ä»¥å­˜å–ï¼Œå›  var ä¸æ”¯æ´å€å¡Šä½œç”¨åŸŸ
     ```

2. **`let` çš„ç‰¹æ€§**

   - æ”¯æ´å€å¡Šä½œç”¨åŸŸï¼Œé¿å…è®Šæ•¸æå‡ã€‚
   - ç¯„ä¾‹ï¼š

     ```javascript
     {
       let letVariable = "æˆ‘æ˜¯ let å®£å‘Šçš„è®Šæ•¸";
       console.log(letVariable); // å¯ä»¥å­˜å–
     }
     // console.log(letVariable); // ç„¡æ³•å­˜å–ï¼Œæœƒå ±éŒ¯
     ```

3. **`const` çš„ç‰¹æ€§**

   - æ”¯æ´å€å¡Šä½œç”¨åŸŸï¼Œé¡ä¼¼ `let`ï¼Œä½†å®£å‘Šå¾Œä¸å¯é‡æ–°è³¦å€¼ã€‚
   - ç¯„ä¾‹ï¼š

     ```javascript
     const constVariable = "æˆ‘æ˜¯ const å®£å‘Šçš„è®Šæ•¸";
     console.log(constVariable); // å¯ä»¥å­˜å–
     // constVariable = "é‡æ–°è³¦å€¼"; // æœƒå ±éŒ¯ï¼Œå›  const ä¸å¯é‡æ–°è³¦å€¼
     ```

---

#### 4.4 è®Šæ•¸æå‡ï¼ˆHoistingï¼‰

- å®šç¾©ï¼šåœ¨ JavaScript ä¸­ï¼Œä½¿ç”¨ `var` å®£å‘Šçš„è®Šæ•¸æœƒåœ¨ç¨‹å¼åŸ·è¡Œå‰è¢«æå‡åˆ°ä½œç”¨åŸŸçš„æœ€ä¸Šæ–¹ï¼Œä½†ä¸æœƒè³¦å€¼ã€‚
- ç‰¹æ€§ï¼š`let` å’Œ `const` ä¸æœƒè¢«æå‡ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  console.log(hoistedVar); // undefinedï¼Œå› ç‚º var è¢«æå‡ä½†æœªè³¦å€¼
  var hoistedVar = "æˆ‘æ˜¯è¢«æå‡çš„è®Šæ•¸";

  // console.log(hoistedLet); // æœƒå ±éŒ¯ï¼Œå›  let ä¸æœƒè¢«æå‡
  let hoistedLet = "æˆ‘æ˜¯æœªè¢«æå‡çš„è®Šæ•¸";
  ```

---

#### 4.5 é–‰åŒ…ï¼ˆClosureï¼‰

- å®šç¾©ï¼šé–‰åŒ…æ˜¯æŒ‡å‡½å¼å¯ä»¥è¨˜ä½ä¸¦å­˜å–å…¶å®šç¾©æ™‚çš„ä½œç”¨åŸŸï¼Œå³ä½¿è©²å‡½å¼åœ¨ä½œç”¨åŸŸä¹‹å¤–åŸ·è¡Œã€‚
- ç‰¹æ€§ï¼šé–‰åŒ…å¸¸ç”¨æ–¼æ¨¡æ“¬ç§æœ‰è®Šæ•¸æˆ–å°è£ç¨‹å¼é‚è¼¯ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  function createCounter() {
    let count = 0; // ç§æœ‰è®Šæ•¸ï¼Œå¤–éƒ¨ç„¡æ³•ç›´æ¥å­˜å–

    return function () {
      count++;
      console.log(count);
    };
  }

  const counter = createCounter();
  counter(); // 1
  counter(); // 2
  ```

---

#### 4.6 æ¨¡å¡Šä½œç”¨åŸŸï¼ˆModule Scopeï¼‰

- å®šç¾©ï¼šåœ¨ ES6 ä¸­ï¼Œæ¨¡çµ„ï¼ˆModuleï¼‰æä¾›äº†ä¸€å€‹ç¨ç«‹çš„ä½œç”¨åŸŸï¼Œæ¨¡çµ„å…§çš„è®Šæ•¸å’Œå‡½å¼ä¸æœƒæ±¡æŸ“å…¨åŸŸä½œç”¨åŸŸã€‚
- é—œéµå­—ï¼šä½¿ç”¨ `export` å’Œ `import` é€²è¡Œæ¨¡çµ„åŒ–ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  // module.js
  export const moduleVar = "æˆ‘æ˜¯æ¨¡çµ„ä½œç”¨åŸŸçš„è®Šæ•¸";

  // main.js
  import { moduleVar } from "./module.js";
  console.log(moduleVar); // å¯ä»¥å­˜å–æ¨¡çµ„è®Šæ•¸
  ```

---

#### 4.7 åš´æ ¼æ¨¡å¼ï¼ˆStrict Modeï¼‰

- å®šç¾©ï¼šåš´æ ¼æ¨¡å¼å¯ä»¥æå‡ä½œç”¨åŸŸçš„å®‰å…¨æ€§ï¼Œé¿å…ä¸æ˜ç¢ºçš„è®Šæ•¸å®£å‘Šã€‚
- å•Ÿç”¨æ–¹å¼ï¼šåœ¨ç¨‹å¼ç¢¼æˆ–å‡½å¼çš„é–‹é ­ä½¿ç”¨ `"use strict"`ã€‚
- ç‰¹æ€§ï¼šæœªå®£å‘Šçš„è®Šæ•¸æœƒæ‹‹å‡ºéŒ¯èª¤ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  "use strict";
  // undeclaredVar = "æœªå®£å‘Šçš„è®Šæ•¸"; // æœƒå ±éŒ¯
  let declaredVar = "å·²å®£å‘Šçš„è®Šæ•¸";
  console.log(declaredVar); // æ­£å¸¸é‹è¡Œ
  ```

---

#### 4.8 ä½œç”¨åŸŸèˆ‡äº‹ä»¶å¾ªç’°ï¼ˆEvent Loopï¼‰

- å®šç¾©ï¼šäº‹ä»¶å¾ªç’°æ˜¯ JavaScript çš„éåŒæ­¥åŸ·è¡Œæ©Ÿåˆ¶ï¼Œä½œç”¨åŸŸæœƒå½±éŸ¿é–‰åŒ…å’ŒéåŒæ­¥ä»»å‹™çš„è¡Œç‚ºã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  function asyncTest() {
    for (let i = 0; i < 3; i++) {
      setTimeout(() => {
        console.log(i); // æ­£å¸¸è¼¸å‡ºï¼š0, 1, 2
      }, 100);
    }
  }
  asyncTest();
  ```

**[ğŸ” Back to Top](#table-of-contents)**

---

### 5. Variable Declaration è®Šæ•¸å®£å‘Š

åœ¨ JavaScript ä¸­ï¼Œè®Šæ•¸å®£å‘Š (Variable Declaration) æ˜¯å»ºç«‹å’Œå„²å­˜è³‡æ–™çš„åŸºæœ¬æ–¹å¼ã€‚ä»¥ä¸‹æ˜¯ JavaScript ä¸­çš„ä¸‰ç¨®ä¸»è¦è®Šæ•¸å®£å‘Šæ–¹å¼ï¼š`var`ã€`let` å’Œ `const`ï¼Œä»¥åŠå®ƒå€‘çš„ç‰¹æ€§èˆ‡ä½¿ç”¨ç¯„ä¾‹ã€‚

---

#### 5.1 `var` å®£å‘Š

`var` æ˜¯ JavaScript ä¸­æœ€æ—©å‡ºç¾çš„è®Šæ•¸å®£å‘Šæ–¹å¼ï¼Œä½†å› ç‚ºä½œç”¨åŸŸ (Scope) çš„è¡Œç‚ºè¼ƒä¸ç›´è¦ºï¼Œç¾ä»£é–‹ç™¼ä¸­è¼ƒå°‘ä½¿ç”¨ã€‚

- **ç‰¹æ€§**ï¼š

  1. **å‡½å¼ä½œç”¨åŸŸ** (Function Scope)ï¼š`var` å®£å‘Šçš„è®Šæ•¸åªèƒ½åœ¨å‡½å¼å…§æœ‰æ•ˆã€‚
  2. **å…è¨±é‡è¤‡å®£å‘Š**ï¼šåŒä¸€ä½œç”¨åŸŸå…§å¯ä»¥å¤šæ¬¡ä½¿ç”¨ `var` å®£å‘Šç›¸åŒåç¨±çš„è®Šæ•¸ã€‚
  3. **æå‡ (Hoisting)**ï¼š`var` å®£å‘Šçš„è®Šæ•¸æœƒåœ¨ä½œç”¨åŸŸçš„æœ€ä¸Šæ–¹è¢«åˆå§‹åŒ–ç‚º `undefined`ã€‚

- **ç¯„ä¾‹**ï¼š

  ```javascript
  console.log(a); // undefined (è®Šæ•¸æå‡)
  var a = 10;
  console.log(a); // 10

  if (true) {
    var b = 20; // `b` åœ¨æ•´å€‹å‡½å¼ä½œç”¨åŸŸå…§æœ‰æ•ˆ
  }
  console.log(b); // 20
  ```

---

#### 5.2 `let` å®£å‘Š

`let` æ˜¯ ES6 (ECMAScript 2015) ä¸­å¼•å…¥çš„è®Šæ•¸å®£å‘Šæ–¹å¼ï¼Œè§£æ±ºäº† `var` çš„ä¸€äº›å•é¡Œã€‚

- **ç‰¹æ€§**ï¼š

  1. **å€å¡Šä½œç”¨åŸŸ** (Block Scope)ï¼š`let` å®£å‘Šçš„è®Šæ•¸åƒ…åœ¨ `{}` å€å¡Šå…§æœ‰æ•ˆã€‚
  2. **ä¸å…è¨±é‡è¤‡å®£å‘Š**ï¼šåŒä¸€ä½œç”¨åŸŸå…§ä¸èƒ½ä½¿ç”¨ç›¸åŒåç¨±çš„è®Šæ•¸é‡è¤‡å®£å‘Šã€‚
  3. **æå‡ä½†ä¸å¯ä½¿ç”¨**ï¼š`let` è®Šæ•¸æœƒæå‡ï¼Œä½†åœ¨åˆå§‹åŒ–å‰ç„¡æ³•ä½¿ç”¨ (ç¨±ç‚ºæš«æ™‚æ€§æ­»å€ï¼ŒTemporal Dead Zone, TDZ)ã€‚

- **ç¯„ä¾‹**ï¼š

  ```javascript
  if (true) {
    let x = 10;
    console.log(x); // 10
  }
  // console.log(x); // ReferenceError: x is not defined

  let y = 5;
  // let y = 10; // SyntaxError: Identifier 'y' has already been declared
  ```

---

#### 5.3 `const` å®£å‘Š

`const` æ˜¯ ES6 ä¸­å¼•å…¥çš„ï¼Œç”¨æ–¼å®£å‘Šå¸¸æ•¸ (Constant)ã€‚ä¸€æ—¦å®£å‘Šå¾Œï¼Œè®Šæ•¸çš„å€¼ä¸å¯æ”¹è®Šã€‚

- **ç‰¹æ€§**ï¼š

  1. **å€å¡Šä½œç”¨åŸŸ** (Block Scope)ï¼šèˆ‡ `let` ç›¸åŒï¼Œåƒ…åœ¨ `{}` å€å¡Šå…§æœ‰æ•ˆã€‚
  2. **å¿…é ˆç«‹å³åˆå§‹åŒ–**ï¼šå®£å‘Šæ™‚å¿…é ˆæŒ‡å®šåˆå§‹å€¼ã€‚
  3. **ä¸å¯é‡æ–°è³¦å€¼**ï¼šå€¼ä¸€æ—¦è¨­å®šå¾Œï¼Œä¸èƒ½å†æ›´æ”¹ã€‚
  4. **å°æ–¼ç‰©ä»¶å’Œé™£åˆ— (Object and Array)**ï¼š`const` å®£å‘Šçš„ç‰©ä»¶æˆ–é™£åˆ—æœ¬èº«ä¸å¯é‡æ–°æŒ‡æ´¾ (reassignment)ï¼Œä½†å…¶å…§å®¹å¯ä»¥ä¿®æ”¹ã€‚

- **ç¯„ä¾‹**ï¼š

  ```javascript
  const z = 50;
  // z = 60; // TypeError: Assignment to constant variable.

  const arr = [1, 2, 3];
  arr.push(4); // å¯ä»¥ä¿®æ”¹é™£åˆ—å…§å®¹
  console.log(arr); // [1, 2, 3, 4]

  const obj = { name: "John" };
  obj.age = 30; // å¯ä»¥ä¿®æ”¹ç‰©ä»¶å±¬æ€§
  console.log(obj); // { name: "John", age: 30 }
  ```

---

#### 5.4 ä¸‰ç¨®å®£å‘Šæ–¹å¼æ¯”è¼ƒ

| ç‰¹æ€§                              | `var`                       | `let`                    | `const`                  |
| --------------------------------- | --------------------------- | ------------------------ | ------------------------ |
| **ä½œç”¨åŸŸ**                        | å‡½å¼ä½œç”¨åŸŸ (Function Scope) | å€å¡Šä½œç”¨åŸŸ (Block Scope) | å€å¡Šä½œç”¨åŸŸ (Block Scope) |
| **æå‡ (Hoisting)**               | æ˜¯ (åˆå§‹åŒ–ç‚º `undefined`)   | æ˜¯ (ä½†ä¸å¯ä½¿ç”¨ï¼ŒTDZ)     | æ˜¯ (ä½†ä¸å¯ä½¿ç”¨ï¼ŒTDZ)     |
| **å…è¨±é‡è¤‡å®£å‘Š**                  | æ˜¯                          | å¦                       | å¦                       |
| **æ˜¯å¦å¿…é ˆåˆå§‹åŒ–**                | å¦                          | å¦                       | æ˜¯                       |
| **æ˜¯å¦å¯é‡æ–°è³¦å€¼ (Reassignment)** | æ˜¯                          | æ˜¯                       | å¦                       |

---

#### 5.5 ä½¿ç”¨å»ºè­°

1. **å„ªå…ˆä½¿ç”¨ `const`**ï¼šèƒ½ä½¿ç”¨å¸¸æ•¸çš„æƒ…æ³ä¸‹ï¼Œå„˜é‡ä½¿ç”¨ `const`ï¼Œä»¥é¿å…æ„å¤–æ”¹å‹•è®Šæ•¸å€¼ã€‚
2. **éœ€è¦æ”¹è®Šå€¼æ™‚ä½¿ç”¨ `let`**ï¼šå¦‚æœè®Šæ•¸çš„å€¼éœ€è¦æ›´æ–°ï¼Œå‰‡ä½¿ç”¨ `let`ã€‚
3. **é¿å…ä½¿ç”¨ `var`**ï¼š`var` çš„ä½œç”¨åŸŸè¡Œç‚ºæ˜“å°è‡´éŒ¯èª¤ï¼Œé™¤ééœ€æ”¯æ´èˆŠç‰ˆç€è¦½å™¨ï¼Œå¦å‰‡ä¸å»ºè­°ä½¿ç”¨ã€‚

---

**[ğŸ” Back to Top](#table-of-contents)**

---

### 6. Temporal Dead Zone æš«æ™‚æ€§æ­»å€

åœ¨ JavaScript ä¸­ï¼Œ`let` å’Œ `const` å®£å‘Šçš„è®Šæ•¸æœ‰ä¸€å€‹ç‰¹æ®Šçš„è¡Œç‚ºï¼Œç¨±ç‚º **Temporal Dead Zone (TDZ, æš«æ™‚æ€§æ­»å€)**ã€‚é€™æ˜¯ä¸€å€‹è®Šæ•¸åœ¨å®£å‘Šä¹‹å‰ç„¡æ³•è¢«å­˜å–çš„ç¯„åœã€‚

---

#### Temporal Dead Zone (TDZ) æ˜¯ä»€éº¼ï¼Ÿ

ç•¶è®Šæ•¸ä½¿ç”¨ `let` æˆ– `const` å®£å‘Šæ™‚ï¼Œè©²è®Šæ•¸åœ¨å…¶å®£å‘Šèªå¥ä¹‹å‰çš„ç¨‹å¼ç¢¼å€é–“å…§è™•æ–¼ **æš«æ™‚æ€§æ­»å€ (Temporal Dead Zone)**ã€‚åœ¨é€™æ®µå€åŸŸå…§ï¼Œè®Šæ•¸è¢«è¦–ç‚ºå·²ç¶“å­˜åœ¨æ–¼ä½œç”¨åŸŸä¸­ï¼Œä½†å°šæœªå®Œæˆåˆå§‹åŒ–ï¼Œå› æ­¤ä»»ä½•å°è©²è®Šæ•¸çš„å­˜å–éƒ½æœƒæ‹‹å‡ºéŒ¯èª¤ã€‚

---

#### ç‰¹æ€§èˆ‡è¡Œç‚º

1. **è®Šæ•¸çš„ç”Ÿå‘½å‘¨æœŸ**ï¼š

   - åœ¨åŸ·è¡Œ `let` æˆ– `const` å®£å‘Šä¹‹å‰ï¼Œè®Šæ•¸å·²é€²å…¥ä½œç”¨åŸŸ (Scope)ã€‚
   - åœ¨å®£å‘Šä¹‹å‰ï¼Œè®Šæ•¸è™•æ–¼æš«æ™‚æ€§æ­»å€ (TDZ)ï¼Œç„¡æ³•è¢«å­˜å–ã€‚
   - åœ¨å®£å‘Šä¹‹å¾Œï¼Œè®Šæ•¸æ‰å¯è¢«æ­£å¸¸ä½¿ç”¨ã€‚

2. **éŒ¯èª¤çš„é¡å‹**ï¼š

   - å¦‚æœåœ¨ TDZ ä¸­å­˜å–è®Šæ•¸ï¼Œæœƒæ‹‹å‡º `ReferenceError`ã€‚

3. **ä½œç”¨æ–¼ `let` å’Œ `const`**ï¼š

   - åªæœ‰ `let` å’Œ `const` å®£å‘Šæœƒæœ‰ TDZ çš„è¡Œç‚ºã€‚
   - `var` å®£å‘Šå‰‡æ²’æœ‰ TDZï¼Œå› ç‚ºå®ƒæœƒè¢«ã€Œæå‡ (Hoisting)ã€ï¼Œä¸¦åˆå§‹åŒ–ç‚º `undefined`ã€‚

4. **å‡½å¼èˆ‡åƒæ•¸å½±éŸ¿**ï¼š
   - å¦‚æœå‡½å¼çš„åƒæ•¸ä½¿ç”¨äº† `let` æˆ– `const`ï¼Œåƒæ•¸è®Šæ•¸ä¹Ÿå¯èƒ½æœƒå—åˆ° TDZ çš„å½±éŸ¿ã€‚

---

#### ç¯„ä¾‹è§£æ

1. **åŸºæœ¬ç¯„ä¾‹**

   ```javascript
   console.log(a); // ReferenceError: Cannot access 'a' before initialization
   let a = 10;
   ```

   - åœ¨ `let a = 10;` å®£å‘Šä¹‹å‰ï¼Œè®Šæ•¸ `a` è™•æ–¼ TDZ ä¸­ã€‚
   - å› æ­¤ï¼Œåœ¨å®£å‘Šä¹‹å‰å­˜å– `a`ï¼Œæœƒæ‹‹å‡º `ReferenceError`ã€‚

2. **TDZ çš„ç¯„åœ**

   ```javascript
   {
     console.log(b); // ReferenceError
     let b = 20;
   }
   ```

   - è®Šæ•¸ `b` çš„ TDZ å¾ä½œç”¨åŸŸå€å¡Š `{` é–‹å§‹ï¼Œåˆ° `let b = 20;` å®£å‘Šç‚ºæ­¢ã€‚

3. **ä¸å— TDZ é™åˆ¶çš„ `var`**

   ```javascript
   console.log(c); // undefined
   var c = 30;
   ```

   - ä½¿ç”¨ `var` å®£å‘Šçš„è®Šæ•¸æœƒè¢«æå‡ (Hoisted) ä¸¦åˆå§‹åŒ–ç‚º `undefined`ï¼Œå› æ­¤ä¸æœƒæ‹‹å‡ºéŒ¯èª¤ã€‚

4. **å‡½å¼åƒæ•¸çš„ TDZ**

   ```javascript
   function example(d = e) {
     let e = 50;
     return d;
   }
   console.log(example()); // ReferenceError: Cannot access 'e' before initialization
   ```

   - åœ¨å‡½å¼ä¸­ï¼Œ`let e = 50;` çš„ TDZ å½±éŸ¿å‡½å¼åƒæ•¸ `d = e` çš„åˆå§‹åŒ–ï¼Œå› æ­¤æœƒæ‹‹å‡º `ReferenceError`ã€‚

5. **`const` çš„ TDZ**

   ```javascript
   console.log(f); // ReferenceError
   const f = 40;
   ```

   - `const` å®£å‘Šçš„è®Šæ•¸åŒæ¨£æœ‰ TDZ è¡Œç‚ºï¼Œä¸”åœ¨å®£å‘Šå¾Œå¿…é ˆç«‹å³è³¦å€¼ã€‚

---

#### ç‚ºä»€éº¼æœƒæœ‰ TDZï¼Ÿ

TDZ çš„è¨­è¨ˆæ˜¯ç‚ºäº†è®“ç¨‹å¼ç¢¼æ›´å®‰å…¨ï¼Œé¿å…é–‹ç™¼è€…åœ¨è®Šæ•¸å°šæœªåˆå§‹åŒ–å‰å°±é€²è¡Œå­˜å–ã€‚é€™èˆ‡ `var` çš„ã€Œæå‡ã€è¡Œç‚ºç›¸æ¯”ï¼Œèƒ½æœ‰æ•ˆæ¸›å°‘å› ä½¿ç”¨æœªåˆå§‹åŒ–è®Šæ•¸è€Œå°è‡´çš„éŒ¯èª¤ã€‚

---

#### TDZ çš„æ‡‰ç”¨èˆ‡æ³¨æ„äº‹é …

1. **è‰¯å¥½è®Šæ•¸ç®¡ç†**ï¼š

   - ç¢ºä¿è®Šæ•¸åœ¨ä½¿ç”¨ä¹‹å‰å…ˆå®£å‘Šä¸¦åˆå§‹åŒ–ã€‚

2. **é¿å…æ··æ·†çš„è®Šæ•¸æå‡**ï¼š

   - å„˜é‡ä½¿ç”¨ `let` å’Œ `const`ï¼Œé¿å…ä½¿ç”¨ `var`ï¼Œä»¥é™ä½ä¸å¿…è¦çš„è¡Œç‚ºæ··äº‚ã€‚

3. **å‡½å¼ä¸­é¿å… TDZ å•é¡Œ**ï¼š

   - å°å¿ƒå‡½å¼åƒæ•¸çš„åˆå§‹åŒ–é †åºï¼Œé¿å… TDZ çš„éŒ¯èª¤ã€‚

4. **éµå¾ªå€å¡Šä½œç”¨åŸŸ (Block Scope)**ï¼š
   - ç†Ÿæ‚‰ `let` å’Œ `const` çš„å€å¡Šä½œç”¨åŸŸç¯„åœï¼Œé¿å…åœ¨ä½œç”¨åŸŸå¤–å­˜å–è®Šæ•¸ã€‚

---

#### ç¸½çµ

- **Temporal Dead Zone (TDZ, æš«æ™‚æ€§æ­»å€)** æ˜¯ `let` å’Œ `const` çš„ç‰¹æ€§ã€‚
- åœ¨è®Šæ•¸å®£å‘Šä¹‹å‰ï¼Œè®Šæ•¸è™•æ–¼ TDZ ä¸­ï¼Œä»»ä½•å­˜å–éƒ½æœƒæ‹‹å‡º `ReferenceError`ã€‚
- TDZ çš„ç›®çš„æ˜¯æå‡ç¨‹å¼ç¢¼çš„å®‰å…¨æ€§ï¼Œé¼“å‹µæ›´åš´è¬¹çš„è®Šæ•¸ä½¿ç”¨æ–¹å¼ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 7. Prototype and Inheritance åŸå‹èˆ‡ç¹¼æ‰¿

### Prototype and Inheritance åŸå‹èˆ‡ç¹¼æ‰¿

åœ¨ JavaScript ä¸­ï¼Œç‰©ä»¶(Object)çš„åŸå‹æ©Ÿåˆ¶(Prototype Mechanism)æ˜¯æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ã€‚åŸå‹å…è¨±ç‰©ä»¶é€éç¹¼æ‰¿(Inheritance)å…±äº«å±¬æ€§å’Œæ–¹æ³•ï¼Œæé«˜ç¨‹å¼ç¢¼çš„é‡ç”¨æ€§å’Œæ•ˆç‡ã€‚

---

#### åŸå‹ (Prototype)

- **åŸå‹(Prototype)** æ˜¯æ¯å€‹ JavaScript ç‰©ä»¶çš„éš±è—å±¬æ€§ï¼ŒæŒ‡å‘å¦ä¸€å€‹ç‰©ä»¶ï¼ˆå³åŸå‹ç‰©ä»¶ï¼‰ã€‚ç‰©ä»¶å¯ä»¥é€šéå…¶åŸå‹ä¾†ç¹¼æ‰¿å±¬æ€§å’Œæ–¹æ³•ã€‚
- æ¯å€‹ç‰©ä»¶éƒ½æœ‰ä¸€å€‹å…§éƒ¨å±¬æ€§ `[[Prototype]]`ï¼Œåœ¨ ES6 ä¸­å¯ä»¥ä½¿ç”¨ `Object.getPrototypeOf(obj)` ä¾†å­˜å–ã€‚

##### Prototype èˆ‡ `__proto__`

- `__proto__` æ˜¯æ—©æœŸç”¨ä¾†å­˜å–ç‰©ä»¶çš„åŸå‹çš„æ–¹å¼ï¼Œä½†ç¾åœ¨å»ºè­°ä½¿ç”¨ `Object.getPrototypeOf(obj)` å’Œ `Object.setPrototypeOf(obj, prototype)`ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  const obj = {};
  console.log(obj.__proto__); // [Object: null prototype] {}
  console.log(Object.getPrototypeOf(obj)); // [Object: null prototype] {}
  ```

---

#### åŸå‹éˆ (Prototype Chain)

- åŸå‹éˆæ˜¯ç‰©ä»¶é€éåŸå‹å±¬æ€§é€£çµèµ·ä¾†çš„éˆå¼çµæ§‹ã€‚
- å¦‚æœåœ¨ç‰©ä»¶ä¸­æ‰¾ä¸åˆ°æŸå€‹å±¬æ€§æˆ–æ–¹æ³•ï¼ŒJavaScript æœƒæ²¿è‘—åŸå‹éˆå‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ç‚ºæ­¢ã€‚å¦‚æœæ•´å€‹éˆéƒ½æ‰¾ä¸åˆ°ï¼Œå‰‡è¿”å› `undefined`ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  const obj = { name: "Alice" };
  console.log(obj.toString()); // ç‰©ä»¶çš„ `toString()` æ˜¯å¾åŸå‹ Object.prototype ç¹¼æ‰¿ä¾†çš„
  ```

---

#### Object.create()

- `Object.create(prototype)` æ˜¯ç”¨ä¾†å»ºç«‹ä¸€å€‹å…·æœ‰æŒ‡å®šåŸå‹çš„ç‰©ä»¶ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  const parent = { greet: "Hello" };
  const child = Object.create(parent);
  console.log(child.greet); // "Hello"
  ```

---

#### Constructor Function å»ºæ§‹å‡½æ•¸

- å»ºæ§‹å‡½æ•¸(Constructor Function)æ˜¯ä¸€ç¨®ç”¨ä¾†ç”Ÿæˆç‰©ä»¶çš„ç‰¹æ®Šå‡½æ•¸ã€‚ç‰©ä»¶æœƒè‡ªå‹•ç¹¼æ‰¿å»ºæ§‹å‡½æ•¸çš„åŸå‹ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  function Person(name) {
    this.name = name;
  }
  Person.prototype.greet = function () {
    return `Hello, ${this.name}`;
  };

  const alice = new Person("Alice");
  console.log(alice.greet()); // "Hello, Alice"
  ```

---

#### ES6 Class èªæ³•

- ES6 å¼•å…¥äº† `class` èªæ³•ï¼Œè®“ç‰©ä»¶çš„åŸå‹ç¹¼æ‰¿æ›´å®¹æ˜“æ›¸å¯«å’Œç†è§£ã€‚`class` å…¶å¯¦æ˜¯ `prototype` çš„èªæ³•ç³–ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  class Person {
    constructor(name) {
      this.name = name;
    }

    greet() {
      return `Hello, ${this.name}`;
    }
  }

  const bob = new Person("Bob");
  console.log(bob.greet()); // "Hello, Bob"
  ```

---

#### ç¹¼æ‰¿ (Inheritance)

##### ä½¿ç”¨åŸå‹éˆç¹¼æ‰¿

- ç‰©ä»¶å¯ä»¥é€šéåŸå‹éˆä¾†ç¹¼æ‰¿å…¶ä»–ç‰©ä»¶çš„å±¬æ€§å’Œæ–¹æ³•ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  const parent = { greet: "Hello" };
  const child = Object.create(parent);
  console.log(child.greet); // "Hello"
  ```

##### ES6 Class ç¹¼æ‰¿

- ä½¿ç”¨ `extends` é—œéµå­—é€²è¡Œç¹¼æ‰¿ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  class Animal {
    constructor(name) {
      this.name = name;
    }

    speak() {
      return `${this.name} makes a noise.`;
    }
  }

  class Dog extends Animal {
    speak() {
      return `${this.name} barks.`;
    }
  }

  const dog = new Dog("Rex");
  console.log(dog.speak()); // "Rex barks."
  ```

---

#### åŸå‹æ–¹æ³• (Prototype Methods)

##### Object.prototype.toString()

- `Object.prototype.toString()` æ˜¯æ‰€æœ‰ç‰©ä»¶ç¹¼æ‰¿çš„ä¸€å€‹æ–¹æ³•ï¼Œç”¨ä¾†è¿”å›ç‰©ä»¶çš„é¡å‹è³‡è¨Šã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  const obj = {};
  console.log(obj.toString()); // "[object Object]"
  ```

##### Object.prototype.hasOwnProperty()

- `Object.prototype.hasOwnProperty()` ç”¨ä¾†æª¢æŸ¥æŸå€‹å±¬æ€§æ˜¯å¦å­˜åœ¨æ–¼ç‰©ä»¶æœ¬èº«ï¼ˆè€ŒéåŸå‹éˆä¸­ï¼‰ã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  const obj = { name: "Alice" };
  console.log(obj.hasOwnProperty("name")); // true
  console.log(obj.hasOwnProperty("toString")); // falseï¼ˆtoString æ˜¯å¾åŸå‹ç¹¼æ‰¿çš„ï¼‰
  ```

---

#### åŸå‹çš„æ³¨æ„äº‹é …

**ä¿®æ”¹åŸå‹**ï¼š

- ä¿®æ”¹ç‰©ä»¶çš„åŸå‹å¯èƒ½æœƒå½±éŸ¿æ‰€æœ‰å¾è©²åŸå‹ç¹¼æ‰¿çš„ç‰©ä»¶ï¼Œå› æ­¤è¦è¬¹æ…æ“ä½œã€‚
- ç¯„ä¾‹ï¼š

  ```javascript
  const obj = {};
  Object.prototype.newMethod = function () {
    return "New Method";
  };
  console.log(obj.newMethod()); // "New Method"
  ```

**é¿å…éåº¦ä¾è³´åŸå‹éˆ**ï¼š

- åŸå‹éˆçš„å±¤ç´šéå¤šå¯èƒ½å°è‡´æ€§èƒ½å•é¡Œï¼Œå°¤å…¶æ˜¯åœ¨æŸ¥æ‰¾å±¬æ€§æ™‚ã€‚

---

#### Prototype ç¸½çµ

- åŸå‹(Prototype)æ˜¯ JavaScript ç¹¼æ‰¿çš„åŸºç¤ã€‚ç‰©ä»¶é€éåŸå‹éˆ(Prototype Chain)å…±äº«å±¬æ€§å’Œæ–¹æ³•ã€‚
- ES6 å¼•å…¥ `class` èªæ³•ï¼Œç°¡åŒ–äº†åŸå‹å’Œç¹¼æ‰¿çš„æ“ä½œã€‚
- ç†Ÿç·´æŒæ¡åŸå‹å’Œç¹¼æ‰¿æ¦‚å¿µï¼Œèƒ½å¹«åŠ©ä½ æ›´é«˜æ•ˆåœ°è¨­è¨ˆ JavaScript ç¨‹å¼ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 8. Closure é–‰åŒ…

#### ä»€éº¼æ˜¯é–‰åŒ…ï¼Ÿ

é–‰åŒ…ï¼ˆClosureï¼‰æ˜¯ JavaScript ä¸­çš„ä¸€å€‹é‡è¦æ¦‚å¿µã€‚é–‰åŒ…æŒ‡çš„æ˜¯**ç•¶ä¸€å€‹å‡½å¼èƒ½å¤ è¨˜ä½ä¸¦å­˜å–å®ƒåœ¨å®šç¾©æ™‚çš„ä½œç”¨åŸŸï¼ˆScopeï¼‰æ™‚ï¼Œå³ä½¿é€™å€‹å‡½å¼åœ¨å…¶å®šç¾©ä½œç”¨åŸŸä¹‹å¤–è¢«åŸ·è¡Œ**ï¼Œå®ƒä»ç„¶èƒ½å¤ å­˜å–è©²ä½œç”¨åŸŸå…§çš„è®Šæ•¸ã€‚

---

#### é–‰åŒ…çš„ç‰¹æ€§

1. **å‡½å¼å…§éƒ¨çš„å‡½å¼**  
   é–‰åŒ…é€šå¸¸æ˜¯åœ¨å‡½å¼å…§éƒ¨å®šç¾©å¦ä¸€å€‹å‡½å¼ï¼Œå…§å±¤å‡½å¼å¯ä»¥å­˜å–å¤–å±¤å‡½å¼çš„è®Šæ•¸ï¼Œå³ä½¿å¤–å±¤å‡½å¼å·²ç¶“åŸ·è¡Œå®Œç•¢ã€‚

2. **è¨˜ä½ä½œç”¨åŸŸ**  
   é–‰åŒ…æœƒè¨˜ä½å‡½å¼åœ¨å®šç¾©æ™‚çš„ä½œç”¨åŸŸï¼Œè€Œä¸æ˜¯å‡½å¼åœ¨åŸ·è¡Œæ™‚çš„ä½œç”¨åŸŸã€‚

3. **ç§æœ‰è®Šæ•¸**  
   é–‰åŒ…å¯ä»¥ç”¨ä¾†æ¨¡æ“¬ã€Œç§æœ‰è®Šæ•¸ã€ï¼Œå› ç‚ºé–‰åŒ…å…§çš„è®Šæ•¸ç„¡æ³•å¾å¤–éƒ¨ç›´æ¥å­˜å–ã€‚

---

#### ä½¿ç”¨é–‰åŒ…çš„ç¯„ä¾‹

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è¦‹çš„é–‰åŒ…ä½¿ç”¨å ´æ™¯ï¼š

##### ç¯„ä¾‹ 1: åŸºæœ¬é–‰åŒ…

```javascript
function outerFunction(outerVariable) {
  return function innerFunction(innerVariable) {
    console.log(`Outer Variable: ${outerVariable}`);
    console.log(`Inner Variable: ${innerVariable}`);
  };
}

const newFunction = outerFunction("å¤–å±¤è®Šæ•¸");
newFunction("å…§å±¤è®Šæ•¸");
// Output:
// Outer Variable: å¤–å±¤è®Šæ•¸
// Inner Variable: å…§å±¤è®Šæ•¸
```

---

##### ç¯„ä¾‹ 2: æ¨¡æ“¬ç§æœ‰è®Šæ•¸

é–‰åŒ…å¯ä»¥ç”¨ä¾†æ¨¡æ“¬ç§æœ‰è®Šæ•¸ï¼Œè®“å¤–éƒ¨ç„¡æ³•ç›´æ¥å­˜å–å…§éƒ¨çš„æ•¸æ“šã€‚

```javascript
function createCounter() {
  let count = 0; // ç§æœ‰è®Šæ•¸
  return {
    increment: function () {
      count++;
      console.log(count);
    },
    decrement: function () {
      count--;
      console.log(count);
    },
    getCount: function () {
      return count;
    },
  };
}

const counter = createCounter();
counter.increment(); // 1
counter.increment(); // 2
counter.decrement(); // 1
console.log(counter.getCount()); // 1
```

---

##### ç¯„ä¾‹ 3: æ¯å€‹é–‰åŒ…æ“æœ‰è‡ªå·±çš„ä½œç”¨åŸŸ

æ¯æ¬¡åŸ·è¡Œå¤–å±¤å‡½å¼æ™‚ï¼Œé–‰åŒ…éƒ½æœƒæ“æœ‰ä¸€å€‹æ–°çš„ä½œç”¨åŸŸã€‚

```javascript
function createAdder(x) {
  return function (y) {
    return x + y;
  };
}

const add5 = createAdder(5);
const add10 = createAdder(10);

console.log(add5(2)); // 7
console.log(add10(2)); // 12
```

---

##### ç¯„ä¾‹ 4: é–‰åŒ…ä¸­çš„è¿´åœˆå•é¡Œ

åœ¨ä½¿ç”¨ `var` å®£å‘Šè®Šæ•¸æ™‚ï¼Œå¯èƒ½æœƒé‡åˆ°é–‰åŒ…èˆ‡è¿´åœˆçš„ä½œç”¨åŸŸå•é¡Œã€‚

```javascript
// éŒ¯èª¤ç¯„ä¾‹
function badExample() {
  var functions = [];
  for (var i = 0; i < 3; i++) {
    functions.push(function () {
      console.log(i);
    });
  }
  return functions;
}

const funcs = badExample();
funcs[0](); // 3
funcs[1](); // 3
funcs[2](); // 3
```

##### è§£æ³•ï¼šä½¿ç”¨ `let` æˆ–ç«‹å³åŸ·è¡Œå‡½å¼è¡¨é”å¼ï¼ˆIIFEï¼‰

```javascript
// è§£æ³• 1: ä½¿ç”¨ let
function fixedExample() {
  var functions = [];
  for (let i = 0; i < 3; i++) {
    functions.push(function () {
      console.log(i);
    });
  }
  return functions;
}

const fixedFuncs = fixedExample();
fixedFuncs[0](); // 0
fixedFuncs[1](); // 1
fixedFuncs[2](); // 2

// è§£æ³• 2: ä½¿ç”¨ IIFE
function fixedExampleWithIIFE() {
  var functions = [];
  for (var i = 0; i < 3; i++) {
    (function (j) {
      functions.push(function () {
        console.log(j);
      });
    })(i);
  }
  return functions;
}

const iifeFuncs = fixedExampleWithIIFE();
iifeFuncs[0](); // 0
iifeFuncs[1](); // 1
iifeFuncs[2](); // 2
```

---

#### é–‰åŒ…çš„æ‡‰ç”¨å ´æ™¯

1. **è³‡æ–™å°è£èˆ‡æ¨¡æ“¬ç§æœ‰è®Šæ•¸**  
   é–‰åŒ…å¯ä»¥éš±è—å…§éƒ¨çš„è®Šæ•¸ï¼Œè®“å¤–éƒ¨ç„¡æ³•ç›´æ¥ä¿®æ”¹ï¼Œé¡ä¼¼æ–¼ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆä¸­çš„ã€Œå°è£ã€ã€‚

2. **äº‹ä»¶è™•ç†èˆ‡å›å‘¼å‡½å¼**  
   åœ¨äº‹ä»¶ç›£è½æˆ–å›å‘¼å‡½å¼ä¸­ï¼Œé–‰åŒ…å¯ä»¥å¹«åŠ©è¨˜ä½æŸäº›ç‰¹å®šçš„ä¸Šä¸‹æ–‡è³‡è¨Šã€‚

3. **å‡½å¼å·¥å» ï¼ˆFunction Factoryï¼‰**  
   ä½¿ç”¨é–‰åŒ…å¯ä»¥å‹•æ…‹ç”Ÿæˆå…·æœ‰ä¸åŒè¡Œç‚ºçš„å‡½å¼ï¼Œä¾‹å¦‚ç¯„ä¾‹ 3 çš„ `createAdder`ã€‚

4. **æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰**  
   æŸ¯é‡ŒåŒ–æ˜¯ä¸€ç¨®å°‡å¤šåƒæ•¸å‡½å¼è½‰æ›ç‚ºä¸€ç³»åˆ—å–®åƒæ•¸å‡½å¼çš„æŠ€è¡“ï¼Œé–‰åŒ…åœ¨å…¶ä¸­æ‰®æ¼”é—œéµè§’è‰²ã€‚

---

#### æ³¨æ„äº‹é …èˆ‡æœ€ä½³å¯¦è¸

1. **è¨˜æ†¶é«”æ´©æ¼ï¼ˆMemory Leakï¼‰**  
   é–‰åŒ…å¯èƒ½æœƒå°è‡´è¨˜æ†¶é«”æ´©æ¼ï¼Œå› ç‚ºé–‰åŒ…æœƒæŒçºŒå¼•ç”¨å¤–å±¤å‡½å¼çš„ä½œç”¨åŸŸï¼Œå³ä½¿å¤–å±¤å‡½å¼å·²ç¶“åŸ·è¡Œå®Œç•¢ã€‚é¿å…ä¸å¿…è¦çš„é–‰åŒ…ï¼Œä¸¦é©æ™‚é‡‹æ”¾ä¸å†éœ€è¦çš„å¼•ç”¨ã€‚

2. **éåº¦ä½¿ç”¨é–‰åŒ…**  
   é›–ç„¶é–‰åŒ…åŠŸèƒ½å¼·å¤§ï¼Œä½†éåº¦ä½¿ç”¨å¯èƒ½æœƒé™ä½ç¨‹å¼ç¢¼çš„å¯è®€æ€§èˆ‡ç¶­è­·æ€§ã€‚è¦æ ¹æ“šå¯¦éš›éœ€æ±‚æ±ºå®šæ˜¯å¦ä½¿ç”¨é–‰åŒ…ã€‚

---

#### å°çµ

- é–‰åŒ…æ˜¯ JavaScript ä¸­å¼·å¤§çš„å·¥å…·ï¼Œèƒ½è®“å‡½å¼è¨˜ä½å…¶å®šç¾©æ™‚çš„ä½œç”¨åŸŸã€‚
- é–‰åŒ…å¸¸ç”¨æ–¼å¯¦ç¾ç§æœ‰è®Šæ•¸ã€äº‹ä»¶è™•ç†ä»¥åŠå‡½å¼å·¥å» ç­‰å ´æ™¯ã€‚
- åœ¨ä½¿ç”¨é–‰åŒ…æ™‚ï¼Œéœ€æ³¨æ„è¨˜æ†¶é«”ç®¡ç†èˆ‡å¯è®€æ€§å•é¡Œã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 9. Error Handling éŒ¯èª¤è™•ç†

åœ¨ JavaScript ä¸­ï¼ŒéŒ¯èª¤è™•ç†ï¼ˆError Handlingï¼‰æ˜¯ç·¨å¯«å¯é å’Œç©©å®šç¨‹å¼ç¢¼çš„é‡è¦éƒ¨åˆ†ã€‚é€éæ­£ç¢ºçš„éŒ¯èª¤è™•ç†ï¼Œæˆ‘å€‘å¯ä»¥æ•æ‰å’Œè™•ç†ç¨‹å¼åŸ·è¡Œæ™‚ç™¼ç”Ÿçš„ç•°å¸¸ï¼ˆExceptionï¼‰ï¼Œå¾è€Œé¿å…ç¨‹å¼å´©æ½°ã€‚

#### 9.1 éŒ¯èª¤é¡å‹

1. **Syntax Error èªæ³•éŒ¯èª¤**  
   ç™¼ç”Ÿåœ¨è§£æç¨‹å¼ç¢¼æ™‚ï¼Œä¾‹å¦‚ç¼ºå°‘æ‹¬è™Ÿæˆ–åˆ†è™Ÿã€‚

2. **Reference Error åƒè€ƒéŒ¯èª¤**  
   ç•¶ä½ å˜—è©¦å¼•ç”¨ä¸€å€‹ä¸å­˜åœ¨çš„è®Šæ•¸æ™‚æœƒç™¼ç”Ÿã€‚

3. **Type Error é¡å‹éŒ¯èª¤**  
   ç•¶ä¸€å€‹æ“ä½œæˆ–å‡½æ•¸è¢«æ‡‰ç”¨åˆ°ä¸€å€‹ä¸é©ç•¶çš„é¡å‹æ™‚ç™¼ç”Ÿã€‚

4. **Range Error ç¯„åœéŒ¯èª¤**  
   ç•¶ä¸€å€‹æ•¸å€¼ä¸åœ¨å…è¨±çš„ç¯„åœå…§æ™‚ç™¼ç”Ÿï¼Œä¾‹å¦‚èª¿ç”¨æ•¸å­—æ–¹æ³•æ™‚çš„ç¯„åœéŒ¯èª¤ã€‚

5. **Eval Error è©•ä¼°éŒ¯èª¤**  
   èˆ‡ `eval()` å‡½æ•¸æœ‰é—œçš„éŒ¯èª¤ï¼Œä¸å¸¸è¦‹ã€‚

#### 9.2 éŒ¯èª¤è™•ç†æ©Ÿåˆ¶

JavaScript æä¾›äº†`try...catch`èªå¥ä¾†è™•ç†éŒ¯èª¤ã€‚

```javascript
try {
  // å˜—è©¦åŸ·è¡Œçš„ä»£ç¢¼
} catch (error) {
  // å¦‚æœç™¼ç”ŸéŒ¯èª¤ï¼ŒåŸ·è¡Œé€™è£¡çš„ä»£ç¢¼
} finally {
  // ç„¡è«–æ˜¯å¦ç™¼ç”ŸéŒ¯èª¤ï¼Œéƒ½æœƒåŸ·è¡Œ
}
```

- **try**: åŒ…å«å¯èƒ½æœƒæ‹‹å‡ºéŒ¯èª¤çš„ä»£ç¢¼ã€‚
- **catch**: ç•¶éŒ¯èª¤ç™¼ç”Ÿæ™‚ï¼ŒåŸ·è¡Œæ­¤å€å¡Šã€‚`error`æ˜¯éŒ¯èª¤å°è±¡ï¼ŒåŒ…å«éŒ¯èª¤ä¿¡æ¯ã€‚
- **finally**: ç„¡è«–æ˜¯å¦ç™¼ç”ŸéŒ¯èª¤ï¼Œæœ€çµ‚éƒ½æœƒåŸ·è¡Œæ­¤å€å¡Šï¼ˆå¯é¸ï¼‰ã€‚

#### 9.3 éŒ¯èª¤æ‹‹å‡º (Throwing Errors)

ä½¿ç”¨`throw`èªå¥æ‰‹å‹•æ‹‹å‡ºéŒ¯èª¤ï¼Œé€™å¯ä»¥ç”¨ä¾†å‰µå»ºè‡ªå®šç¾©éŒ¯èª¤ã€‚

```javascript
function divide(a, b) {
  if (b === 0) {
    throw new Error("Division by zero");
  }
  return a / b;
}
```

#### 9.4 è‡ªå®šç¾©éŒ¯èª¤é¡å‹

å¯ä»¥é€šéæ“´å±•`Error`é¡ä¾†å‰µå»ºè‡ªå®šç¾©éŒ¯èª¤é¡å‹ã€‚

```javascript
class CustomError extends Error {
  constructor(message) {
    super(message);
    this.name = "CustomError";
  }
}

try {
  throw new CustomError("This is a custom error");
} catch (error) {
  console.error(error.name + ": " + error.message);
}
```

#### 9.5 å¸¸è¦‹éŒ¯èª¤è™•ç†ç­–ç•¥

1. **Graceful Degradation å„ªé›…é™ç´š**  
   åœ¨éŒ¯èª¤ç™¼ç”Ÿæ™‚ï¼Œä¿è­‰ç³»çµ±æˆ–æ‡‰ç”¨èƒ½å¤ ç¹¼çºŒé‹è¡Œï¼Œæˆ–æä¾›æ›¿ä»£åŠŸèƒ½ã€‚

2. **Fail Fast å¿«é€Ÿå¤±æ•—**  
   åœ¨éŒ¯èª¤ç™¼ç”Ÿæ™‚ï¼Œç«‹å³åœæ­¢ç¨‹åºçš„åŸ·è¡Œï¼Œä»¥é˜²æ­¢ç³»çµ±é€²ä¸€æ­¥æå£ã€‚

3. **Logging éŒ¯èª¤è¨˜éŒ„**  
   å°‡éŒ¯èª¤è©³ç´°ä¿¡æ¯è¨˜éŒ„ä¸‹ä¾†ï¼Œä»¥ä¾¿å°‡ä¾†é€²è¡Œèª¿è©¦å’Œåˆ†æã€‚

#### 9.6 éŒ¯èª¤è™•ç†æœ€ä½³å¯¦è¸

- å„˜é‡ä½¿ç”¨`try...catch`ä¾†æ•ç²å¯èƒ½æ‹‹å‡ºéŒ¯èª¤çš„æ“ä½œã€‚
- ä½¿ç”¨`finally`ä¾†æ¸…ç†è³‡æºï¼Œä¾‹å¦‚é—œé–‰æ–‡ä»¶æˆ–é‡‹æ”¾å…§å­˜ã€‚
- åœ¨é©ç•¶çš„æƒ…æ³ä¸‹ä½¿ç”¨è‡ªå®šç¾©éŒ¯èª¤é¡å‹ï¼Œä»¥æä¾›æ›´å¤šä¸Šä¸‹æ–‡ã€‚
- ç¢ºä¿åœ¨éŒ¯èª¤ç™¼ç”Ÿæ™‚ï¼Œå¿…è¦çš„éŒ¯èª¤ä¿¡æ¯è¢«è¨˜éŒ„ä»¥ä¾¿è¨ºæ–·ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 10. Call Stack å‘¼å«å †ç–Š

#### ä»€éº¼æ˜¯ Call Stackï¼Ÿ

åœ¨ JavaScript ä¸­ï¼Œ**Call Stackï¼ˆå‘¼å«å †ç–Šï¼‰** æ˜¯ä¸€ç¨®è³‡æ–™çµæ§‹ï¼Œç”¨ä¾†è¨˜éŒ„ç¨‹å¼åŸ·è¡Œæ™‚å‡½å¼å‘¼å«çš„é †åºã€‚å®ƒæ˜¯ä¸€å€‹ **LIFOï¼ˆLast In, First Outï¼Œå¾Œé€²å…ˆå‡ºï¼‰** çš„çµæ§‹ï¼Œæœ€æ–°çš„å‡½å¼å‘¼å«æœƒè¢«æ”¾åœ¨å †ç–Šçš„é ‚ç«¯ï¼ŒåŸ·è¡Œå®Œæˆå¾Œå†ç§»é™¤ã€‚

#### Call Stack çš„å·¥ä½œæµç¨‹

1. ç•¶ä¸€å€‹å‡½å¼è¢«å‘¼å«æ™‚ï¼Œæœƒè¢«åŠ å…¥åˆ° **Call Stack** çš„é ‚ç«¯ã€‚
2. å‡½å¼åŸ·è¡Œå®Œæˆå¾Œæœƒå¾ **Call Stack** ä¸­ç§»é™¤ã€‚
3. JavaScript ä»¥åŒæ­¥æ–¹å¼ï¼ˆsynchronous executionï¼‰é€ä¸€åŸ·è¡Œ **Call Stack** ä¸­çš„å‡½å¼ã€‚

---

#### ä¾‹å­ï¼šCall Stack çš„åŸºæœ¬é‹ä½œ

ä»¥ä¸‹æ˜¯ä¸€å€‹ç°¡å–®ç¯„ä¾‹ï¼Œå±•ç¤º **Call Stack** çš„å·¥ä½œæµç¨‹ï¼š

```javascript
function foo() {
  console.log("åŸ·è¡Œ foo");
  bar(); // å‘¼å« bar å‡½å¼
}

function bar() {
  console.log("åŸ·è¡Œ bar");
}

foo(); // å‘¼å« foo å‡½å¼
```

##### Call Stack æ“ä½œæ­¥é©Ÿ

1. `foo()` è¢«å‘¼å«ï¼ŒåŠ å…¥ Call Stackã€‚
2. `foo` é–‹å§‹åŸ·è¡Œï¼Œä¸¦åœ¨å…§éƒ¨å‘¼å«äº† `bar()`ï¼Œå°‡ `bar()` åŠ å…¥ Call Stackã€‚
3. `bar()` åŸ·è¡Œå®Œæˆå¾Œï¼Œå¾ Call Stack ç§»é™¤ã€‚
4. `foo()` åŸ·è¡Œå®Œæˆå¾Œï¼Œå¾ Call Stack ç§»é™¤ã€‚

åŸ·è¡Œé †åºå¦‚ä¸‹ï¼š

```bash
Call Stack:
1. foo()
2. bar() (åŠ å…¥)
3. bar() (ç§»é™¤)
4. foo() (ç§»é™¤)
```

---

#### JavaScript ç‚ºä½•ä½¿ç”¨ Call Stackï¼Ÿ

JavaScript æ˜¯å–®åŸ·è¡Œç·’ï¼ˆsingle-threadedï¼‰çš„ç¨‹å¼èªè¨€ï¼Œä¸èƒ½åŒæ™‚åŸ·è¡Œå¤šå€‹ç¨‹å¼ç¢¼ç‰‡æ®µã€‚å› æ­¤ï¼Œ**Call Stack** ç”¨ä¾†ç®¡ç†ç¨‹å¼ç¢¼çš„åŸ·è¡Œé †åºï¼Œç¢ºä¿æ¯ä¸€å€‹å‡½å¼ä¾åºåŸ·è¡Œã€‚é€™æ˜¯ JavaScript éåŒæ­¥è¡Œç‚ºï¼ˆå¦‚äº‹ä»¶ç›£è½å’Œ Promiseï¼‰èƒŒå¾Œçš„åŸºç¤ã€‚

---

#### å †ç–Šæº¢å‡ºï¼ˆStack Overflowï¼‰

å¦‚æœå‡½å¼å‘¼å«éå¤šä¸”æœªæ­£ç¢ºå®Œæˆï¼Œ**Call Stack** å¯èƒ½æœƒæº¢å‡ºï¼ˆStack Overflowï¼‰ï¼Œå°è‡´ç¨‹å¼å´©æ½°ã€‚

##### ç¯„ä¾‹ï¼šç„¡çª®éè¿´ï¼ˆInfinite Recursionï¼‰

```javascript
function recursive() {
  recursive(); // ç„¡çª®éè¿´ï¼Œæ°¸é ä¸æœƒåœæ­¢
}

recursive(); // å‘¼å« recursive å‡½å¼
```

åŸ·è¡Œä¸Šè¿°ç¨‹å¼ç¢¼æ™‚ï¼Œ`recursive()` ä¸æ–·å‘¼å«è‡ªå·±ï¼Œé€ æˆ **Call Stack** ç„¡æ³•æ¸…ç©ºï¼Œæœ€å¾Œå°è‡´å †ç–Šæº¢å‡ºã€‚

---

#### éåŒæ­¥è¡Œç‚ºèˆ‡ Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰

é›–ç„¶ JavaScript æ˜¯åŒæ­¥çš„ï¼Œä½†å®ƒé€é **Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰** å’Œ **Callback Queueï¼ˆå›å‘¼ä½‡åˆ—ï¼‰** ä¾†è™•ç†éåŒæ­¥è¡Œç‚ºã€‚éåŒæ­¥æ“ä½œï¼ˆå¦‚ `setTimeout` æˆ– `Promise`ï¼‰ä¸æœƒç›´æ¥åŠ å…¥ **Call Stack**ï¼Œè€Œæ˜¯è¢«æ’åˆ° **Callback Queue**ï¼Œç­‰åˆ° **Call Stack** æ¸…ç©ºå¾Œæ‰åŸ·è¡Œã€‚

##### ç¯„ä¾‹ï¼šéåŒæ­¥æ“ä½œçš„ Call Stack æµç¨‹

```javascript
console.log("1");

setTimeout(() => {
  console.log("2");
}, 1000);

console.log("3");
```

åŸ·è¡Œé †åºï¼š

1. `console.log("1")` åŠ å…¥ Call Stackï¼ŒåŸ·è¡Œå¾Œç§»é™¤ã€‚
2. `setTimeout` åŠ å…¥ Call Stackï¼Œå®šæ™‚å™¨å•Ÿå‹•ï¼Œå›å‘¼å‡½å¼åŠ å…¥ **Callback Queue**ï¼Œ`setTimeout` å¾ Call Stack ç§»é™¤ã€‚
3. `console.log("3")` åŠ å…¥ Call Stackï¼ŒåŸ·è¡Œå¾Œç§»é™¤ã€‚
4. ç•¶ **Call Stack** æ¸…ç©ºå¾Œï¼Œäº‹ä»¶å¾ªç’°æª¢æŸ¥ **Callback Queue**ï¼Œå°‡å›å‘¼å‡½å¼åŠ å…¥ **Call Stack**ï¼ŒåŸ·è¡Œ `console.log("2")`ã€‚

åŸ·è¡Œçµæœï¼š

```bash
1
3
2
```

---

#### Call Stack ç¸½çµ

- **Call Stackï¼ˆå‘¼å«å †ç–Šï¼‰** æ˜¯ JavaScript çš„æ ¸å¿ƒæ©Ÿåˆ¶ï¼Œç”¨ä¾†ç®¡ç†å‡½å¼å‘¼å«çš„åŸ·è¡Œé †åºã€‚
- å®ƒæ˜¯åŒæ­¥çš„ï¼Œæ¡ç”¨ **LIFOï¼ˆå¾Œé€²å…ˆå‡ºï¼‰** åŸå‰‡ã€‚
- éå¤šçš„å‡½å¼å‘¼å«å¯èƒ½å°è‡´ **Stack Overflowï¼ˆå †ç–Šæº¢å‡ºï¼‰**ã€‚
- éåŒæ­¥è¡Œç‚ºé€é **Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰** å’Œ **Callback Queueï¼ˆå›å‘¼ä½‡åˆ—ï¼‰** ä¾†é€²è¡Œç®¡ç†ã€‚

äº†è§£ **Call Stack** æ˜¯ç†è§£ JavaScript åŸ·è¡Œæ¨¡å‹çš„åŸºç¤ï¼Œå°¤å…¶åœ¨è™•ç†éåŒæ­¥ç¨‹å¼ç¢¼æ™‚éå¸¸é‡è¦ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 11. Memory Management è¨˜æ†¶é«”ç®¡ç†

åœ¨ JavaScript ä¸­ï¼Œè¨˜æ†¶é«”ç®¡ç†ä¸»è¦æ˜¯æŒ‡å¦‚ä½•åˆ†é…è¨˜æ†¶é«”ä»¥åŠå¦‚ä½•é‡‹æ”¾ä¸å†ä½¿ç”¨çš„è¨˜æ†¶é«”ã€‚ä»¥ä¸‹æ˜¯ç›¸é—œçš„é‡é»æ•´ç†ï¼š

---

#### **è¨˜æ†¶é«”ç®¡ç†çš„åŸºæœ¬æ¦‚å¿µ**

1. **è¨˜æ†¶é«”åˆ†é… (Memory Allocation)**

   - ç•¶æˆ‘å€‘å®£å‘Šè®Šæ•¸ã€å»ºç«‹ç‰©ä»¶æˆ–å‡½å¼æ™‚ï¼ŒJavaScript æœƒè‡ªå‹•åˆ†é…è¨˜æ†¶é«”ã€‚
   - ç¯„ä¾‹ï¼š

     ```javascript
     let num = 42; // ç‚ºæ•¸å­—åˆ†é…è¨˜æ†¶é«”
     let obj = { name: "Alice" }; // ç‚ºç‰©ä»¶åˆ†é…è¨˜æ†¶é«”
     ```

2. **è¨˜æ†¶é«”ä½¿ç”¨ (Memory Usage)**

   - JavaScript çš„åŸ·è¡Œç’°å¢ƒï¼ˆä¾‹å¦‚ç€è¦½å™¨ä¸­çš„ V8 å¼•æ“ï¼‰æœƒç®¡ç†è¨˜æ†¶é«”ï¼ŒåŒ…æ‹¬åˆ†é…åŠè¿½è¹¤ä½¿ç”¨ç‹€æ…‹ã€‚

3. **è¨˜æ†¶é«”é‡‹æ”¾ (Memory Release)**
   - ç•¶æŸäº›è¨˜æ†¶é«”ä¸å†è¢«ä½¿ç”¨æ™‚ï¼ŒJavaScript æœƒå˜—è©¦é‡‹æ”¾é€™äº›è¨˜æ†¶é«”ã€‚é€™é€šå¸¸ç”±åƒåœ¾å›æ”¶æ©Ÿåˆ¶ï¼ˆGarbage Collectionï¼‰å®Œæˆã€‚

---

#### **åƒåœ¾å›æ”¶ (Garbage Collection)**

1. **ä»€éº¼æ˜¯åƒåœ¾å›æ”¶ (Garbage Collection)**

   - JavaScript æ˜¯ä¸€ç¨®é«˜éšèªè¨€ï¼Œå…·æœ‰è‡ªå‹•åƒåœ¾å›æ”¶æ©Ÿåˆ¶ï¼Œç„¡éœ€æ‰‹å‹•ç®¡ç†è¨˜æ†¶é«”ã€‚
   - åƒåœ¾å›æ”¶çš„ä¸»è¦ç›®çš„æ˜¯é‡‹æ”¾ä¸å†ä½¿ç”¨çš„è¨˜æ†¶é«”ä»¥é¿å…è¨˜æ†¶é«”æ´©æ¼ï¼ˆMemory Leakï¼‰ã€‚

2. **æ¨™è¨˜-æ¸…é™¤æ¼”ç®—æ³• (Mark-and-Sweep Algorithm)**

   - æœ€å¸¸è¦‹çš„åƒåœ¾å›æ”¶æ–¹å¼ã€‚
   - å·¥ä½œæµç¨‹ï¼š
     1. **æ¨™è¨˜ (Mark)**ï¼šåƒåœ¾å›æ”¶å™¨æœƒæ¨™è¨˜æ‰€æœ‰å­˜æ´»ï¼ˆreachableï¼‰çš„ç‰©ä»¶ã€‚
     2. **æ¸…é™¤ (Sweep)**ï¼šæœªè¢«æ¨™è¨˜çš„ç‰©ä»¶æœƒè¢«è¦–ç‚ºä¸å†ä½¿ç”¨ï¼Œè¨˜æ†¶é«”å°‡è¢«é‡‹æ”¾ã€‚

3. **å¯é”æ€§ (Reachability)**
   - ä¸€å€‹ç‰©ä»¶æ˜¯å¦å­˜æ´»çš„åˆ¤æ–·æ¨™æº–æ˜¯ã€Œå¯é”æ€§ã€ã€‚
   - å¯é”çš„ç‰©ä»¶åŒ…æ‹¬ï¼š
     - å…¨åŸŸç‰©ä»¶ï¼ˆGlobal Objectï¼‰ï¼Œä¾‹å¦‚ `window`ã€‚
     - å‡½å¼çš„å±€éƒ¨è®Šæ•¸å’Œåƒæ•¸ã€‚
     - è¢«å…¶ä»–å­˜æ´»ç‰©ä»¶å¼•ç”¨çš„ç‰©ä»¶ã€‚

---

#### **å¸¸è¦‹çš„è¨˜æ†¶é«”å•é¡Œ**

1. **è¨˜æ†¶é«”æ´©æ¼ (Memory Leak)**

   - ç•¶ç‰©ä»¶ä¸å†éœ€è¦ä½¿ç”¨ï¼Œä½†æœªè¢«åƒåœ¾å›æ”¶å™¨é‡‹æ”¾ï¼Œå°è‡´è¨˜æ†¶é«”ä¸æ–·ç´¯ç©ã€‚
   - å¸¸è¦‹åŸå› ï¼š
     - **å…¨åŸŸè®Šæ•¸ (Global Variables)**ï¼šæœªæ­£ç¢ºæ¸…ç†çš„å…¨åŸŸè®Šæ•¸å¯èƒ½æœƒæ°¸ä¹…å­˜åœ¨ã€‚
     - **é–‰åŒ… (Closure)**ï¼šé–‰åŒ…å¯èƒ½å°è‡´æŸäº›è®Šæ•¸ç„¡æ³•è¢«åƒåœ¾å›æ”¶ã€‚
     - **æœªæ¸…ç†çš„ DOM å¼•ç”¨**ï¼šç§»é™¤ DOM å…ƒç´ æ™‚æœªæ¸…ç†ç›¸é—œäº‹ä»¶ç›£è½å™¨æˆ–å¼•ç”¨ã€‚

2. **å¦‚ä½•é¿å…è¨˜æ†¶é«”æ´©æ¼**ï¼š
   - ä½¿ç”¨ `let` æˆ– `const` å®£å‘Šå€åŸŸè®Šæ•¸ï¼Œé¿å…ä½¿ç”¨ `var`ã€‚
   - åœ¨ä¸éœ€è¦ä½¿ç”¨çš„æ™‚å€™ï¼Œä¸»å‹•è§£é™¤å°ç‰©ä»¶çš„å¼•ç”¨ã€‚
   - ç§»é™¤ä¸å†éœ€è¦çš„äº‹ä»¶ç›£è½å™¨ã€‚
   - é¿å…ä¸å¿…è¦çš„å…¨åŸŸè®Šæ•¸ã€‚

---

#### **è¨˜æ†¶é«”æœ€ä½³åŒ– (Memory Optimization)**

1. **æ¸›å°‘è¨˜æ†¶é«”ä½¿ç”¨**

   - é¿å…å»ºç«‹éå¤§çš„è³‡æ–™çµæ§‹ã€‚
   - ä½¿ç”¨æ›´é«˜æ•ˆçš„è³‡æ–™å‹åˆ¥ï¼Œä¾‹å¦‚ `Map` æˆ– `Set`ã€‚

2. **æ¸…ç†ä¸å¿…è¦çš„ç‰©ä»¶å¼•ç”¨**

   - ç¯„ä¾‹ï¼šåœ¨å‡½å¼çµæŸæ™‚ï¼Œè®“ä¸å¿…è¦çš„ç‰©ä»¶è¢«åƒåœ¾å›æ”¶ã€‚

     ```javascript
     function processData() {
       let largeData = new Array(1000000).fill("data");
       // è™•ç†è³‡æ–™
       largeData = null; // ä¸»å‹•æ¸…ç†å¼•ç”¨
     }
     ```

3. **ä½¿ç”¨å·¥å…·ç›£æ§è¨˜æ†¶é«”**
   - ä½¿ç”¨ç€è¦½å™¨é–‹ç™¼å·¥å…·ï¼ˆä¾‹å¦‚ Chrome DevToolsï¼‰ä¸­çš„ã€Œè¨˜æ†¶é«”åˆ†æã€åŠŸèƒ½ä¾†æª¢æŸ¥è¨˜æ†¶é«”ä½¿ç”¨æƒ…æ³ã€‚

---

#### **ç¤ºä¾‹ï¼šè¿½è¹¤è¨˜æ†¶é«”æ´©æ¼**

ä»¥ä¸‹æ˜¯ä¸€å€‹å¯èƒ½å°è‡´è¨˜æ†¶é«”æ´©æ¼çš„ç¯„ä¾‹ï¼Œä»¥åŠå¦‚ä½•ä¿®å¾©ï¼š

```javascript
// è¨˜æ†¶é«”æ´©æ¼ç¯„ä¾‹
let element = document.getElementById("button");
element.addEventListener("click", () => {
  console.log("Button clicked!");
});
// å¦‚æœ element è¢«ç§»é™¤ï¼Œä½†äº‹ä»¶ç›£è½å™¨æœªæ¸…ç†ï¼Œæœƒå°è‡´æ´©æ¼

// ä¿®å¾©æ–¹å¼
element.removeEventListener("click", handler);
element = null; // ç§»é™¤å¼•ç”¨ï¼Œå…è¨±åƒåœ¾å›æ”¶
```

---

#### **çµè«–**

è¨˜æ†¶é«”ç®¡ç†åœ¨ JavaScript ä¸­é›–ç„¶ç”±åŸ·è¡Œç’°å¢ƒè‡ªå‹•è™•ç†ï¼Œä½†äº†è§£å…¶å·¥ä½œåŸç†ä»¥åŠæ½›åœ¨å•é¡Œï¼Œå¯ä»¥å¹«åŠ©æˆ‘å€‘æ’°å¯«æ›´é«˜æ•ˆã€ç©©å®šçš„ç¨‹å¼ã€‚é¿å…è¨˜æ†¶é«”æ´©æ¼ä¸¦é€²è¡Œé©ç•¶çš„æœ€ä½³åŒ–ï¼Œèƒ½æå‡æ‡‰ç”¨ç¨‹å¼çš„æ•ˆèƒ½ä¸¦æ¸›å°‘ä¸å¿…è¦çš„è³‡æºæ¶ˆè€—ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 12. Garbage Collection åƒåœ¾å›æ”¶æ©Ÿåˆ¶

JavaScript çš„åƒåœ¾å›æ”¶æ©Ÿåˆ¶ (Garbage Collection, GC) æ˜¯ä¸€å€‹è‡ªå‹•åŒ–çš„è¨˜æ†¶é«”ç®¡ç†éç¨‹ï¼Œè² è²¬å›æ”¶ä¸å†ä½¿ç”¨çš„è¨˜æ†¶é«”è³‡æºï¼Œé¿å…è¨˜æ†¶é«”æ´©æ¼ (Memory Leak)ã€‚ä»¥ä¸‹æ˜¯ Garbage Collection çš„é‹ä½œæ–¹å¼èˆ‡ç›¸é—œæ¦‚å¿µæ•´ç†ï¼š

---

#### 1. åƒåœ¾å›æ”¶çš„åŸºæœ¬åŸç†

JavaScript ä½¿ç”¨ã€Œå¯é”æ€§ã€(Reachability) ä½œç‚ºåˆ¤æ–·ç‰©ä»¶æ˜¯å¦æ‡‰è¢«å›æ”¶çš„ä¾æ“šï¼š

- **å¯é”æ€§ (Reachability)**ï¼šæŒ‡å¾æ ¹ (Root) å‡ºç™¼èƒ½å¤ è¨ªå•åˆ°çš„å€¼ã€‚
  - æ ¹ (Root)ï¼šåœ¨ JavaScript ä¸­ï¼Œæ ¹é€šå¸¸æŒ‡çš„æ˜¯å…¨åŸŸç‰©ä»¶ (Global Objectï¼Œä¾‹å¦‚ `window`)ã€ç•¶å‰åŸ·è¡Œçš„åŸ·è¡Œç·’ (Execution Context) çš„è®Šæ•¸ï¼Œä»¥åŠå‡½å¼çš„åŸ·è¡Œå †ç–Š (Call Stack)ã€‚
  - è‹¥æŸç‰©ä»¶ç„¡æ³•å¾æ ¹è¨ªå•ï¼Œå‰‡è¢«èªç‚ºæ˜¯ä¸å¯é”çš„ï¼Œæœƒè¢«è¦–ç‚ºåƒåœ¾ã€‚

---

#### 2. å¸¸è¦‹çš„åƒåœ¾å›æ”¶æ¼”ç®—æ³•

JavaScript çš„åƒåœ¾å›æ”¶æ©Ÿåˆ¶æ˜¯ç”± JavaScript å¼•æ“ (ä¾‹å¦‚ V8) å¯¦ç¾çš„ã€‚ä»¥ä¸‹æ˜¯å…©ç¨®å¸¸è¦‹çš„åƒåœ¾å›æ”¶æ¼”ç®—æ³•ï¼š

1. **æ¨™è¨˜-æ¸…é™¤ (Mark-and-Sweep)**ï¼š

   - é€™æ˜¯æœ€å¸¸ç”¨çš„åƒåœ¾å›æ”¶æ¼”ç®—æ³•ã€‚
   - é‹ä½œæµç¨‹ï¼š
     1. åƒåœ¾å›æ”¶å™¨å¾æ ¹é–‹å§‹ï¼Œæ¨™è¨˜æ‰€æœ‰å¯é”çš„ç‰©ä»¶ã€‚
     2. æ¸…é™¤é‚£äº›æœªè¢«æ¨™è¨˜çš„ç‰©ä»¶ï¼Œé‡‹æ”¾å…¶ä½”ç”¨çš„è¨˜æ†¶é«”ã€‚
   - ç‰¹é»ï¼š
     - ç°¡å–®ä¸”é«˜æ•ˆã€‚
     - ä¸æœƒæ•´ç†è¨˜æ†¶é«”ç¢ç‰‡ (Memory Fragmentation)ã€‚

2. **åˆ†ä»£å›æ”¶ (Generational Garbage Collection)**ï¼š
   - å°‡è¨˜æ†¶é«”åˆ†ç‚ºã€Œæ–°ç”Ÿä»£ã€(Young Generation) å’Œã€Œè€ç”Ÿä»£ã€(Old Generation)ã€‚
     - **æ–°ç”Ÿä»£ (Young Generation)**ï¼šå­˜æ”¾çŸ­æ™‚é–“å…§ä½¿ç”¨çš„ç‰©ä»¶ï¼Œé€šå¸¸æ˜¯å‰›å‰µå»ºçš„ç‰©ä»¶ã€‚
     - **è€ç”Ÿä»£ (Old Generation)**ï¼šå­˜æ”¾å­˜åœ¨æ™‚é–“è¼ƒé•·çš„ç‰©ä»¶ã€‚
   - é‹ä½œæµç¨‹ï¼š
     1. åƒåœ¾å›æ”¶å™¨æœƒé »ç¹åœ°æƒææ–°ç”Ÿä»£ï¼Œå¿«é€Ÿå›æ”¶çŸ­å‘½çš„ç‰©ä»¶ã€‚
     2. å¦‚æœç‰©ä»¶åœ¨æ–°ç”Ÿä»£ä¸­å­˜æ´»è¶³å¤ ä¹…ï¼Œæœƒè¢«ç§»å‹•åˆ°è€ç”Ÿä»£ã€‚
   - ç‰¹é»ï¼š
     - æé«˜åƒåœ¾å›æ”¶æ•ˆç‡ï¼Œå› ç‚ºå¤§å¤šæ•¸ç‰©ä»¶æ˜¯çŸ­å‘½çš„ã€‚

---

#### 3. è¨˜æ†¶é«”ç®¡ç†çš„æ³¨æ„äº‹é …

1. **é¿å…è¨˜æ†¶é«”æ´©æ¼ (Memory Leak)**ï¼š

   - è¨˜æ†¶é«”æ´©æ¼æ˜¯æŒ‡ä¸å†éœ€è¦çš„è¨˜æ†¶é«”æ²’æœ‰è¢«é‡‹æ”¾ï¼Œå°è‡´è¨˜æ†¶é«”ä½¿ç”¨é‡æŒçºŒå¢åŠ ã€‚
   - å¸¸è¦‹çš„è¨˜æ†¶é«”æ´©æ¼åŸå› ï¼š
     1. **æœªæ¸…ç†çš„å…¨åŸŸè®Šæ•¸**ï¼šä¾‹å¦‚ï¼Œå°‡è®Šæ•¸è³¦å€¼çµ¦ `window`ã€‚
     2. **é–‰åŒ… (Closure)**ï¼šé–‰åŒ…å¯èƒ½æ„å¤–åœ°ä¿ç•™ä¸å¿…è¦çš„è®Šæ•¸ã€‚
     3. **æœªæ¸…ç†çš„äº‹ä»¶ç›£è½å™¨ (Event Listeners)**ï¼šæœªç§»é™¤çš„äº‹ä»¶ç›£è½å™¨æœƒå°è‡´å° DOM å…ƒç´ çš„å¼•ç”¨ä¿ç•™ã€‚
     4. **è¢«éºå¿˜çš„è¨ˆæ™‚å™¨æˆ–å›å‘¼ (setInterval, setTimeout)**ï¼šæœªæ¸…ç†çš„è¨ˆæ™‚å™¨æœƒæŒçºŒä½”ç”¨è¨˜æ†¶é«”ã€‚

2. **åˆç†ä½¿ç”¨å¼±å¼•ç”¨ (Weak References)**ï¼š

   - JavaScript æä¾›äº† `WeakMap` å’Œ `WeakSet`ï¼Œå®ƒå€‘çš„éµæˆ–å€¼æ˜¯å¼±å¼•ç”¨ (Weak Reference)ï¼Œä¸æœƒé˜»æ­¢åƒåœ¾å›æ”¶ã€‚
   - é©åˆç”¨æ–¼å„²å­˜è‡¨æ™‚è³‡æ–™æˆ–å¯è¢«é‡‹æ”¾çš„ç‰©ä»¶ã€‚

3. **æ‰‹å‹•é‡‹æ”¾è³‡æº**ï¼š
   - é›–ç„¶ JavaScript æ˜¯è‡ªå‹•è¨˜æ†¶é«”ç®¡ç†ï¼Œä½†ä»éœ€æ³¨æ„æ‰‹å‹•é‡‹æ”¾è³‡æºï¼Œä¾‹å¦‚ï¼š
     - ç§»é™¤ä¸å†éœ€è¦çš„äº‹ä»¶ç›£è½å™¨ã€‚
     - æ¸…ç†è¨ˆæ™‚å™¨æˆ–å›å‘¼ã€‚

---

#### 4. è¨˜æ†¶é«”åˆ†æå·¥å…·

JavaScript æä¾›ä¸€äº›å·¥å…·å¹«åŠ©é–‹ç™¼è€…åˆ†æè¨˜æ†¶é«”ä½¿ç”¨æƒ…æ³ï¼Œæª¢æ¸¬è¨˜æ†¶é«”æ´©æ¼å•é¡Œï¼š

1. **ç€è¦½å™¨é–‹ç™¼è€…å·¥å…· (DevTools)**ï¼š
   - å¦‚ Chrome DevTools æä¾›çš„ `Memory` é¢æ¿ï¼Œå¯ä»¥ç”¨ä¾†åˆ†æè¨˜æ†¶é«”å †å¿«ç…§ (Heap Snapshot)ã€è¿½è¹¤è¨˜æ†¶é«”åˆ†é…ã€‚
2. **Performance Profiling**ï¼š
   - ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·æª¢æ¸¬è¨˜æ†¶é«”ä½¿ç”¨å³°å€¼ï¼Œæ‰¾å‡ºä¸å¿…è¦çš„ä½”ç”¨è³‡æºã€‚

---

#### 5. å¯¦è¸å»ºè­°

1. **é¿å…ä¸å¿…è¦çš„å…¨åŸŸè®Šæ•¸**ï¼š

   - ä½¿ç”¨ `let` æˆ– `const` å®£å‘Šå€åŸŸè®Šæ•¸ï¼Œç›¡é‡é¿å…ä½¿ç”¨å…¨åŸŸè®Šæ•¸ã€‚

2. **é©æ™‚æ¸…ç†äº‹ä»¶ç›£è½å™¨**ï¼š

   - ä½¿ç”¨ `removeEventListener` æ¸…ç†ä¸å†éœ€è¦çš„äº‹ä»¶ç›£è½å™¨ã€‚

3. **å°å¿ƒé–‰åŒ…çš„ä½¿ç”¨**ï¼š

   - åœ¨ä½¿ç”¨é–‰åŒ…æ™‚ï¼Œç¢ºä¿ä¸æœƒæ„å¤–æ•ç²ä¸å¿…è¦çš„è®Šæ•¸ï¼Œé¿å…ç„¡æ„çš„è¨˜æ†¶é«”ä½”ç”¨ã€‚

4. **ä½¿ç”¨å·¥å…·å®šæœŸæª¢æ¸¬**ï¼š
   - å®šæœŸä½¿ç”¨é–‹ç™¼å·¥å…·æª¢æŸ¥è¨˜æ†¶é«”ä½¿ç”¨æƒ…æ³ï¼Œç‰¹åˆ¥æ˜¯åœ¨å¤§å‹æ‡‰ç”¨ä¸­ã€‚

---

#### Garbage Collection ç¸½çµ

JavaScript çš„åƒåœ¾å›æ”¶æ©Ÿåˆ¶æ˜¯è‡ªå‹•åŒ–çš„ï¼Œä½†é–‹ç™¼è€…ä»éœ€æ³¨æ„åˆç†ç®¡ç†è¨˜æ†¶é«”ï¼Œé¿å…è¨˜æ†¶é«”æ´©æ¼å•é¡Œã€‚äº†è§£åƒåœ¾å›æ”¶çš„å·¥ä½œåŸç†å’Œå¸¸è¦‹å•é¡Œï¼Œèƒ½æœ‰æ•ˆæé«˜æ‡‰ç”¨æ•ˆèƒ½å’Œç©©å®šæ€§ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 13. Asynchronous Patterns éåŒæ­¥æ¨¡å¼

åœ¨ JavaScript ä¸­ï¼ŒéåŒæ­¥ç¨‹å¼è¨­è¨ˆæ˜¯éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå°¤å…¶æ˜¯åœ¨è™•ç† I/O æ“ä½œï¼ˆä¾‹å¦‚ç¶²è·¯è«‹æ±‚ã€è³‡æ–™åº«å­˜å–ç­‰ï¼‰æ™‚ã€‚ä»¥ä¸‹æ˜¯é—œæ–¼éåŒæ­¥æ¨¡å¼çš„å®Œæ•´ç­†è¨˜ï¼Œæ¶µè“‹å„ç¨®å¸¸è¦‹çš„éåŒæ­¥è™•ç†æ–¹å¼åŠå…¶ç›¸é—œæ¦‚å¿µã€‚

---

#### 1. éåŒæ­¥æ¨¡å¼çš„èƒŒæ™¯

JavaScript æ˜¯å–®åŸ·è¡Œç·’ï¼ˆsingle-threadedï¼‰çš„èªè¨€ï¼Œä½¿ç”¨äº‹ä»¶å¾ªç’°ï¼ˆEvent Loopï¼‰ä¾†è™•ç†éåŒæ­¥æ“ä½œã€‚éåŒæ­¥æ¨¡å¼å…è¨±ç¨‹å¼åœ¨ç­‰å¾…æŸäº›æ“ä½œå®Œæˆçš„åŒæ™‚ç¹¼çºŒåŸ·è¡Œå…¶ä»–ç¨‹å¼ç¢¼ï¼Œè€Œä¸æœƒé˜»å¡ï¼ˆblockingï¼‰æ•´å€‹æ‡‰ç”¨ç¨‹å¼ã€‚

---

#### 2. å›èª¿å‡½å¼ï¼ˆCallback Functionsï¼‰

**å›èª¿å‡½å¼ï¼ˆCallback Functionsï¼‰** æ˜¯æœ€åŸºæœ¬çš„éåŒæ­¥æ¨¡å¼ï¼Œé€éå°‡å‡½å¼ä½œç‚ºåƒæ•¸å‚³éçµ¦å…¶ä»–å‡½å¼ï¼Œåœ¨éåŒæ­¥æ“ä½œå®Œæˆå¾ŒåŸ·è¡Œã€‚

```javascript
function doSomethingAsync(callback) {
  setTimeout(() => {
    console.log("éåŒæ­¥æ“ä½œå®Œæˆ");
    callback(); // å‘¼å«å›èª¿å‡½å¼
  }, 1000);
}

doSomethingAsync(() => {
  console.log("åŸ·è¡Œå›èª¿å‡½å¼");
});
```

- å„ªé»ï¼šç°¡å–®æ˜“æ‡‚ï¼Œé©åˆå°å‹éåŒæ­¥æ“ä½œã€‚
- ç¼ºé»ï¼šå®¹æ˜“å°è‡´ã€Œå›èª¿åœ°ç„ã€ï¼ˆCallback Hellï¼‰ï¼Œä½¿ç¨‹å¼ç¢¼é›£ä»¥ç¶­è­·ã€‚

---

#### 3. Promise

**Promise** æ˜¯ ES6 å¼•å…¥çš„ä¸€ç¨®éåŒæ­¥è™•ç†æ–¹å¼ï¼Œè§£æ±ºäº†å›èª¿åœ°ç„çš„å•é¡Œã€‚Promise æ˜¯ä¸€å€‹è¡¨ç¤ºéåŒæ­¥æ“ä½œæœ€çµ‚å®Œæˆæˆ–å¤±æ•—çš„ç‰©ä»¶ï¼Œå…·æœ‰ä¸‰ç¨®ç‹€æ…‹ï¼š

1. **Pendingï¼ˆå¾…å®šï¼‰**ï¼šåˆå§‹ç‹€æ…‹ï¼Œå°šæœªå®Œæˆæˆ–å¤±æ•—ã€‚
2. **Fulfilledï¼ˆå·²å®Œæˆï¼‰**ï¼šéåŒæ­¥æ“ä½œæˆåŠŸå®Œæˆã€‚
3. **Rejectedï¼ˆå·²æ‹’çµ•ï¼‰**ï¼šéåŒæ­¥æ“ä½œå¤±æ•—ã€‚

```javascript
const myPromise = new Promise((resolve, reject) => {
  setTimeout(() => {
    let success = true;
    if (success) {
      resolve("æ“ä½œæˆåŠŸ"); // å®Œæˆ
    } else {
      reject("æ“ä½œå¤±æ•—"); // å¤±æ•—
    }
  }, 1000);
});

myPromise
  .then((result) => {
    console.log(result);
  })
  .catch((error) => {
    console.error(error);
  });
```

- **`then()`**ï¼šè™•ç†å®Œæˆçš„çµæœã€‚
- **`catch()`**ï¼šè™•ç†å¤±æ•—çš„çµæœã€‚
- **`finally()`**ï¼šç„¡è«–æˆåŠŸæˆ–å¤±æ•—éƒ½åŸ·è¡Œã€‚

---

#### 4. Async/Await

**Async/Await** æ˜¯åŸºæ–¼ Promise çš„èªæ³•ç³–ï¼Œç°¡åŒ–äº†éåŒæ­¥ç¨‹å¼ç¢¼çš„æ’°å¯«ï¼Œä½¿ç¨‹å¼ç¢¼çœ‹èµ·ä¾†æ›´åƒåŒæ­¥åŸ·è¡Œã€‚

```javascript
async function fetchData() {
  try {
    const result = await myPromise; // ç­‰å¾… Promise å®Œæˆ
    console.log(result);
  } catch (error) {
    console.error(error); // æ•æ‰éŒ¯èª¤
  }
}

fetchData();
```

- **`async`**ï¼šç”¨ä¾†å®šç¾©éåŒæ­¥å‡½å¼ã€‚
- **`await`**ï¼šæš«åœå‡½å¼åŸ·è¡Œï¼Œç­‰å¾… Promise å®Œæˆã€‚

---

#### 5. Generator èˆ‡éåŒæ­¥

**Generator å‡½å¼** æ˜¯ ES6 å¼•å…¥çš„åŠŸèƒ½ï¼Œå¯ä»¥é€é `yield` æš«åœå‡½å¼åŸ·è¡Œï¼Œèˆ‡éåŒæ­¥è™•ç†çµåˆæ™‚ï¼Œå¯ä»¥æ¨¡æ“¬ Async/Await çš„åŠŸèƒ½ã€‚

```javascript
function* asyncGenerator() {
  yield new Promise((resolve) => setTimeout(() => resolve("ç¬¬ä¸€æ­¥å®Œæˆ"), 1000));
  yield new Promise((resolve) => setTimeout(() => resolve("ç¬¬äºŒæ­¥å®Œæˆ"), 1000));
}

const generator = asyncGenerator();
generator.next().value.then((result) => {
  console.log(result);
  generator.next().value.then((result) => console.log(result));
});
```

- ç›®å‰ Generator åœ¨éåŒæ­¥è™•ç†æ–¹é¢ä½¿ç”¨è¼ƒå°‘ï¼Œå› ç‚º Async/Await æ›´ç°¡æ½”æ˜ç­ã€‚

---

#### 6. Observableï¼ˆå¯è§€å¯Ÿç‰©ä»¶ï¼‰

**Observable** æ˜¯ RxJSï¼ˆReactive Extensions for JavaScriptï¼‰åº«ä¸­çš„æ ¸å¿ƒæ¦‚å¿µï¼Œç”¨æ–¼è™•ç†è³‡æ–™æµï¼ˆdata streamsï¼‰ã€‚å®ƒçš„éåŒæ­¥æ¨¡å¼æä¾›äº†æ›´é«˜çš„å½ˆæ€§ï¼Œç‰¹åˆ¥é©åˆäº‹ä»¶é©…å‹•å’Œè¤‡é›œçš„éåŒæ­¥æ“ä½œã€‚

```javascript
import { Observable } from "rxjs";

const observable = new Observable((subscriber) => {
  subscriber.next("è³‡æ–™æµäº‹ä»¶ 1");
  setTimeout(() => subscriber.next("è³‡æ–™æµäº‹ä»¶ 2"), 1000);
  setTimeout(() => subscriber.complete(), 2000); // å®Œæˆ
});

observable.subscribe({
  next: (data) => console.log(data),
  complete: () => console.log("è³‡æ–™æµå®Œæˆ"),
});
```

- **`next()`**ï¼šç™¼é€è³‡æ–™ã€‚
- **`complete()`**ï¼šå®Œæˆè³‡æ–™æµã€‚
- **`error()`**ï¼šè™•ç†éŒ¯èª¤ã€‚

---

#### 7. äº‹ä»¶å¾ªç’°èˆ‡éåŒæ­¥åŸ·è¡Œ

JavaScript çš„éåŒæ­¥åŸ·è¡ŒåŸºæ–¼äº‹ä»¶å¾ªç’°ï¼ˆEvent Loopï¼‰ï¼Œåˆ†æˆä»¥ä¸‹å¹¾å€‹æ­¥é©Ÿï¼š

1. **Call Stackï¼ˆå‘¼å«å †ç–Šï¼‰**ï¼šåŒæ­¥ç¨‹å¼ç¢¼åŸ·è¡Œçš„ä¸»è¦å€åŸŸã€‚
2. **Web APIs**ï¼šéåŒæ­¥æ“ä½œï¼ˆå¦‚ `setTimeout`ã€HTTP è«‹æ±‚ï¼‰ç”±ç€è¦½å™¨æˆ– Node.js æä¾›çš„ API è™•ç†ã€‚
3. **Task Queueï¼ˆä»»å‹™ä½‡åˆ—ï¼‰**ï¼šå„²å­˜éåŒæ­¥æ“ä½œå®Œæˆå¾Œçš„å›èª¿å‡½å¼ã€‚
4. **Microtask Queueï¼ˆå¾®ä»»å‹™ä½‡åˆ—ï¼‰**ï¼šåŒ…å« Promise çš„å›èª¿å‡½å¼ï¼Œå„ªå…ˆç´šé«˜æ–¼ Task Queueã€‚

ä»¥ä¸‹æ˜¯äº‹ä»¶å¾ªç’°çš„ç¤ºæ„ç¨‹å¼ç¢¼ï¼š

```javascript
console.log("åŒæ­¥ç¨‹å¼ç¢¼é–‹å§‹");

setTimeout(() => console.log("ä¾†è‡ª Task Queue çš„éåŒæ­¥ç¨‹å¼ç¢¼"), 0);

Promise.resolve().then(() =>
  console.log("ä¾†è‡ª Microtask Queue çš„éåŒæ­¥ç¨‹å¼ç¢¼")
);

console.log("åŒæ­¥ç¨‹å¼ç¢¼çµæŸ");
```

è¼¸å‡ºçµæœï¼š

```bash
åŒæ­¥ç¨‹å¼ç¢¼é–‹å§‹
åŒæ­¥ç¨‹å¼ç¢¼çµæŸ
ä¾†è‡ª Microtask Queue çš„éåŒæ­¥ç¨‹å¼ç¢¼
ä¾†è‡ª Task Queue çš„éåŒæ­¥ç¨‹å¼ç¢¼
```

---

#### 8. å¸¸è¦‹éåŒæ­¥æ¨¡å¼çš„æ¯”è¼ƒ

| æ¨¡å¼                | å„ªé»                       | ç¼ºé»                           | ç”¨é€”             |
| ------------------- | -------------------------- | ------------------------------ | ---------------- |
| å›èª¿å‡½å¼ (Callback) | ç°¡å–®æ˜“æ‡‚                   | å®¹æ˜“å‡ºç¾å›èª¿åœ°ç„               | åŸºæœ¬éåŒæ­¥æ“ä½œ   |
| Promise             | çµæ§‹åŒ–ç¨‹å¼ç¢¼ï¼Œé¿å…å›èª¿åœ°ç„ | éœ€è¦ç†è§£ Promise èªæ³•          | è¤‡é›œéåŒæ­¥æ“ä½œ   |
| Async/Await         | æ›´ç°¡æ½”çš„éåŒæ­¥ç¨‹å¼ç¢¼       | éœ€æ­é… ES6+ï¼Œéœ€æœ‰ Promise æ”¯æ´ | ç¾ä»£éåŒæ­¥ç¨‹å¼ç¢¼ |
| Generator           | æ§åˆ¶åŸ·è¡Œæµç¨‹               | èªæ³•ç¨å¾®è¤‡é›œï¼Œä½¿ç”¨è¼ƒå°‘         | é«˜éšéåŒæ­¥æ§åˆ¶   |
| Observable          | æ”¯æ´è³‡æ–™æµï¼Œé©åˆäº‹ä»¶é©…å‹•   | éœ€é¡å¤–å®‰è£ RxJS åº«             | è¤‡é›œäº‹ä»¶è™•ç†     |

---

#### 9. ç¸½çµ

éåŒæ­¥æ¨¡å¼æ˜¯ JavaScript ä¸­çš„é‡è¦éƒ¨åˆ†ï¼Œé¸æ“‡é©åˆçš„æ¨¡å¼å–æ±ºæ–¼æ‡‰ç”¨å ´æ™¯ï¼š

- å°å‹éåŒæ­¥æ“ä½œå¯ä½¿ç”¨å›èª¿å‡½å¼æˆ– Promiseã€‚
- è¤‡é›œéåŒæ­¥é‚è¼¯æ¨è–¦ä½¿ç”¨ Async/Awaitã€‚
- è‹¥éœ€è¦è™•ç†è³‡æ–™æµæˆ–äº‹ä»¶é©…å‹•ï¼ŒObservable æ˜¯ä¸éŒ¯çš„é¸æ“‡ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 14. Promises Promise æ©Ÿåˆ¶

#### ä»€éº¼æ˜¯ Promiseï¼Ÿ

`Promise` æ˜¯ JavaScript ä¸­ç”¨ä¾†è™•ç†éåŒæ­¥æ“ä½œï¼ˆAsynchronous Operationï¼‰çš„ç‰©ä»¶ã€‚å®ƒå¯ä»¥å¹«åŠ©æˆ‘å€‘æ›´æœ‰æ•ˆç‡åœ°ç®¡ç†éåŒæ­¥æµç¨‹ï¼Œé¿å…å‚³çµ±å›å‘¼å‡½å¼ï¼ˆCallback Functionï¼‰æ‰€é€ æˆçš„ã€Œå›å‘¼åœ°ç„ã€ï¼ˆCallback Hellï¼‰ã€‚

---

#### Promise çš„ä¸‰ç¨®ç‹€æ…‹ï¼ˆStatesï¼‰

1. **å¾…å®šç‹€æ…‹ï¼ˆPendingï¼‰**  
   åˆå§‹ç‹€æ…‹ï¼Œè¡¨ç¤ºéåŒæ­¥æ“ä½œå°šæœªå®Œæˆï¼Œä¹Ÿå°šæœªæœ‰çµæœã€‚

2. **å·²è§£æ±ºç‹€æ…‹ï¼ˆFulfilled / Resolvedï¼‰**  
   è¡¨ç¤ºéåŒæ­¥æ“ä½œå·²æˆåŠŸå®Œæˆï¼Œä¸¦ä¸”è¿”å›äº†ä¸€å€‹å€¼ï¼ˆResultï¼‰ã€‚

3. **å·²æ‹’çµ•ç‹€æ…‹ï¼ˆRejectedï¼‰**  
   è¡¨ç¤ºéåŒæ­¥æ“ä½œç™¼ç”ŸéŒ¯èª¤æˆ–å¤±æ•—ï¼Œä¸¦è¿”å›ä¸€å€‹åŸå› ï¼ˆReasonï¼‰ã€‚

---

#### Promise çš„åŸºæœ¬èªæ³•

```javascript
const promise = new Promise((resolve, reject) => {
  // éåŒæ­¥æ“ä½œ
  if (æˆåŠŸ) {
    resolve(çµæœ); // å°‡ Promise ç‹€æ…‹æ”¹ç‚º "å·²è§£æ±º"
  } else {
    reject(åŸå› ); // å°‡ Promise ç‹€æ…‹æ”¹ç‚º "å·²æ‹’çµ•"
  }
});
```

---

#### ä½¿ç”¨ `.then()` å’Œ `.catch()`

1. `.then()`ï¼šç”¨ä¾†è™•ç†å·²è§£æ±ºï¼ˆFulfilledï¼‰çš„çµæœã€‚
2. `.catch()`ï¼šç”¨ä¾†æ•æ‰å·²æ‹’çµ•ï¼ˆRejectedï¼‰çš„éŒ¯èª¤ã€‚

ç¯„ä¾‹ï¼š

```javascript
const promise = new Promise((resolve, reject) => {
  const success = true;
  if (success) {
    resolve("æˆåŠŸçš„çµæœ");
  } else {
    reject("ç™¼ç”ŸéŒ¯èª¤");
  }
});

promise
  .then((result) => {
    console.log("æˆåŠŸ:", result);
  })
  .catch((error) => {
    console.error("éŒ¯èª¤:", error);
  });
```

---

#### ä½¿ç”¨ `.finally()`

`.finally()` æ–¹æ³•ç„¡è«– Promise æ˜¯æˆåŠŸé‚„æ˜¯å¤±æ•—ï¼Œæœ€å¾Œéƒ½æœƒåŸ·è¡ŒæŸæ®µç¨‹å¼ç¢¼ï¼Œé©åˆç”¨æ–¼æ¸…ç†è³‡æºã€‚

ç¯„ä¾‹ï¼š

```javascript
promise
  .then((result) => {
    console.log("æˆåŠŸ:", result);
  })
  .catch((error) => {
    console.error("éŒ¯èª¤:", error);
  })
  .finally(() => {
    console.log("å®Œæˆæ“ä½œ");
  });
```

---

#### Promise çš„éˆå¼èª¿ç”¨ï¼ˆChainingï¼‰

å¤šå€‹ `.then()` å¯ä»¥ä¸²è¯èµ·ä¾†å½¢æˆéˆå¼èª¿ç”¨ï¼Œè®“ç¨‹å¼ç¢¼æ›´å…·å¯è®€æ€§ã€‚

ç¯„ä¾‹ï¼š

```javascript
new Promise((resolve, reject) => {
  resolve(1);
})
  .then((result) => {
    console.log(result); // 1
    return result + 1;
  })
  .then((result) => {
    console.log(result); // 2
    return result + 1;
  })
  .then((result) => {
    console.log(result); // 3
  })
  .catch((error) => {
    console.error("éŒ¯èª¤:", error);
  });
```

---

#### Promise çš„éœæ…‹æ–¹æ³•ï¼ˆStatic Methodsï¼‰

JavaScript æä¾›äº†ä¸€äº›éœæ…‹æ–¹æ³•ä¾†è¼”åŠ©æ“ä½œå¤šå€‹ Promiseã€‚

##### 1. `Promise.all()`

ç•¶æ‰€æœ‰çš„ Promise éƒ½å®Œæˆï¼ˆFulfilledï¼‰å¾Œï¼Œè¿”å›ä¸€å€‹åŒ…å«æ‰€æœ‰çµæœçš„é™£åˆ—ã€‚å¦‚æœæœ‰ä»»ä¸€ Promise è¢«æ‹’çµ•ï¼ˆRejectedï¼‰ï¼Œå‰‡æ•´å€‹çµæœè¢«æ‹’çµ•ã€‚

ç¯„ä¾‹ï¼š

```javascript
const promise1 = Promise.resolve(1);
const promise2 = Promise.resolve(2);
const promise3 = Promise.resolve(3);

Promise.all([promise1, promise2, promise3])
  .then((results) => {
    console.log(results); // [1, 2, 3]
  })
  .catch((error) => {
    console.error("éŒ¯èª¤:", error);
  });
```

##### 2. `Promise.race()`

è¿”å›ç¬¬ä¸€å€‹å®Œæˆçš„ Promiseï¼ˆä¸è«–æ˜¯ Fulfilled é‚„æ˜¯ Rejectedï¼‰ã€‚

ç¯„ä¾‹ï¼š

```javascript
const promise1 = new Promise((resolve) => setTimeout(resolve, 100, "æ…¢"));
const promise2 = new Promise((resolve) => setTimeout(resolve, 50, "å¿«"));

Promise.race([promise1, promise2]).then((result) => {
  console.log(result); // "å¿«"
});
```

##### 3. `Promise.allSettled()`

ç­‰å¾…æ‰€æœ‰ Promise éƒ½å®Œæˆï¼ˆä¸è«–æ˜¯ Fulfilled é‚„æ˜¯ Rejectedï¼‰ï¼Œç„¶å¾Œè¿”å›æ¯å€‹ Promise çš„çµæœç‰©ä»¶ã€‚

ç¯„ä¾‹ï¼š

```javascript
const promise1 = Promise.resolve(1);
const promise2 = Promise.reject("éŒ¯èª¤");
const promise3 = Promise.resolve(3);

Promise.allSettled([promise1, promise2, promise3]).then((results) => {
  console.log(results);
  // [
  //   { status: "fulfilled", value: 1 },
  //   { status: "rejected", reason: "éŒ¯èª¤" },
  //   { status: "fulfilled", value: 3 }
  // ]
});
```

##### 4. `Promise.any()`

è¿”å›ç¬¬ä¸€å€‹æˆåŠŸï¼ˆFulfilledï¼‰çš„ Promiseï¼Œå¦‚æœæ‰€æœ‰ Promise éƒ½è¢«æ‹’çµ•ï¼Œå‰‡è¿”å›ä¸€å€‹ AggregateErrorã€‚

ç¯„ä¾‹ï¼š

```javascript
const promise1 = Promise.reject("éŒ¯èª¤1");
const promise2 = Promise.reject("éŒ¯èª¤2");
const promise3 = Promise.resolve("æˆåŠŸ");

Promise.any([promise1, promise2, promise3])
  .then((result) => {
    console.log(result); // "æˆåŠŸ"
  })
  .catch((error) => {
    console.error(error); // å¦‚æœå…¨éƒ¨å¤±æ•—ï¼Œè¿”å› AggregateError
  });
```

---

#### èˆ‡ Async / Await çš„çµåˆ

`Promise` é€šå¸¸èˆ‡ `async/await` ä¸€èµ·ä½¿ç”¨ï¼Œä½¿éåŒæ­¥ç¨‹å¼ç¢¼æ›´å…·åŒæ­¥åŒ–çš„å¯è®€æ€§ã€‚

ç¯„ä¾‹ï¼š

```javascript
async function fetchData() {
  try {
    const result = await new Promise((resolve, reject) => {
      setTimeout(() => resolve("è³‡æ–™è¼‰å…¥å®Œæˆ"), 1000);
    });
    console.log(result);
  } catch (error) {
    console.error("éŒ¯èª¤:", error);
  }
}

fetchData();
```

---

#### å¸¸è¦‹çš„éŒ¯èª¤è™•ç†

1. å¿˜è¨˜è¿”å› `Promise` ç‰©ä»¶ï¼Œå°è‡´éˆå¼èª¿ç”¨ä¸­æ–·ã€‚
2. å¿˜è¨˜ä½¿ç”¨ `.catch()` æˆ– `try/catch` æ•æ‰éŒ¯èª¤ã€‚
3. åœ¨ `Promise` ä¸­æ··ç”¨åŒæ­¥å’ŒéåŒæ­¥é‚è¼¯ï¼Œå°è‡´é›£ä»¥è¿½è¹¤éŒ¯èª¤ã€‚

ç¯„ä¾‹ï¼š

```javascript
new Promise((resolve, reject) => {
  throw new Error("æœªæ•æ‰çš„éŒ¯èª¤");
}).catch((error) => {
  console.error("æ•æ‰åˆ°éŒ¯èª¤:", error);
});
```

---

#### Promise ç¸½çµ

`Promise` æ˜¯ JavaScript ä¸­è™•ç†éåŒæ­¥æ“ä½œçš„æ ¸å¿ƒå·¥å…·ï¼Œé€é `.then()`ã€`.catch()` å’Œ `.finally()` ä¾†ç®¡ç†æµç¨‹ï¼Œä¸¦èƒ½èˆ‡ `async/await` é«˜æ•ˆçµåˆã€‚æ­¤å¤–ï¼Œé€ééœæ…‹æ–¹æ³•å¦‚ `Promise.all()`ã€`Promise.race()` ç­‰ï¼Œèƒ½è¼•é¬†è™•ç†å¤šå€‹éåŒæ­¥æ“ä½œçš„æƒ…å¢ƒã€‚å­¸æœƒ `Promise` çš„ä½¿ç”¨ï¼Œèƒ½å¤§å¹…æå‡ç¨‹å¼ç¢¼çš„å¯è®€æ€§èˆ‡ç¶­è­·æ€§ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 15. Async/Await

#### æ¦‚è¿°

`async/await` æ˜¯ JavaScript ä¸­ç”¨ä¾†è™•ç†éåŒæ­¥ç¨‹å¼ç¢¼ (asynchronous code) çš„èªæ³•ç³–ã€‚å®ƒå»ºç«‹åœ¨ `Promises` ä¹‹ä¸Šï¼Œä½¿å¾—éåŒæ­¥ç¨‹å¼ç¢¼çš„æ’°å¯«æ›´åŠ ç°¡æ½”å’Œæ˜“è®€ã€‚

#### åŸºæœ¬ç”¨æ³•

1. **Async å‡½å¼**ï¼šåœ¨å‡½å¼å‰åŠ ä¸Š `async` é—œéµå­—ï¼Œè©²å‡½å¼å°±æœƒè‡ªå‹•å›å‚³ä¸€å€‹ `Promise`ã€‚é€™å€‹å‡½å¼å¯ä»¥åŒ…å« `await` è¡¨é”å¼ã€‚

   ```javascript
   async function myFunction() {
     return "Hello, World!";
   }

   myFunction().then((value) => console.log(value)); // è¼¸å‡º: Hello, World!
   ```

2. **Await è¡¨é”å¼**ï¼š`await` ç”¨æ–¼ç­‰å¾…ä¸€å€‹ `Promise` å®Œæˆã€‚å®ƒåªèƒ½åœ¨ `async` å‡½å¼å…§ä½¿ç”¨ï¼Œä¸¦æœƒæš«åœå‡½å¼çš„åŸ·è¡Œç›´åˆ° `Promise` è§£æ±º (resolved)ã€‚

   ```javascript
   async function fetchData() {
     let response = await fetch("https://api.example.com/data");
     let data = await response.json();
     return data;
   }

   fetchData().then((data) => console.log(data));
   ```

#### éŒ¯èª¤è™•ç†

åœ¨ `async/await` ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `try...catch` èªå¥ä¾†æ•æ‰ `Promise` ä¸­çš„éŒ¯èª¤ã€‚

```javascript
async function getData() {
  try {
    let response = await fetch("https://api.example.com/data");
    let data = await response.json();
    return data;
  } catch (error) {
    console.error("Error:", error);
  }
}

getData();
```

#### èˆ‡ Promise çš„æ¯”è¼ƒ

- **å¯è®€æ€§**ï¼š`async/await` æä¾›äº†æ›´æ¥è¿‘åŒæ­¥ç¨‹å¼ç¢¼çš„å¯«æ³•ï¼Œä½¿ç¨‹å¼ç¢¼æ›´å…·å¯è®€æ€§å’Œå¯ç¶­è­·æ€§ã€‚
- **éŒ¯èª¤è™•ç†**ï¼šé€é `try...catch`ï¼ŒéŒ¯èª¤è™•ç†æ›´ç›´è§€ã€‚

#### æ³¨æ„äº‹é …

1. **é˜»å¡ (Blocking)**ï¼š`await` å°‡æš«åœå‡½å¼çš„åŸ·è¡Œï¼Œç›´åˆ° `Promise` å®Œæˆã€‚å› æ­¤åœ¨ä¸€å€‹ `async` å‡½å¼ä¸­ï¼Œä½¿ç”¨ `await` æ™‚éœ€å°å¿ƒé¿å…é˜»å¡å…¶ä»–æ“ä½œã€‚
2. **é †åºåŸ·è¡Œ**ï¼šè‹¥éœ€è¦ä¸¦è¡ŒåŸ·è¡Œå¤šå€‹éåŒæ­¥æ“ä½œï¼Œæ‡‰é¿å…ç›´æ¥ä¾æ¬¡ä½¿ç”¨ `await`ï¼Œè€Œæ˜¯å¯ä»¥è€ƒæ…®ä½¿ç”¨ `Promise.all()`ã€‚

   ```javascript
   async function loadData() {
     let [data1, data2] = await Promise.all([
       fetch("https://api.example.com/data1"),
       fetch("https://api.example.com/data2"),
     ]);

     // è™•ç† data1 å’Œ data2
   }
   ```

#### çµè«–

`async/await` ç‚º JavaScript çš„éåŒæ­¥ç¨‹å¼ç¢¼æä¾›äº†ä¸€ç¨®æ›´ç°¡æ½”ã€ç›´è§€çš„è™•ç†æ–¹å¼ã€‚ç†è§£å…¶é‹ä½œæ–¹å¼å’Œé©ç•¶ä½¿ç”¨å ´æ™¯ï¼Œæœ‰åŠ©æ–¼æå‡ç¨‹å¼ç¢¼çš„æ•´é«”å“è³ªå’Œæ•ˆç‡ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 16. Callback Queue å›èª¿éšŠåˆ—

åœ¨ JavaScript çš„éåŒæ­¥æ“ä½œä¸­ï¼Œäº†è§£ Callback Queueï¼ˆå›èª¿éšŠåˆ—ï¼‰æ˜¯éå¸¸é‡è¦çš„ã€‚å®ƒæ˜¯äº‹ä»¶å¾ªç’°ï¼ˆEvent Loopï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œè² è²¬è™•ç†éåŒæ­¥ç¨‹å¼çš„åŸ·è¡Œé †åºã€‚æœ¬ç­†è¨˜å°‡å®Œæ•´æ•´ç†é—œæ–¼ Callback Queue çš„æ ¸å¿ƒæ¦‚å¿µã€é‹ä½œæ–¹å¼åŠç›¸é—œç´°ç¯€ã€‚

---

#### ä»€éº¼æ˜¯ Callback Queueï¼ˆå›èª¿éšŠåˆ—ï¼‰ï¼Ÿ

Callback Queue æ˜¯ä¸€å€‹å°ˆé–€ç”¨ä¾†å„²å­˜ **éåŒæ­¥å›èª¿å‡½å¼ï¼ˆasynchronous callback functionsï¼‰** çš„éšŠåˆ—ã€‚ç•¶æŸäº›éåŒæ­¥æ“ä½œå®Œæˆå¾Œï¼Œå°æ‡‰çš„å›èª¿å‡½å¼æœƒè¢«æ¨å…¥æ­¤éšŠåˆ—ä¸­ï¼Œç­‰å¾…ä¸»åŸ·è¡Œç·’ï¼ˆMain Threadï¼‰ç©ºé–’æ™‚åŸ·è¡Œã€‚

---

#### Callback Queue çš„é‹ä½œæ–¹å¼

Callback Queue èˆ‡äº‹ä»¶å¾ªç’°ï¼ˆEvent Loopï¼‰å¯†åˆ‡ç›¸é—œï¼Œå…¶é‹ä½œæ–¹å¼å¦‚ä¸‹ï¼š

1. **éåŒæ­¥æ“ä½œè¢«è§¸ç™¼**  
   ç•¶ç¨‹å¼åŸ·è¡ŒéåŒæ­¥æ“ä½œï¼ˆå¦‚ `setTimeout`ã€HTTP è«‹æ±‚æˆ– DOM äº‹ä»¶ï¼‰æ™‚ï¼Œå›èª¿å‡½å¼ä¸æœƒç«‹å³åŸ·è¡Œï¼Œè€Œæ˜¯è¢«å§”æ´¾çµ¦ Web APIsï¼ˆç€è¦½å™¨æˆ– Node.js æä¾›çš„åº•å±¤åŠŸèƒ½ï¼‰ã€‚

2. **å›èª¿å‡½å¼é€²å…¥ Callback Queue**  
   ä¸€æ—¦éåŒæ­¥æ“ä½œå®Œæˆï¼Œä¾‹å¦‚è¨ˆæ™‚å™¨åˆ°æœŸæˆ–ä¼ºæœå™¨å›æ‡‰å®Œæˆï¼Œå›èª¿å‡½å¼æœƒè¢«æ¨å…¥ Callback Queueã€‚

3. **äº‹ä»¶å¾ªç’°æª¢æŸ¥**  
   äº‹ä»¶å¾ªç’°æœƒæŒçºŒæª¢æŸ¥ Call Stackï¼ˆå‘¼å«å †ç–Šï¼‰æ˜¯å¦ç‚ºç©ºã€‚å¦‚æœ Call Stack ç‚ºç©ºï¼Œäº‹ä»¶å¾ªç’°æœƒå¾ Callback Queue ä¸­å–å‡ºç¬¬ä¸€å€‹å›èª¿å‡½å¼ï¼Œä¸¦æ¨å…¥ Call Stack ä¸­åŸ·è¡Œã€‚

4. **å›èª¿å‡½å¼åŸ·è¡Œ**  
   å›èª¿å‡½å¼åœ¨ Call Stack ä¸­åŸ·è¡Œï¼Œè™•ç†å®Œç•¢å¾Œï¼ŒCall Stack å†æ¬¡æ¸…ç©ºï¼Œäº‹ä»¶å¾ªç’°ç¹¼çºŒæª¢æŸ¥ Callback Queueã€‚

---

#### èˆ‡ Macro Task å’Œ Micro Task çš„é—œä¿‚

JavaScript çš„éåŒæ­¥éšŠåˆ—åˆ†ç‚ºå…©ç¨®é¡å‹ï¼š**Macro Taskï¼ˆå·¨ä»»å‹™ï¼‰** å’Œ **Micro Taskï¼ˆå¾®ä»»å‹™ï¼‰**ã€‚å®ƒå€‘çš„åŸ·è¡Œé †åºä¸åŒï¼Œä¸¦ä¸”æœƒå½±éŸ¿ Callback Queue çš„è¡Œç‚ºã€‚

- **Macro Taskï¼ˆå·¨ä»»å‹™ï¼‰**  
  åŒ…æ‹¬ `setTimeout`ã€`setInterval` å’Œ I/Oï¼ˆå¦‚ HTTP è«‹æ±‚ï¼‰ã€‚ç•¶ Macro Task å®Œæˆå¾Œï¼Œå›èª¿å‡½å¼æœƒé€²å…¥ Callback Queueã€‚

- **Micro Taskï¼ˆå¾®ä»»å‹™ï¼‰**  
  åŒ…æ‹¬ `Promise.then` å’Œ `MutationObserver`ã€‚Micro Task çš„å„ªå…ˆç´šé«˜æ–¼ Macro Taskï¼Œæœƒç›´æ¥é€²å…¥ Micro Task Queueï¼Œä¸¦åœ¨æ¯æ¬¡äº‹ä»¶å¾ªç’°å®Œæˆå¾Œç«‹å³åŸ·è¡Œã€‚

åŸ·è¡Œé †åºï¼š

1. å…ˆåŸ·è¡Œæ‰€æœ‰ Micro Taskã€‚
2. å†åŸ·è¡Œ Macro Taskã€‚

---

#### ç¯„ä¾‹ï¼šCallback Queue çš„è¡Œç‚º

ä»¥ä¸‹ç¯„ä¾‹å±•ç¤º Callback Queue çš„é‹ä½œæ–¹å¼ï¼š

```javascript
console.log("Start");

setTimeout(() => {
  console.log("Timeout callback");
}, 0);

Promise.resolve().then(() => {
  console.log("Promise callback");
});

console.log("End");
```

åŸ·è¡Œçµæœï¼š

```bash
Start
End
Promise callback
Timeout callback
```

åŸå› ï¼š

1. `Promise.then` æ˜¯ Micro Taskï¼Œå„ªå…ˆæ–¼ `setTimeout`ï¼ˆMacro Taskï¼‰ã€‚
2. `setTimeout` çš„å›èª¿å‡½å¼é€²å…¥ Callback Queueï¼Œéœ€ç­‰å¾… Call Stack æ¸…ç©ºå¾Œæ‰åŸ·è¡Œã€‚

---

#### é—œéµé»æ•´ç†

1. Callback Queue å„²å­˜éåŒæ­¥æ“ä½œå®Œæˆå¾Œçš„å›èª¿å‡½å¼ã€‚
2. äº‹ä»¶å¾ªç’°è² è²¬æª¢æŸ¥ Call Stack æ˜¯å¦ç©ºé–’ï¼Œä¸¦å¾ Callback Queue ä¸­å–å‡ºå›èª¿å‡½å¼åŸ·è¡Œã€‚
3. Micro Task çš„å„ªå…ˆç´šé«˜æ–¼ Macro Taskã€‚
4. ä½¿ç”¨éåŒæ­¥ç¨‹å¼è¨­è¨ˆæ™‚ï¼Œéœ€è€ƒæ…®å›èª¿å‡½å¼çš„åŸ·è¡Œé †åºï¼Œä»¥é¿å…æ··æ·†ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 17. Microtask Queue å¾®ä»»å‹™éšŠåˆ—

#### **ä»€éº¼æ˜¯ Microtask Queueï¼Ÿ**

Microtask Queueï¼ˆå¾®ä»»å‹™éšŠåˆ—ï¼‰æ˜¯ JavaScript åŸ·è¡Œç’°å¢ƒä¸­ä¸€ç¨®ç”¨æ–¼è™•ç†ä»»å‹™çš„éšŠåˆ—ï¼Œå®ƒæ˜¯äº‹ä»¶å¾ªç’°ï¼ˆEvent Loopï¼‰çš„ä¸€éƒ¨åˆ†ã€‚å¾®ä»»å‹™çš„åŸ·è¡Œå„ªå…ˆç´šé«˜æ–¼å®ä»»å‹™ï¼ˆMacrotaskï¼‰ã€‚

---

#### **Microtask çš„ä¾†æº**

Microtask æ˜¯ç”±ä»¥ä¸‹æ“ä½œæˆ– API ç”¢ç”Ÿçš„ï¼š

1. **Promise** çš„ `.then()`ã€`.catch()` å’Œ `.finally()` å›èª¿ã€‚
2. **MutationObserver**ï¼ˆè®Šå‹•ç›£è½å™¨ï¼‰ã€‚
3. **queueMicrotask()** æ–¹æ³•ã€‚

---

#### **Microtask Queue çš„ç‰¹æ€§**

1. **åŸ·è¡Œå„ªå…ˆç´šé«˜**  
   åœ¨äº‹ä»¶å¾ªç’°ä¸­ï¼ŒMicrotask Queue æœƒåœ¨æ¯æ¬¡åŸ·è¡Œå®ŒåŒæ­¥ä»£ç¢¼å¾Œã€è™•ç†ä¸‹ä¸€å€‹ Macrotaskï¼ˆå¦‚ setTimeoutï¼‰çš„ä¹‹å‰åŸ·è¡Œã€‚æ›å¥è©±èªªï¼Œå¾®ä»»å‹™çš„åŸ·è¡Œå„ªå…ˆæ–¼å®ä»»å‹™ã€‚

2. **ä¸€å€‹æ‰¹æ¬¡åŸ·è¡Œå®Œæ‰€æœ‰å¾®ä»»å‹™**  
   ç•¶äº‹ä»¶å¾ªç’°é€²å…¥ Microtask Queue æ™‚ï¼Œæœƒæ¸…ç©ºéšŠåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»å‹™ï¼Œç¢ºä¿å®ƒå€‘ä¸€æ¬¡æ€§åŸ·è¡Œå®Œç•¢ã€‚

3. **èˆ‡åŒæ­¥ä»£ç¢¼ç·Šå¯†çµåˆ**  
   å¾®ä»»å‹™çš„åŸ·è¡Œæ˜¯åœ¨åŒæ­¥ä»£ç¢¼çµæŸå¾Œç«‹å³é–‹å§‹çš„ï¼Œå› æ­¤å®ƒå€‘èƒ½å¤ å¿«é€ŸéŸ¿æ‡‰ã€‚

---

#### **Microtask èˆ‡ Macrotask çš„æ¯”è¼ƒ**

| ç‰¹æ€§           | Microtask (å¾®ä»»å‹™)             | Macrotask (å®ä»»å‹™)           |
| -------------- | ------------------------------ | ---------------------------- |
| **åŸ·è¡Œå„ªå…ˆç´š** | é«˜                             | ä½                           |
| **å¸¸è¦‹ä¾†æº**   | Promiseã€queueMicrotask        | setTimeoutã€setInterval      |
| **åŸ·è¡Œæ™‚æ©Ÿ**   | åŒæ­¥ä»£ç¢¼ä¹‹å¾Œï¼Œä¸‹ä¸€å€‹å®ä»»å‹™ä¹‹å‰ | æ¯æ¬¡äº‹ä»¶å¾ªç’°çš„ä¸‹ä¸€è¼ªåŸ·è¡Œé–‹å§‹ |
| **åŸ·è¡Œç¯„åœ**   | ä¸€æ¬¡æ€§æ¸…ç©ºæ‰€æœ‰å¾®ä»»å‹™           | æ¯æ¬¡åŸ·è¡Œä¸€å€‹å®ä»»å‹™           |

---

#### **äº‹ä»¶å¾ªç’°ï¼ˆEvent Loopï¼‰èˆ‡ Microtask**

äº‹ä»¶å¾ªç’°çš„åŸ·è¡Œé †åºå¦‚ä¸‹ï¼š

1. åŸ·è¡Œ **åŒæ­¥ä»£ç¢¼**ã€‚
2. åŸ·è¡Œ **Microtask Queue** ä¸­çš„æ‰€æœ‰ä»»å‹™ã€‚
3. åŸ·è¡Œ **Macrotask Queue** ä¸­çš„ç¬¬ä¸€å€‹ä»»å‹™ã€‚
4. é‡è¤‡æ­¥é©Ÿ 2 å’Œæ­¥é©Ÿ 3ã€‚

---

#### **å¸¸è¦‹æ“ä½œç¤ºä¾‹**

ä»¥ä¸‹æ˜¯ä¸€äº›èˆ‡ Microtask Queue ç›¸é—œçš„å¯¦éš›ä»£ç¢¼ç¤ºä¾‹ï¼š

1. **Promise èˆ‡ Microtask**

   ```javascript
   console.log("åŒæ­¥ä»£ç¢¼é–‹å§‹");

   Promise.resolve().then(() => {
     console.log("å¾®ä»»å‹™ 1");
   });

   console.log("åŒæ­¥ä»£ç¢¼çµæŸ");

   // è¼¸å‡ºé †åºï¼š
   // åŒæ­¥ä»£ç¢¼é–‹å§‹
   // åŒæ­¥ä»£ç¢¼çµæŸ
   // å¾®ä»»å‹™ 1
   ```

2. **queueMicrotask**

   ```javascript
   console.log("åŒæ­¥ä»£ç¢¼é–‹å§‹");

   queueMicrotask(() => {
     console.log("å¾®ä»»å‹™ 1");
   });

   console.log("åŒæ­¥ä»£ç¢¼çµæŸ");

   // è¼¸å‡ºé †åºï¼š
   // åŒæ­¥ä»£ç¢¼é–‹å§‹
   // åŒæ­¥ä»£ç¢¼çµæŸ
   // å¾®ä»»å‹™ 1
   ```

3. **Microtask èˆ‡ Macrotask çš„æ¯”è¼ƒ**

   ```javascript
   console.log("åŒæ­¥ä»£ç¢¼é–‹å§‹");

   setTimeout(() => {
     console.log("å®ä»»å‹™ 1");
   }, 0);

   Promise.resolve().then(() => {
     console.log("å¾®ä»»å‹™ 1");
   });

   console.log("åŒæ­¥ä»£ç¢¼çµæŸ");

   // è¼¸å‡ºé †åºï¼š
   // åŒæ­¥ä»£ç¢¼é–‹å§‹
   // åŒæ­¥ä»£ç¢¼çµæŸ
   // å¾®ä»»å‹™ 1
   // å®ä»»å‹™ 1
   ```

---

#### **queueMicrotask() çš„ä½¿ç”¨**

`queueMicrotask()` æ˜¯ä¸€å€‹å°ˆé–€ç”¨æ–¼å‘ Microtask Queue æ·»åŠ ä»»å‹™çš„æ–¹æ³•ã€‚å®ƒæ˜¯ä¸€å€‹å…¨åŸŸæ–¹æ³•ï¼Œèªæ³•ç°¡å–®ï¼Œä¸”åŸ·è¡Œæ•ˆç‡é«˜ã€‚

```javascript
queueMicrotask(() => {
  console.log("é€™æ˜¯ä¸€å€‹å¾®ä»»å‹™");
});
```

**ä½¿ç”¨å ´æ™¯ï¼š**

- ç•¶éœ€è¦å„ªå…ˆåŸ·è¡ŒæŸäº›ä»»å‹™æ™‚ï¼Œå¯ä»¥ä½¿ç”¨ `queueMicrotask()`ã€‚
- æ¯”ä½¿ç”¨ `setTimeout` æ›´å¿«é€Ÿï¼Œä¸”ä¸æœƒå»¶é²ã€‚

---

#### **æ³¨æ„äº‹é …**

1. **é¿å…ç„¡é™éæ­¸**  
   å¦‚æœåœ¨ä¸€å€‹å¾®ä»»å‹™ä¸­ä¸æ–·æ·»åŠ æ–°çš„å¾®ä»»å‹™ï¼Œå¯èƒ½æœƒå°è‡´ç„¡é™éæ­¸ï¼Œé˜»å¡äº‹ä»¶å¾ªç’°ã€‚

   ```javascript
   function infiniteMicrotask() {
     queueMicrotask(infiniteMicrotask);
   }
   infiniteMicrotask(); // å°‡å°è‡´ç„¡é™éæ­¸ï¼Œç¨‹å¼å´©æ½°
   ```

2. **èˆ‡åŒæ­¥ä»£ç¢¼çš„é—œä¿‚**  
   å¾®ä»»å‹™çš„åŸ·è¡Œç¸½æ˜¯åœ¨åŒæ­¥ä»£ç¢¼ä¹‹å¾Œï¼Œå› æ­¤è‹¥æœ‰å¤§é‡çš„åŒæ­¥ä»£ç¢¼ï¼Œå¾®ä»»å‹™å¯èƒ½æœƒè¢«å»¶é²åŸ·è¡Œã€‚

---

#### **å¸¸è¦‹å•é¡Œ**

1. **ç‚ºä»€éº¼ Microtask çš„åŸ·è¡Œå„ªå…ˆæ–¼ Macrotaskï¼Ÿ**  
   é€™æ˜¯å› ç‚º JavaScript è¨­è¨ˆçš„ç›®çš„æ˜¯å¸Œæœ›èƒ½å¿«é€ŸéŸ¿æ‡‰ç´°ç²’åº¦çš„ä»»å‹™ï¼ˆå¦‚ Promise çš„å›èª¿ï¼‰ï¼Œè€Œ Macrotask é€šå¸¸ç”¨æ–¼è™•ç†è¼ƒå¤§å‹çš„æ“ä½œï¼ˆå¦‚è¨ˆæ™‚å™¨æˆ– I/O æ“ä½œï¼‰ã€‚

2. **Microtask èˆ‡åŒæ­¥ä»£ç¢¼çš„åŸ·è¡Œé †åºæ˜¯ä»€éº¼ï¼Ÿ**  
   åŒæ­¥ä»£ç¢¼ç¸½æ˜¯å„ªå…ˆåŸ·è¡Œï¼Œå…¶æ¬¡æ˜¯ Microtaskï¼Œæœ€å¾Œæ‰æ˜¯ Macrotaskã€‚

---

#### **ç¸½çµ**

- Microtask Queue æ˜¯ JavaScript ä¸­ä¸€å€‹é«˜å„ªå…ˆç´šçš„ä»»å‹™éšŠåˆ—ã€‚
- ä¸»è¦ä¾†æºåŒ…æ‹¬ Promiseã€MutationObserver å’Œ queueMicrotaskã€‚
- Microtask çš„åŸ·è¡Œæ™‚æ©Ÿæ˜¯åœ¨åŒæ­¥ä»£ç¢¼ä¹‹å¾Œã€ä¸‹ä¸€å€‹å®ä»»å‹™ä¹‹å‰ã€‚
- ç†è§£ Microtask èˆ‡ Macrotask çš„åŸ·è¡Œé †åºï¼Œå°æ–¼æ’°å¯«é«˜æ•ˆçš„éåŒæ­¥ JavaScript ç¨‹å¼è‡³é—œé‡è¦ã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 18. Event Loop äº‹ä»¶è¿´åœˆ

åœ¨ JavaScript ä¸­ï¼Œäº‹ä»¶è¿´åœˆï¼ˆEvent Loopï¼‰æ˜¯è² è²¬åŸ·è¡Œç¨‹å¼ç¢¼ã€æ”¶é›†å’Œè™•ç†äº‹ä»¶ä»¥åŠåŸ·è¡Œå­ä»»å‹™ï¼ˆsub-tasksï¼‰çš„æ©Ÿåˆ¶ã€‚JavaScript æ˜¯å–®åŸ·è¡Œç·’çš„èªè¨€ï¼Œé€™æ„å‘³è‘—åŒä¸€æ™‚é–“åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ã€‚ç„¶è€Œï¼Œé€éäº‹ä»¶è¿´åœˆï¼ŒJavaScript å¯ä»¥åŸ·è¡ŒéåŒæ­¥æ“ä½œï¼ˆå¦‚ I/O æ“ä½œã€å®šæ™‚å™¨ç­‰ï¼‰ã€‚

ä»¥ä¸‹æ˜¯äº‹ä»¶è¿´åœˆçš„å®Œæ•´ç­†è¨˜ï¼š

#### å–®åŸ·è¡Œç·’ï¼ˆSingle-threadedï¼‰

JavaScript æ˜¯å–®åŸ·è¡Œç·’çš„ï¼Œé€™æ„å‘³è‘—å®ƒä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ã€‚é€™æ¨£çš„è¨­è¨ˆä½¿å¾— JavaScript åœ¨åŸ·è¡ŒåŒæ­¥ä»»å‹™æ™‚éå¸¸é«˜æ•ˆï¼Œä½†åœ¨é‡åˆ°éœ€è¦ç­‰å¾…çš„ä»»å‹™ï¼ˆå¦‚ç¶²è·¯è«‹æ±‚ï¼‰æ™‚å¯èƒ½æœƒé˜»å¡ã€‚

#### å †ç–Šï¼ˆStackï¼‰

åŸ·è¡Œç·’æœ‰ä¸€å€‹å †ç–Šï¼ˆcall stackï¼‰ï¼Œç”¨ä¾†è¿½è¹¤ç¨‹å¼åŸ·è¡Œçš„ä½ç½®ã€‚ç•¶å‡½å¼è¢«å‘¼å«æ™‚ï¼Œå®ƒæœƒè¢«æ¨å…¥å †ç–Šä¸­ï¼›å‡½å¼åŸ·è¡Œå®Œç•¢å¾Œï¼Œå‰‡æœƒå¾å †ç–Šä¸­ç§»é™¤ã€‚

#### ä»»å‹™éšŠåˆ—ï¼ˆTask Queueï¼‰

ä»»å‹™éšŠåˆ—ï¼ˆtask queueï¼‰æ˜¯å­˜æ”¾å¾…è™•ç†çš„éåŒæ­¥ä»»å‹™çš„åœ°æ–¹ã€‚é€™äº›ä»»å‹™å¯èƒ½åŒ…æ‹¬äº‹ä»¶è™•ç†å™¨ï¼ˆevent handlersï¼‰ã€å®šæ™‚å™¨ï¼ˆtimersï¼‰ï¼Œæˆ–å…¶ä»–éåŒæ­¥æ“ä½œã€‚

#### å¾®ä»»å‹™ï¼ˆMicrotasksï¼‰

å¾®ä»»å‹™ï¼ˆmicrotasksï¼‰æ˜¯æŒ‡é‚£äº›éœ€è¦åœ¨ç›®å‰åŸ·è¡Œçš„ç¨‹å¼ï¼ˆscriptï¼‰çš„åŸ·è¡Œå®Œç•¢å¾Œç«‹å³åŸ·è¡Œçš„ä»»å‹™ï¼Œä¾‹å¦‚ Promise çš„å›èª¿ï¼ˆcallbackï¼‰ã€‚å¾®ä»»å‹™æœƒåœ¨äº‹ä»¶è¿´åœˆçš„æ¯æ¬¡è¿´è½‰ï¼ˆtickï¼‰çµæŸå¾ŒåŸ·è¡Œã€‚

#### å®ä»»å‹™ï¼ˆMacrotasksï¼‰

å®ä»»å‹™ï¼ˆmacrotasksï¼‰æ˜¯æŒ‡é‚£äº›éœ€è¦åœ¨äº‹ä»¶è¿´åœˆçš„ä¸‹ä¸€æ¬¡è¿´è½‰åŸ·è¡Œçš„ä»»å‹™ï¼Œä¾‹å¦‚ setTimeoutã€setIntervalã€I/O æ“ä½œç­‰ã€‚

#### äº‹ä»¶è¿´åœˆçš„é‹ä½œæµç¨‹

1. **åŸ·è¡Œå †ç–Šä¸­çš„ä»»å‹™**ï¼šäº‹ä»¶è¿´åœˆæœƒå…ˆåŸ·è¡Œå †ç–Šä¸­çš„åŒæ­¥ä»»å‹™ã€‚
2. **è™•ç†å¾®ä»»å‹™**ï¼šåŸ·è¡Œå®ŒåŒæ­¥ä»»å‹™å¾Œï¼Œäº‹ä»¶è¿´åœˆæœƒè™•ç†æ‰€æœ‰çš„å¾®ä»»å‹™ã€‚
3. **æ›´æ–°æ¸²æŸ“**ï¼šå¦‚æœå¾®ä»»å‹™åŸ·è¡Œå®Œç•¢ï¼Œç€è¦½å™¨å¯èƒ½æœƒæ›´æ–°æ¸²æŸ“ã€‚
4. **åŸ·è¡Œå®ä»»å‹™**ï¼šäº‹ä»¶è¿´åœˆæœƒå¾ä»»å‹™éšŠåˆ—ä¸­å–å‡ºå®ä»»å‹™ä¸¦åŸ·è¡Œã€‚
5. **é‡è¤‡éç¨‹**ï¼šäº‹ä»¶è¿´åœˆæœƒä¸æ–·é‡è¤‡ä¸Šè¿°éç¨‹ã€‚

#### å¯¦ä¾‹èªªæ˜

```javascript
console.log("Start");

setTimeout(() => {
  console.log("Timeout");
}, 0);

Promise.resolve().then(() => {
  console.log("Promise");
});

console.log("End");
```

åŸ·è¡Œé †åºï¼š

1. `console.log('Start');`
2. `console.log('End');`
3. `console.log('Promise');`ï¼ˆå¾®ä»»å‹™ï¼‰
4. `console.log('Timeout');`ï¼ˆå®ä»»å‹™ï¼‰

#### Event Loop çµè«–

äº‹ä»¶è¿´åœˆæ˜¯ JavaScript è™•ç†éåŒæ­¥è¡Œç‚ºçš„æ ¸å¿ƒæ©Ÿåˆ¶ã€‚ç†è§£äº‹ä»¶è¿´åœˆçš„é‹ä½œå°æ–¼ç·¨å¯«é«˜æ•ˆä¸”ä¸æœƒé˜»å¡çš„ JavaScript ç¨‹å¼éå¸¸é‡è¦ã€‚é€éäº‹ä»¶è¿´åœˆï¼ŒJavaScript å¯ä»¥åœ¨å–®åŸ·è¡Œç·’çš„é™åˆ¶ä¸‹ï¼Œå„ªé›…åœ°è™•ç†å¤§é‡çš„éåŒæ­¥æ“ä½œã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 19. Event Delegation äº‹ä»¶å§”æ´¾

äº‹ä»¶å§”æ´¾ï¼ˆEvent Delegationï¼‰æ˜¯ä¸€ç¨®è™•ç†äº‹ä»¶çš„å¸¸è¦‹è¨­è¨ˆæ¨¡å¼ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å°å¤šå€‹å­å…ƒç´ çš„äº‹ä»¶é€²è¡Œçµ±ä¸€è™•ç†æ™‚ã€‚é€™ç¨®æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°‡äº‹ä»¶ç›£è½å™¨é™„åŠ åˆ°çˆ¶å…ƒç´ ä¸Šï¼Œè€Œä¸æ˜¯æ¯å€‹å­å…ƒç´ ã€‚ç•¶äº‹ä»¶ç™¼ç”Ÿæ™‚ï¼Œäº‹ä»¶å†’æ³¡æ©Ÿåˆ¶ï¼ˆEvent Bubblingï¼‰æœƒå°‡äº‹ä»¶å¾ç›®æ¨™å…ƒç´ å†’æ³¡åˆ°çˆ¶å…ƒç´ ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥åœ¨çˆ¶å…ƒç´ ä¸Šè™•ç†äº‹ä»¶ã€‚

#### å„ªé»

1. **æ€§èƒ½æå‡**ï¼šå°‡äº‹ä»¶ç›£è½å™¨é™„åŠ åˆ°çˆ¶å…ƒç´ ä¸Šå¯ä»¥æ¸›å°‘åœ¨æ¯å€‹å­å…ƒç´ ä¸Šé™„åŠ ç›£è½å™¨çš„é–‹éŠ·ï¼Œç‰¹åˆ¥æ˜¯åœ¨å­å…ƒç´ æ•¸é‡é¾å¤§æ™‚ã€‚
2. **å‹•æ…‹å…ƒç´ æ”¯æŒ**ï¼šå°æ–¼å‹•æ…‹æ·»åŠ çš„å­å…ƒç´ ï¼Œç„¡éœ€é‡æ–°é™„åŠ äº‹ä»¶ç›£è½å™¨ï¼Œåªéœ€è¦ç¢ºä¿äº‹ä»¶ç›£è½å™¨é™„åŠ åœ¨çˆ¶å…ƒç´ ä¸Šã€‚

3. **ç°¡åŒ–ä»£ç¢¼**ï¼šæ¸›å°‘é‡è¤‡ä»£ç¢¼ï¼Œé›†ä¸­ç®¡ç†äº‹ä»¶è™•ç†é‚è¼¯ã€‚

#### å¯¦ç¾æ­¥é©Ÿ

1. **é¸æ“‡çˆ¶å…ƒç´ **ï¼šé¸æ“‡ä¸€å€‹åŒ…å«ç›®æ¨™å­å…ƒç´ çš„çˆ¶å…ƒç´ ã€‚

2. **é™„åŠ äº‹ä»¶ç›£è½å™¨**ï¼šåœ¨çˆ¶å…ƒç´ ä¸Šé™„åŠ äº‹ä»¶ç›£è½å™¨ã€‚

3. **äº‹ä»¶è™•ç†**ï¼šåœ¨äº‹ä»¶è™•ç†å‡½æ•¸ä¸­ä½¿ç”¨`event.target`ä¾†ç¢ºå®šäº‹ä»¶ç™¼ç”Ÿçš„å…·é«”å­å…ƒç´ ï¼Œä¸¦åŸ·è¡Œç›¸æ‡‰çš„é‚è¼¯ã€‚

#### Event Delegation ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€å€‹ç°¡å–®çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨äº‹ä»¶å§”æ´¾ä¾†è™•ç†å¤šå€‹æŒ‰éˆ•çš„é»æ“Šäº‹ä»¶ï¼š

```html
<ul id="parent">
  <li class="child">Item 1</li>
  <li class="child">Item 2</li>
  <li class="child">Item 3</li>
</ul>
```

```javascript
document.getElementById("parent").addEventListener("click", function (event) {
  if (event.target && event.target.matches("li.child")) {
    console.log("Clicked on: " + event.target.textContent);
  }
});
```

#### Event Delegation æ³¨æ„äº‹é …

- **äº‹ä»¶å†’æ³¡ï¼ˆEvent Bubblingï¼‰**ï¼šäº‹ä»¶å§”æ´¾ä¾è³´äº‹ä»¶å†’æ³¡æ©Ÿåˆ¶ï¼Œå› æ­¤éœ€è¦ç¢ºä¿äº‹ä»¶èƒ½å¤ å†’æ³¡åˆ°çˆ¶å…ƒç´ ã€‚

- **äº‹ä»¶ç›®æ¨™ï¼ˆEvent Targetï¼‰**ï¼šä½¿ç”¨`event.target`ä¾†ç¢ºå®šå¯¦éš›è§¸ç™¼äº‹ä»¶çš„å…ƒç´ ï¼Œé€™å°æ–¼é€²è¡Œå…·é«”çš„é‚è¼¯è™•ç†éå¸¸é‡è¦ã€‚

- **äº‹ä»¶é¡å‹**ï¼šä¸¦éæ‰€æœ‰äº‹ä»¶é¡å‹éƒ½æ”¯æŒå†’æ³¡ï¼ˆå¦‚`blur`å’Œ`focus`äº‹ä»¶ï¼‰ï¼Œå› æ­¤åœ¨ä½¿ç”¨äº‹ä»¶å§”æ´¾æ™‚éœ€ç¢ºèªäº‹ä»¶é¡å‹æ˜¯å¦æ”¯æŒå†’æ³¡ã€‚

äº‹ä»¶å§”æ´¾æ˜¯ä¸€ç¨®éå¸¸å¼·å¤§ä¸”æœ‰æ•ˆçš„äº‹ä»¶è™•ç†æ¨¡å¼ï¼Œé©åˆç”¨æ–¼éœ€è¦å°å¤§é‡å‹•æ…‹å…ƒç´ é€²è¡Œäº‹ä»¶è™•ç†çš„æƒ…å¢ƒã€‚

**[ğŸ” Back to Top](#table-of-contents)**

---

### 20. DOM Manipulation DOM æ“ä½œ

<!-- content -->

**[ğŸ” Back to Top](#table-of-contents)**

---

### 21. Module System æ¨¡å¡Šç³»çµ±

<!-- content -->

**[ğŸ” Back to Top](#table-of-contents)**

---

### 22. Web APIs

<!-- content -->

**[ğŸ” Back to Top](#table-of-contents)**

---

### 23. JavaScript Security å®‰å…¨

<!-- content -->

**[ğŸ” Back to Top](#table-of-contents)**

---

### 24. JavaScript Performance æ€§èƒ½

<!-- content -->

**[ğŸ” Back to Top](#table-of-contents)**

---

### 25. Data Structures è³‡æ–™çµæ§‹

<!-- content -->

**[ğŸ” Back to Top](#table-of-contents)**

---

### 26. JavaScript å¼•æ“ å¦‚ V8 çš„æ¶æ§‹

JavaScript å¼•æ“æ˜¯è² è²¬åŸ·è¡Œ JavaScript ç¨‹å¼ç¢¼çš„è»Ÿé«”ï¼ŒV8 æ˜¯å…¶ä¸­ä¸€å€‹æœ€æµè¡Œçš„å¼•æ“ï¼Œä¸»è¦ç”± Google é–‹ç™¼ï¼Œä¸¦ç”¨æ–¼ Chrome ç€è¦½å™¨å’Œ Node.jsã€‚ä»¥ä¸‹æ˜¯ V8 å¼•æ“çš„åŸºæœ¬æ¶æ§‹ï¼š

#### 1. èªæ³•åˆ†æå™¨ (Parser)

- **èªæ³•åˆ†æå™¨ï¼ˆParserï¼‰**ï¼šå°‡ JavaScript åŸå§‹ç¢¼è½‰æ›ç‚ºæŠ½è±¡èªæ³•æ¨¹ï¼ˆAbstract Syntax Treeï¼ŒASTï¼‰ã€‚
- **è©æ³•åˆ†æï¼ˆLexical Analysisï¼‰**ï¼šå°‡ç¨‹å¼ç¢¼åˆ†è§£æˆæ›´å°çš„å–®ä½ï¼ˆtokensï¼‰ã€‚
- **èªæ³•åˆ†æï¼ˆSyntax Analysisï¼‰**ï¼šæª¢æŸ¥ç¨‹å¼ç¢¼çš„çµæ§‹ï¼Œç”Ÿæˆ ASTã€‚

#### 2. è§£é‡‹å™¨ (Interpreter)

- **Ignition**ï¼šV8 çš„è§£é‡‹å™¨ï¼Œè² è²¬å°‡ AST è½‰æ›ç‚ºå­—ç¯€ç¢¼ï¼ˆBytecodeï¼‰ï¼Œä¾¿æ–¼åŸ·è¡Œã€‚

#### 3. ç·¨è­¯å™¨ (Compiler)

- **å³æ™‚ç·¨è­¯ï¼ˆJust-In-Time Compilation, JITï¼‰**ï¼šåœ¨åŸ·è¡ŒæœŸé–“å°‡å­—ç¯€ç¢¼é€²ä¸€æ­¥ç·¨è­¯ç‚ºæ©Ÿå™¨ç¢¼ï¼ˆMachine Codeï¼‰ã€‚
- **TurboFan**ï¼šV8 çš„å„ªåŒ–ç·¨è­¯å™¨ï¼Œè² è²¬å°‡å­—ç¯€ç¢¼å„ªåŒ–ç‚ºé«˜æ•ˆçš„æ©Ÿå™¨ç¢¼ã€‚
- **åŸºç·šç·¨è­¯ï¼ˆBaseline Compilationï¼‰**ï¼šä¸€é–‹å§‹å°‡å­—ç¯€ç¢¼å¿«é€Ÿè½‰æ›ç‚ºæ©Ÿå™¨ç¢¼ã€‚

#### 4. åƒåœ¾å›æ”¶ (Garbage Collection)

- **åƒåœ¾å›æ”¶å™¨ï¼ˆGarbage Collectorï¼‰**ï¼šè‡ªå‹•ç®¡ç†å…§å­˜ï¼Œå›æ”¶ä¸å†ä½¿ç”¨çš„å…§å­˜ç©ºé–“ã€‚
- **åˆ†ä»£å›æ”¶ï¼ˆGenerational Garbage Collectionï¼‰**ï¼šå€åˆ†æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰å’Œè€ç”Ÿä»£ï¼ˆOld Generationï¼‰ç‰©ä»¶ï¼Œé€²è¡Œä¸åŒç­–ç•¥çš„å›æ”¶ã€‚

#### 5. åŸ·è¡Œç’°å¢ƒ (Execution Environment)

- **åŸ·è¡Œå †ç–Šï¼ˆCall Stackï¼‰**ï¼šè¿½è¸ªå‡½æ•¸å‘¼å«å’ŒåŸ·è¡Œé †åºã€‚
- **å †ï¼ˆHeapï¼‰**ï¼šç”¨æ–¼åˆ†é…å‹•æ…‹è¨˜æ†¶é«”çš„å€åŸŸã€‚
- **äº‹ä»¶å¾ªç’°ï¼ˆEvent Loopï¼‰**ï¼šè² è²¬è™•ç†éåŒæ­¥æ“ä½œï¼Œç¢ºä¿éé˜»å¡åŸ·è¡Œã€‚

#### 6. å„ªåŒ–æŠ€è¡“ (Optimization Techniques)

- **å…§è¯å¿«å–ï¼ˆInline Cachingï¼‰**ï¼šå„ªåŒ–å‡½æ•¸å‘¼å«çš„æŸ¥æ‰¾ã€‚
- **éš±å¼é¡ï¼ˆHidden Classesï¼‰**ï¼šå„ªåŒ–ç‰©ä»¶å±¬æ€§çš„å­˜å–ã€‚
- **é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰**ï¼šç¢ºå®šè®Šé‡æ˜¯å¦å¯ä»¥åœ¨å †ä¸Šåˆ†é…ã€‚

é€™äº›çµ„ä»¶å’ŒæŠ€è¡“å…±åŒä½œç”¨ï¼Œä½¿å¾— JavaScript å¼•æ“èƒ½å¤ é«˜æ•ˆåœ°åŸ·è¡Œ JavaScript ç¨‹å¼ç¢¼ã€‚ç†è§£é€™äº›ç´°ç¯€æœ‰åŠ©æ–¼é–‹ç™¼è€…ç·¨å¯«æ›´é«˜æ•ˆçš„ JavaScript ç¨‹å¼ã€‚

**[ğŸ” Back to Top](#table-of-contents)**
